1 REMARKABLE    4051 ROM READER AND CHECKSUM (MDC)2 REM A$=CALL "EXEC" STRING, B$=ARGUMENT/RESULT STRING3 REM H$=HEX ADDRESS STRING, C$=HEX ADDRESS CHARACTER4 RUN 1008 RUN 220100 INIT 110 PAGE115 SET KEY 120 DIM A$(512),B$(4111),C$(1),H$(64)130 A$=""140 A$=A$&"967<3686109735<>4224=?06;=;0=67?0035=>06:6042;72>>058<10"150 A$=A$&"0?266?=>06>>078<000:2666=>06>>0;:60281202658;=::3>:600>6"160 A$=A$&"038=59;=0388;=:9=5:600>6058=4=97188=539719;=0388<>????=?"170 A$=A$&"02=>41=?008=5;=;038=78=703=;028=72=702=>00088<080026>886"180 A$=A$&"3:8=5<<>00028=408=3<=>068610<60?:707>70832843?7>:9=5<624"190 A$=A$&"2002<61;=74;20?0814026?6<13:26?28=355?8=054848484816:600"200 A$=A$&"8=2981392?0280078030840?1;39=>18:60008=?1816444444448=01"210 A$=A$&"17840?8;3081392?028;07=>16:70008=?16392504<1??2602<0??39"220 B$="@00:@8000:"222 PRINT "LIST ALL 4051 ROM Checksums? (Y?): ";224 INPUT H$226 IF H$<>"Y" THEN 230227 RESTORE 460228 GO TO 510230 PRINT "
INPUT A 2KB ALIGNED ROM ADDRESS (UPPER 2 HEX DIGITS): ";240 INPUT H$250 IF LEN(H$)<>2 THEN 230260 GOSUB 380270 B$=REP(H$,6,2)280 IF NOT(H$="88" OR H$="90" OR H$="98" OR H$="A0") THEN 340290 PRINT "INPUT ROM PACK BANK (2 HEX DIGITS): ";300 INPUT H$310 IF LEN(H$)<>2 THEN 290320 GOSUB 380330 B$=REP(H$,2,2)340 CALL "EXEC",A$350 H$=SEG(B$,LEN(B$)-3,4)360 PRINT "FLETCHER 16 CHECKSUM: ";H$370 END 380 REM  CHECK FOR VALID UPPER CASE HEXIDECIMAL390 FOR I=1 TO 2400 C$=SEG(H$,I,1)410 IF C$=>"0" AND C$<="9" OR (C$=>"A" AND C$<="F") THEN 440420 PRINT "INVALID ENTRY, HEX DIGITS MUST BE IN [0..9] OR [A..F]"430 END 440 NEXT I450 RETURN455 REM List all 4051 ROM Checksums - Monty McGraw 12 DEC 2020460 DATA "@00:@8800:","System ROM (ROM PACK)"462 DATA "@00:@9000:","System ROM (ROM PACK)"464 DATA "@00:@9800:","System ROM (ROM PACK)"466 DATA "@00:@A000:","System ROM (ROM PACK)"468 DATA "@08:@8800:","System Overflow ROM (ROM PACK)"470 DATA "@08:@9000:","System Overflow ROM (ROM PACK)"472 DATA "@08:@9800:","No ROM present      (ROM PACK)"474 DATA "@08:@A000:","No ROM present      (ROM PACK)"476 DATA "@10:@8800:","Option 1 COMM (ROM PACK)"478 DATA "@10:@9000:","Option 1 COMM (ROM PACK)"480 DATA "@10:@9800:","Option 1 COMM (ROM PACK)"482 DATA "@10:@A000:","Option 1 COMM (ROM PACK)"484 DATA "@00:@A800:","System ROM"486 DATA "@00:@B000:","System ROM"488 DATA "@00:@B800:","System ROM"490 DATA "@00:@C000:","System ROM"492 DATA "@00:@C800:","System ROM"494 DATA "@00:@D000:","System ROM"496 DATA "@00:@D800:","System ROM"498 DATA "@00:@E000:","System ROM"500 DATA "@00:@E800:","System ROM"502 DATA "@00:@F000:","System ROM"504 DATA "@00:@F800:","System ROM"506 DATA "z","z"510 PRINT "
4051 ROM Checksums:
"520 READ R$,P$525 B$=R$530 IF B$<>"z" THEN 550540 END550 CALL "EXEC",A$560 H$=SEG(B$,LEN(B$)-3,4)570 PRINT R$;H$,P$580 GO TO 5201000 REM I have finished the assembly coded 4051 program that 1002 REM  can read any system ROM including the ROM PACKs.1004 REM Be aware that any ROM PACK that does I/O (including the 1006 REM  RAMPACK) may get messed up when the 8800H to A7FFH ROM 1008 REM  memory space is being read.  This is because any I/O 1010 REM  that is mapped into the region of memory is likely to 1012 REM  get it’s state changed.1014 REM Thus far, only the RAMPACK is confirmed to have that1016 REM  specific problem so you should avoid reading the RAMPACK1018 REM  using this utility since it will suddenly change1020 REM  Page Addresses during the reads.1022 REM There is one known anomaly at this time.  1024 REM  The 2KB ROM at 8000H through 87FFH will not return1026 REM  reliable checksums because the bytes starting at 87A81028 REM  are not repeatable.  1030 REM A check of the firmware listings shows that the ROM1032 REM  locations after 8780H do *not* have any code in them. 1034 REM  The ROM memory region just prior to 8780H has code1036 REM  patch routines, so this might vary with firmware1038 REM  revisions.  As a result, I haven’t restricted the1040 REM  checksum for the code free region.  Since the 2KB1042 REM  of ROM HEX code is stored in the B$ string, it will1044 REM  be easy enough for comparing that ROM between different1046 REM  Tek 4051 computers.1048 REM The 4051 BASIC program to perform firmware ROM reads1050 REM  is included above.  Note that the Bank Address1052 REM  will only be requested when you are reading the ROMs1054 REM  from 8800H through A7FFH since other locations are1056 REM  not dependent on the ROM PACK Bank Address. 1058 REM  The valid Bank Addresses are 00H, 08H, 10H, 28H …1060 REM  2FH, and 30H … 37H.  1062 REM  Other Bank Addresses will generally alias into this1064 REM  shown range.1066 REM BANK Addresses:1068 REM 00H  System ROMs1070 REM 08H  System ROMs1072 REM 10H  Option 1 Communications (built-in RS-232)1074 REM 28H  Right rear ROM PACK slot1076 REM 28H…2FH  Right rear ROM Expander1078 REM 30H  Left rear ROM PACK slot1080 REM 30H…37H  Left rear ROM Expander1082 REM 1084 REM Note that the MULTI-PACK (8 in 1) and MAXIPACK (10 in 1)1086 REM  act just like ROM Expanders.  1088 REM  I will send you my checksums in a later email.1090 REM 1092 REM Here are the Fletcher 16 Checksums for the 4051 firmware.1094 REM The format is: @<Bank>:@<ROM START ADDRESS>:1096 REM  <Fletcher 16 checksum>1098 REM Let me know what your checksums are and I will enter them1100 REM  into a globally available spreadsheet.1102 REM  1104 REM @00:@8000:F5C9    System ROM (Checksum is unreliable since1106 REM                      some nonexistent ROM areas get read)1108 REM @00:@8800:0CE5    System ROM (ROM PACK)1110 REM @00:@9000:023F    System ROM (ROM PACK)1112 REM @00:@9800:47E4    System ROM (ROM PACK)1114 REM @00:@A000:4B29    System ROM (ROM PACK)1116 REM @08:@8800:E1EF    System Overflow ROM (ROM PACK)1118 REM @08:@9000:B6B3    System Overflow ROM (ROM PACK)1120 REM @08:@9800:FFFF    No ROM present      (ROM PACK)1122 REM @08:@A000:FFFF    No ROM present      (ROM PACK)1124 REM @10:@8800:D948    Option 1 COMM (ROM PACK)1126 REM @10:@9000:5AD6    Option 1 COMM (ROM PACK)1128 REM @10:@9800:6155    Option 1 COMM (ROM PACK)1130 REM @10:@A000:186F    Option 1 COMM (ROM PACK)1132 REM @00:@A800:BEC3    System ROM1134 REM @00:@B000:0581    System ROM1136 REM @00:@B800:70A5    System ROM1138 REM @00:@C000:6B55    System ROM1140 REM @00:@C800:93CE    System ROM1142 REM @00:@D000:5F7C    System ROM1144 REM @00:@D800:EE00    System ROM1146 REM @00:@E000:A171    System ROM1148 REM @00:@E800:02FD    System ROM1150 REM @00:@F000:1A8A    System ROM1152 REM @00:@F800:77DE    System ROM