1000 PRINT "	** TLIST EXTENSION **J_J_"
1010 PRINT "THIS PROGRAM WILL TELL YOU THE NUMBER OFBYTES USED";
1020 PRINT " IN TAPE FILES YOU SELECT."
1030 INIT 
1040 PRINT "J_INSERT YOUR TAPE!"
1050 PRINT "J_J_START WITH TAPE FILE NUMBER = ";
1060 INPUT S8
1070 PRINT "J_  END WITH TAPE FILE NUMBER = ";
1080 INPUT S9
1090 S7=MEMORY-100
1100 DIM A$(S7)
1110 PRINT "FILE #    TYPE 	# STRINGS        NUMBER BYTES";
1120 PRINT "	AVERAGE STRING"
1130 PRINT "	(# BIN #'S)      MARKED    USED	    LENGTHJ_"
1140 FOR J9=S8 TO S9
1150 S3=0
1160 S4=0
1170 S5=0
1180 S6=0
1185 E1=0
1190 PRINT USING "2L,3D,6X,S":J9
1200 REM                    CHECK HEADER FOR PROPER FILE
1210 PRINT @33,0:0,0,1
1220 FIND J9
1230 PRINT @33,0:0,0,0
1240 INPUT @33:A$
1250 IF VAL(A$)=J9 THEN 1340
1260 FIND 0
1270 PRINT @33,0:0,0,1
1280 FIND J9
1290 PRINT @33,0:0,0,0
1300 INPUT @33:A$
1310 IF VAL(A$)=J9 THEN 1340
1320 PRINT "MAG TAPE HEADER ERROR IN FILE #";J9
1330 END 
1340 IF POS(A$,"LAST",9)<>9 THEN 1370
1350 PRINT "LAST"
1360 GO TO 1860
1370 IF POS(A$,"P",17)<>17 THEN 1375
1373 E1=1
1375 A$=REP("",1,10)
1380 PRINT "		";256*VAL(A$);""
1390 FIND J9
1400 PRINT "         ";
1405 IF POS(A$,"S",17)<>17 THEN 1410
1407 PRINT "SECRET"
1409 GO TO 1850
1410 GO TO TYP(0) OF 1420,1610,1450,1450
1420 PRINT "NEW"
1430 GO TO 1850
1440 REM                  BINARY FILE:
1450 PRINT "BINARY";
1460 ON EOF (0) THEN 1560
1470 GO TO TYP(0)+1 OF 1850,1560,1560,1475,1510
1475 IF E1=1 THEN 1560
1480 READ @33:S2
1490 S3=1+S3
1500 GO TO 1470
1510 READ @33:A$
1520 S4=1+S4
1525 IF LEN(A$)>255 AND E1=1 THEN 1560
1530 S6=S6+LEN(A$)
1540 S5=S5+(LEN(A$)=S7)
1550 GO TO 1470
1560 S1=S6+S4+S4+10*S3
1570 PRINT "	J_  (";S3;")"
1580 S2=0
1590 GO TO 1760
1600 REM                     ASCII FILE
1610 ON EOF (0) THEN 1690
1620 PRINT "ASCII";
1630 A$=""
1640 INPUT @33:A$
1650 S4=1+S4
1660 S6=S6+LEN(A$)
1670 S5=S5+(LEN(A$)=S7)
1680 GO TO 1630
1690 IF A$="" THEN 1730
1700 S4=S4+1
1710 S6=S6+LEN(A$)
1720 S5=S5+(LEN(A$)=S7)
1730 IF E1=0 THEN 1735
1732 S4=S4-1
1735 S1=S6+S4
1740 S2=1
1750 REM                    PRINT RESULTS FOR ASCII & BINARY
1760 PRINT "	   ";S4;""
1770 PRINT "		        ";S1;""
1780 PRINT "			     ";INT(10*(S6/(S4 MAX 1))+0.5)/10;""
1790 IF NOT(S5) THEN 1830
1800 PRINT "		               (MIN)		";S5;" STRINGS WERE TOO";
1810 PRINT " LONG TO BE		READ IN (EACH HAD LENGTH >= ";S7;")"
1820 GO TO 1850
1830 IF S2 THEN 1850
1840 PRINT 
1850 NEXT J9
1860 PRINT "J_J_J_DONE"
1870 DELETE A$
1880 END 


