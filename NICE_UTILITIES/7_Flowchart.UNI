1 REM***** FLOWCHARTING PROGRAM FOR 4051 BASIC PROGRAMS***************2 REM** HAN KLINKSPOOR   SA DATATEK   **APRIL 19763 GO TO 1004 F2=15 RETURN 8 GOSUB 70009 END 24 F2=025 RETURN 32 GO TO 800036 END 40 GO TO 1000100 INIT 110 GOSUB 8000112 PRINT USING "100(100(""""))P":120 DIM T(300,2),A$(171),C$(100)130 ON EOF (0) THEN 600140 REM  A$(171)- STRING WITH COMMAND ABBREVIATIONS150 A$=""160 G0=0170 DATA "PRI","INP","WRI","REA","WBY","RBY","FIN","APP","SAV","OLD"180 DATA "SEC","TLI","MAR","KIL","PAG","HOM","MOV","DRA","RMO","RDR"190 DATA "AXI","GIN","VIE","WIN","SCA","ROT","POI","INI","SET","DIM"200 DATA "FUZ","DEF","ON ","POL","OFF","DAT","RES","RUN","END","RET"210 DATA "STO","WAI","CLO","COP","FOR","NEX","IF ","GO ","GOS","CAL"220 DATA "LIS","DEL","REN","REM","IMA","LET","MAT"230 RESTORE 240 FOR I=1 TO 57250 READ L$260 REM***DISPLAY CODING BY:**  PRINT USING "2DX3A2XS":I,L$270 A$=A$&L$280 NEXT I290 PRINT USING "//""GIVE FILE NUMBER OF PROGRAM TO BE FLOWCHARTED:""S":300 INPUT N330 PRINT USING "/,""LINE NUMBER LISTING CAN BE EN/DISABLED WITH""":340 PRINT "USER DEFINABLE KEYS #1 AND #6 RESP."350 PRINT USING "/,""PRESSING KEY #2 WILL GIVE THE BRANCH MAP"",/":360 REM START OF PASS 1 IN THE FLOWCHARTING (LOGICAL MAP)*************370 FIND N380 PRINT USING "LLLL15T""*****MAKING UP THE LOGICAL MAP*****""":390 INPUT @33:L$400 IF NOT(LEN(L$)) THEN 390410 A=POS(L$," ",1)+1420 L=VAL(L$)430 C$=SEG(L$,A,3)440 C=(POS(A$,C$,1)+2)/3450 IF C<47 OR C>49 AND C<>33 THEN 390460 P=POS(L$," OF",A)+POS(L$,"TH",A)470 P=(A+5)*(P=0)+(P+3)*(P<>0)480 C$=SEG(L$,P,70)490 G0=G0+1495 IF G0<=300 THEN 500496 PRINT "# OF BRANCHES >100, PROGRAM MOD NEEDED (LINE BELOW)."497 LIST 120498 END 500 T(G0,1)=L-2*L*(C=49)510 T(G0,2)=VAL(C$)515 T(G0,2)=T(G0,2)-2*T(G0,2)*(C=33)520 A=POS(C$,",",1)530 IF NOT(A) THEN 390540 C$=REP("",1,A)550 GO TO 490560 REM*******600 DELETE G610 IF G0=0 THEN 670620 DIM G(G0,2)630 FOR I=1 TO G0640 G(I,1)=T(I,1)650 G(I,2)=T(I,2)660 NEXT I670 DELETE T680 REM*********1000 DELETE F,F$,B$,Z$1010 DIM F(50),F$(100),B$(3),Z$(52),Y$(1),V$(2)1020 F=-11030 F$=""1040 FOR I=1 TO 101050 F$=F$&"          "1060 NEXT I1070 Z$="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"1080 PRINT USING "/,""FLOWCHART BETWEEN LINE NUMBERS: "",S":1081 INPUT L1,L21090 REM*****BEGIN OF PASS 2 OF THE FLOWCHARTING**********************1100 ON EOF (0) THEN 90001110 C$="B E G I N"1120 C0=531130 X0=651140 Y0=1001150 X9=651160 F0=01170 F2=01180 F9=01190 L=01210 SET KEY 1220 FIND N1230 PAGE 1240 MOVE X0,Y01250 GO TO 15301260 REM ***********************1300 INPUT @33:L$1310 IF LEN(L$)=0 THEN 13001330 GOSUB 60001340 L=VAL(L$)1350 IF L<L1 OR L>L2 THEN 13001360 IF L>80 OR L/4<>INT(L/4) THEN 14201370 GOSUB 30001380 RMOVE 0,-21390 PRINT "**** KEY #";L/4;" ****";1400 MOVE X1,Y1-4-4*(C<>48)1410 GIN X0,Y01420 GOSUB 20001430 P=POS(L$," ",1)+11440 C$=SEG(L$,P,3)1450 C=(POS(A$,C$,1)+2)/31451 IF C<>1 OR POS(L$,"@",P)=0 THEN 14601452 C$=SEG(L$,POS(L$,"@",P)+1,3)1454 C=1+(VAL(C$)=32)*20.51460 IF C=C0 AND (C0<45 OR C0>50) AND C0<>39 AND C0<>40 THEN 14801470 GOSUB 30001480 C$=SEG(L$,P,LEN(L$)-P+1)1490 C$=REP("",1,ASC(C$)=32)1500 Y$=SEG(C$,LEN(C$),1)1510 C$=REP("",LEN(C$),Y$=" ")1520 C0=C1530 IF C<>47 THEN 15701540 P=POS(C$,"TH",3)1550 C$=SEG(C$,4,P-5)1560 GOSUB 60001570 RMOVE 0,-2.8-2.5*(C=47)1580 GIN X1,Y11590 F0=01600 IF NOT(F2) THEN 16201605 MOVE 0,Y11610 PRINT "";L;1620 IF C<>48 OR POS(C$,"OF",1)<>0 THEN 17001630 MOVE X1,Y1+6.21640 X9=611650 Y1=Y1+1.31660 F0=11670 GOSUB 40001680 GIN A,Y01690 GO TO 18501700 L0=LEN(C$)*0.8961710 REM GO LOOKING FOR CTRL CHARACTERS1720 GOSUB 50001730 MOVE X1-L0,Y11740 PRINT C$;1750 IF C<>45 AND C<>46 THEN 18101760 IF C=46 THEN 18001770 P=POS(C$,"=",5)1780 V$=SEG(C$,P-2,2)1790 GO TO 18101800 V$=SEG(C$,LEN(C$)-1,2)1810 X9=X9 MAX 70 MAX L0+65.61830 IF C<47 OR C>49 AND C<>33 THEN 18601840 GOSUB 40001850 Y1=Y1-3*(C=47 OR C=48)1860 MOVE X1,Y11870 GO TO 13001880 REM******2000 REM******LOOKING FOR INCOMING BRANCHES**************************** 2010 IF G0=0 THEN 21602020 FOR I=1 TO G02030 IF ABS(G(I,2))<>L THEN 21402040 GOSUB 30002050 GOSUB 60002060 MOVE X0-60,Y02070 PRINT USING "6D,"">>"",S":I2080 IF G(I,1)>0 THEN 20952090 PRINT "SUBR CALL";2091 GO TO 21002095 IF G(I,2)>0 THEN 21002096 PRINT "INTERRUPT";2100 RMOVE 13.5+16*(G(I,1)<0 OR G(I,2)<0),1.32110 DRAW X0,Y0+1.32120 RDRAW 0,-42130 GIN X0,Y02135 Y1=Y02140 NEXT I2150 GOSUB 60002160 RETURN 2170 REM******3000 REM******BOXDRAWING ROUTINE*************************************** 3010 IF F0 THEN 39603020 Y1=Y1-0.53030 MOVE X1,Y13040 A=(Y0-Y1)/2+Y13050 B=2*X0-X93100 IF C0<27 OR C0=47 OR C0=49 OR C0=50 OR C0>54 THEN 34003110 REM **************DRAW BOX FOR 'OTHER' STATEMENTS*************3120 PRINT @32,20:X9,Y1,X9+1,A,X9,Y0,B,Y0,B-1,A,B,Y1,X1,Y13130 IF C0<>45 AND C0<>46 THEN 39103140 MOVE X9+1,A3150 IF C0=46 THEN 32503160 REM FOR STATEMENT3170 FOR J=1 TO 99 STEP 23180 B$=SEG(F$,J,2)3190 IF B$="  " THEN 32103200 NEXT J3210 F$=REP(V$,J,2)3220 PRINT @32,20:130-J,A3230 F(J/2+0.5)=A3240 GO TO 39003250 REM  NEXT STATEMENT3270 B=POS(F$,V$,1)3280 IF NOT(B) THEN 39003290 PRINT @32,20:130-B,A,130-B,F(B/2)3300 F$=REP("  ",B,2)3310 F(B/2)=-13320 GO TO 39003400 IF C0>6 OR C0<1 THEN 35003410 REM***********BOX FOR I/O OPERATIONS3420 PRINT @32,20:X9,Y1,X9+2,Y0,B,Y0,B-2,Y1,X1,Y13430 GO TO 39103500 IF C0=>1 AND C0<15 OR (C0>27 AND C0<49) OR C0>50 THEN 36003510 REM *********CALCULATION, GRAPHICS & SUBR.CALL BOX3520 PRINT @32,20:X9+1,Y1,X9+1,Y0,B-1,Y0,B-1,Y1,X1,Y13530 IF C0<15 OR C0>28 AND C0<>49 AND C0<>50 THEN 39103540 REM GRAPHIC BOX & SUBROUTINE CALL BOX3545 X9=X9+(C0=49 OR C0=50)3546 B=B-(C0=49 OR C0=50)3550 PRINT @32,20:X1,Y1-0.5,X9+0.5,Y1-0.5,X9+0.5,Y0+0.5,B-0.5,Y0+0.53551 PRINT @32,20:B-0.5,Y1-0.5,X1,Y1-0.5,X1,Y13560 GO TO 39103600 IF C0<>47 THEN 37003610 REM **************DECISION BOX DRAWING3620 PRINT @32,20:X9+4,Y9,X0,Y0,B-4,Y9,X1,Y13630 MOVE X9+4,Y9+23640 PRINT "YES";3650 GO TO 39003700 REM  ADD MORE BOXES HERE3900 MOVE X1,Y13910 REM3920 GIN X0,Y03930 Y0=Y0-43940 DRAW @32,20+(C0>37 AND C0<43):X0,Y03950 X9=653960 F0=13970 RETURN 3980 REM**************4000 REM******OUTGOING BRANCH DRAWING********************************** 4010 IF G0=0 THEN 42004020 IF C=33 THEN 41004030 Y9=Y1+1.54040 MOVE X9+(C0<>49 AND C0<>50)*3+1,Y94050 IF X9<100 THEN 40804060 RDRAW 5,04070 GO TO 40904080 DRAW 110,Y94090 RMOVE -0.8,-1.284100 FOR I=1 TO G04110 IF ABS(G(I,1))<>L THEN 41804111 IF C<>33 THEN 41204112 PRINT USING " 6X,""INT SERVICE--"",S":4120 PRINT ">>";I;4130 GIN P,Y14140 IF Y1>5 THEN 41704150 GOSUB 60004160 MOVE P,1004170 RMOVE 0,-2.64180 NEXT I4190 REM4200 RETURN 4210 REM***************5000 REM******CONVERSION OF CONTROL CHARACTERS***************5010 I=05020 I=I+15030 B$=SEG(C$,I,1)5040 IF B$="" THEN 51205050 A=ASC(B$)5060 IF A>31 THEN 50205070 B$=CHR(A+64)5080 B$=B$&"_"5090 C$=REP(B$,I,1)5100 I=I+25110 GO TO 50205120 RETURN 5130 REM**************6000 REM*******PAGE FULL HANDLING*************************************6010 IF Y1>10+5*(C=47) THEN 62506020 GOSUB 30006030 FOR J=1 TO 506040 IF F(J)<0 THEN 60806050 PRINT @32,21:131-2*J,F(J)6060 PRINT @32,20:131-2*J,06070 F(J)=1006080 NEXT J6090 MOVE 0,06100 F9=F9+16110 Y$=SEG(Z$,F9,1)6120 PRINT Y$;6130 COPY 6135 PAGE 6140 PRINT USING "10(100(""""))PS":6170 MOVE 0,996180 PRINT Y$;6190 MOVE 65,1006200 DRAW 65,98.56210 X1=656220 Y1=986230 X9=656240 GIN X0,Y06250 RETURN 6260 REM********7000 REM *****SUBR TO DISPLAY THE BRANCHES***********************7010 C$="3D,2X,2(5D,3X),10A,5X,S"7020 FOR I=1 TO G0/66+17030 A=(I-1)*667040 PAGE 7050 IF G0=0 THEN 72207060 PRINT USING "2(""BR#   FROM"",5X,""TO"",19X),72(""="")":7070 FOR K=A+1 TO A+33 MIN A+(G0-A+1)/27080 B=33 MIN INT(0.5*(G0-A))+(INT(G0/2)<>G0/2)7090 FOR J=K TO K+B STEP B7100 IF J>G0 THEN 71807110 L$=""7120 IF G(J,1)>0 THEN 71507130 L$="*SUBR.CALL"7140 GO TO 71707150 IF G(J,2)>0 THEN 71707160 L$="*INTERRUPT"7170 PRINT USING C$:J,ABS(G(J,1)),ABS(G(J,2)),L$7180 NEXT J7190 NEXT K7200 COPY 7205 PAGE 7210 NEXT I7220 PRINT USING 7221:G07221 IMAGE //3D " BRANCHES" //21T"****END OF LOGICAL MAP****"7230 COPY 7235 PAGE 7240 RETURN 7250 REM*******************8000 REM ** LEGEND OF THE SYMBOLS ***8010 DATA 0,"CALCULATION.",3,"INPUT/OUTPUT OPERATION.",20,"GRAPHICS."8020 DATA 30,"MISC.",47,"CONDITIONAL BRANCH.",49,"SUBROUTINE CALL.",-18030 RESTORE 80108050 PRINT USING """	F L O W C H A R T   S Y M B O L S""":8060 Y0=858070 X0=258080 X1=258090 X9=358100 F0=08110 READ C08120 Y1=Y0-8-4*(C0=47)8130 Y9=Y1+6*(C0=47)8140 IF C0=-1 THEN 82308150 READ L$8160 GOSUB 30008170 IF C0<>47 THEN 82008180 MOVE 39,Y98190 RDRAW 6,08200 MOVE 60,Y0+88210 PRINT L$;8220 GO TO 80708230 HOME 8240 RETURN 9000 REM ******END OF THE PROGRAM ******9010 GOSUB 30009020 HOME 9030 COPY 9040 END 