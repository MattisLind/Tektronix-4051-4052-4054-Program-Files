100 REM ********************--    ROOTER    --*************************110 REM *                                                             * 120 REM *  FINDS THE ROOTS OF POLYNOMIALS USING BAIRSTOW'S METHOD.    * 130 REM *  CAUTION:  THERE ARE A FEW TYPES OF POLYNOMIALS WHICH THIS  * 140 REM *  PROGRAM IS UNABLE TO SOLVE.    IT WILL TELL YOU SO.        * 150 REM *  FOR HIGH ORDER POLYNOMIALS, PROGRAM MAY REQUIRE MANY       * 160 REM *  ITERATIONS, SO RUNNING TIME CAN BE HIGH.                   * 170 REM *                                                             * 180 REM *************************************************************** 190 PAGE 200 DIM A(26),B(26),X(26)210 PRI "                     ROOTER    V TH 1.0            10 MAY '79"220 PRINT "ORDER = ";230 INPUT N240 IF N=0 THEN 920250 IF N>25 THEN 1310260 PRINT 270 PRINT " COEFFICIENTS (IN DESCENDING ORDER) ARE:"280 FOR I=0 TO N290 INPUT A(I+1)300 B(I+1)=A(I+1)310 NEXT I320 PRINT 330 PRINT " THE ROOTS ARE:"340 PRINT 350 IF N<=2 THEN 850360 IF A(N+1)=0 THEN 930370 IF N/2-INT(N/2)=0 THEN 400380 GOSUB 1070390 GO TO 350400 IF ABS(A(N-1))<1.0E-25 THEN 440410 P=A(N)/A(N-1)420 Q=A(N+1)/A(N-1)430 GO TO 460440 P=A(N)450 Q=A(N+1)460 FOR I=0 TO N470 X(I+1)=A(I+1)480 NEXT I490 GOSUB 990500 FOR I=0 TO N-2510 B(I+1)=X(I+1)520 NEXT I530 R=X(N)540 S=A(N+1)-P*X(N)-Q*X(N-1)550 GOSUB 990560 X(N)=-P*X(N-1)-Q*X(N-2)570 D=X(N-1)^2-X(N)*X(N-2)580 IF ABS(D)>1.0E-25 THEN 610590 PRINT " UNOBTAINABLE WITH THIS PROGRAM!  SORRY ABOUT THAT."600 GO TO 920610 P1=P+(R*X(N-1)-S*X(N-2))/D620 Q1=Q+(S*X(N-1)-R*X(N))/D630 IF ABS(P)>1.0E-25 THEN 680640 IF ABS(P1)>1.0E-25 THEN 680650 IF ABS(Q)>1.0E-25 THEN 690660 GO TO 700670 IF ABS(P1/P-1)>1.0E-6 THEN 700680 IF ABS(Q1/Q-1)<1.0E-6 THEN 720690 P=P1700 Q=Q1710 GO TO 460720 FOR I=1 TO N-2730 A(I+1)=B(I+1)740 NEXT I750 N=N-2760 D=P*P-4*Q770 IF D<0 THEN 820780 D=SQR(D)790 PRINT USING 1340:(-P+D)/2;"     AND     ";(-P-D)/2800 IF N-2>0 THEN 360810 GO TO 850820 D=SQR(-D)830 PRINT USING 1330:-P/2;" +J";D/2;"     AND     ";-P/2;" -J";D/2840 IF N-2>0 THEN 360850 IF N=1 THEN 910860 IF N=0 THEN 920870 P=B(2)/B(1)880 Q=B(3)/B(1)890 N=0900 GO TO 760910 PRINT USING 1350:-B(2)/B(1)920 END 930 PRINT " 0.00"940 LET N=N-1950 GO TO 350960 REM970 REM SUBROUTINE980 REM990 X(2)=X(2)-P*X(1)1000 FOR I=2 TO N-11010 X(I+1)=X(I+1)-P*X(I)-Q*X(I-1)1020 NEXT I1030 RETURN 1040 REM1050 REM  SUBROUTINE FOR EXTRACTING A SINGLE REAL ROOT1060 REM1070 IF B(2)=0 THEN 11001080 Y=-B(2)/B(1)1090 GO TO 11101100 Y=-B(N+1)/B(1)1110 F=01120 F1=01130 FOR I=0 TO N1140 J=N-I1150 IF B(J+1)=0 THEN 11901160 F=B(J+1)*Y^I+F1170 IF I=0 THEN 11901180 F1=I*B(J+1)*Y^(I-1)+F11190 NEXT I1200 X1=Y-F/F11210 IF ABS(Y/X1-1)<1.0E-6 THEN 12401220 Y=X11230 GO TO 11101240 PRINT USING 1350:X11250 N=N-11260 FOR I=1 TO N1270 A(I+1)=B(I+1)+X1*A(I)1280 B(I+1)=A(I+1)1290 NEXT I1300 RETURN 1310 PRINT "OOPS! 25TH ORDER IS AS HI AS I CAN GO.  TRY AGAIN "1320 GO TO 2201330 IMAGE  4E,3A, 4E,13A, 4E,3A, 4E1340 IMAGE 4E,15X,13A,4E1350 IMAGE 4E1360 END 