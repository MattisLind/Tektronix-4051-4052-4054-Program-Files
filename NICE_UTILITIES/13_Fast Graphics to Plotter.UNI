1 REM FAST GRAPHICS TO PLOTTER 2 DEC 82 CARL HOVEY3 GO TO 1004 GO TO 5708 GO TO 44020 GO TO 680100 REM FAST GRAPHICS TO PLOTTER ROUTINE: THREE CHARACTERS PER VECTOR110 INIT 115 REM F1=1 FOR FAST GRAPHICS ROMPACK, F1=0 OTHERWISE116 F1=1117 REM T=ADDRESS OF PLOTTER OR 32 FOR SCREEN118 T=1120 REM FIRST CHAR. HAS MOVE FLAG, 3 BIT HI X, 3 BIT HI Y130 REM SECOND CHAR. HAS 7 BIT LO X, THIRD HAS 7 BIT LO Y150 PRINT "INPUT THE FILE YOU WANT TO DRAW  ";160 INPUT F170 DIM A$(MEMORY-5000),R$(1),B$(2000)180 A$=""190 R$=CHR(13)200 CALL "NEWTAPE"210 FIND F215 IF F1 THEN 302220 F9=1230 ON EOF (0) THEN 250240 GO TO 270250 F9=0260 RETURN 270 INPUT @33:B$280 B$=B$&R$290 A$=REP(B$,LEN(A$)+1,0)300 IF F9 THEN 270301 GO TO 309302 CALL "IMAGES",A$309 A$=SEG(A$,1,3*INT(LEN(A$)/3))310 M=0320 X=1330 Y=2340 REM X$ CONVERTS 3 CHARS IN A$ INTO M,X,Y350 DIM X$(200)360 X$="30>>23>>0;:6055?4949<914375?3737;=;1?;"370 X$=X$&"30>>23;=::3>;=;70?"380 X$=X$&"30>>23>>0;:605>6065946464646568403373636;=;1?;"390 X$=X$&"30>>1:;=::3>;=;70?"400 X$=X$&"30>>23>>0;:605>6075946568403373636;=;1?;"410 X$=X$&"30>>11;=::3>;=;70?39"420 GO TO 550430 REM UN SCALED PLOT440 P=1450 B$=SEG(A$,P,3)460 CALL "EXEC",B$,M,X,Y,X$470 PRINT @T,M:X*130/1023,Y*100/780480 P=P+3490 IF P<=LEN(A$)-3 THEN 450500 HOME @T:510 PRINT ""520 REM END OF PLOTTER GRAPHICS PROGRAM530 END 540 REM PLOT PICTURE550 GOSUB 910560 REM PAGE570 W2=-1580 W3=-1590 PRINT " PLEASE CALL IN LOWER-LEFT AND UPPER-RIGHT BOUNDARIES."600 ON SRQ THEN 800603 IF NOT(F1) THEN 610605 CALL "SRQON"610 IF W3<0 THEN 610620 S2=(U3-U2)/(U1-U0)630 S3=(W3-W2)/(W1-W0)640 S=S2 MIN S3650 REM CENTER PLOT WITHIN BOUNDRIES660 U=U2+(U3-((U1-U0)*S+U2))/2670 W=W2+(W3-((W1-W0)*S+W2))/2680 P=1690 SET NOKEY 695 IF F1 THEN 781700 B$=SEG(A$,P,3)710 CALL "EXEC",B$,M,X,Y,X$720 PRINT @T,M:((X-U0)*S+U)*130/1023,((Y-W0)*S+W)*100/780730 P=P+3740 IF P<=LEN(A$)-3 THEN 700750 PRINT ""760 PRINT "USER DEFINABLE 5 WILL RETRACE PREVIOUS PLOT."770 SET KEY 780 GO TO 570781 FOR P=0 TO LEN(A$)/3-1782 P1=P783 CALL "POINTS",A$,P1,X,Y785 PRINT @T,20+(P1<=0):(X-U0)*S+U,(Y-W0)*S+W786 NEXT P787 GO TO 750790 REM BOUNDRY INPUT SRQ HANDLER800 IF W2=>0 THEN 850810 INPUT @T,27:U2,W2,Z9815 IF F1 THEN 880820 U2=U2*1023/130830 W2=W2*780/100840 GO TO 880850 INPUT @T,27:U3,W3,Z9855 IF F1 THEN 880860 U3=U3*1023/130870 W3=W3*780/100880 PRINT "";890 RETURN 900 REM MINANDMAX910 PRINT "MINIMUM X","MAXIMUM X","MINIMUM Y","MAXIMUM Y"911 IF NOT(F1) THEN 920912 CALL "BOUNDS",A$,U0,W0,U1,W1914 CALL "RDRAW",A$,1,0,0916 GO TO 1060920 U0=1023930 U1=0940 W0=780950 W1=0960 P=1970 B$=SEG(A$,P,3)980 CALL "EXEC",B$,M,X,Y,X$990 PRINT @32,M:X*130/1023,Y*100/7801000 P=P+31010 U0=U0 MIN X1020 U1=U1 MAX X1030 W0=W0 MIN Y1040 W1=W1 MAX Y1050 IF P<=LEN(A$)-3 THEN 9701060 PRINT "";U0,U1,W0,W11070 RETURN 