5000 IF INT(V1/50)<>5 THEN 49705010 GO TO INT((V1-251)/8) OF 5030,5040,5050,5060,50705020 GO TO V1-250 OF 7130,7230,7330,7430,7630,5120,5210,52805030 GO TO V1-258 OF 5390,5440,5520,5570,5600,5630,5660,57005040 GO TO V1-266 OF 5730,5770,5840,7530,8090,9290,9350,94105050 GO TO V1-274 OF 9440,8960,9100,10020,10060,10120,10180,102905060 GO TO V1-282 OF 8290,8200,8260,8180,8200,8180,8630,86805070 GO TO V1-290 OF 8740,8760,8790,88705080 PRINT "Calculation not possible for ";E$;" at FREQ = ";G*G65090 RETURN 5100 PRINT "Undefined S-parameters for ";E$;" at FREQ = ";G*G65110 GO TO 40005120 GOSUB 40005130 E4=V*G5/G0/25140 IF E4=-1 THEN 51005150 H0=05160 H0(1)=E4/(1+E4)5170 H0(3)=1/(1+E4)5180 H0(5)=H0(3)5190 H0(7)=H0(1)5200 GO TO 40005210 GOSUB 40005220 E4=2*V*G5/G05230 IF E4=-1 THEN 51005240 H0=05250 H0(1)=-1/(1+E4)5260 H0(3)=E4/(1+E4)5270 GO TO 51805280 GOSUB 40005290 E5=V*G7*G*G0*PI/2505300 H0=05310 H0(1)=15320 H0(4)=E55330 H0(6)=E55340 H0(7)=H0(1)5350 E2=1/(1+E5^2)5360 E3=-E2*E55370 GOSUB 67105380 GO TO 40005390 GOSUB 40005400 E5=V*G7*G*G0*PI/10005410 IF E5=0 THEN 54605420 E5=-1/E55430 GO TO 55405440 GOSUB 40005450 E5=V*G8*G*PI/G05460 H0=05470 H0(2)=E55480 H0(3)=15490 H0(5)=15500 H0(8)=E55510 GO TO 53505520 GOSUB 40005530 E5=4*V*G8*G*PI/G05540 H0=05550 H0(1)=-15560 GO TO 53205570 GOSUB 40005580 E5=V*G5/G0/25590 GO TO 54605600 GOSUB 40005610 E5=2*V*G5/G05620 GO TO 55405630 GOSUB 59705640 V0=05650 GO TO 40005660 GOSUB 59705670 V0=15680 H1=H05690 GO TO 40005700 GOSUB 59705710 V0=25720 GO TO 56805730 GOSUB 59705740 V0=35750 H1=-H05760 GO TO 40005770 GOSUB 59705780 V0=45790 H1=H05800 FOR E0=1 TO 45810 H1(E0)=-H1(E0)5820 NEXT E05830 GO TO 40005840 GOSUB 59705850 V0=55860 H1=-H05870 GO TO 58005880 GO TO V0 OF 5920,5920,5930,5890,59505890 FOR E0=1 TO 45900 H0(E0)=-H0(E0)5910 NEXT E05920 RETURN 5930 H0=-H05940 RETURN 5950 H0=-H05960 GO TO 58905970 IF V0=0 THEN 59205980 GOSUB 58805990 H2=H06000 IF V0=1 THEN 63206010 GOSUB 67806020 H0=H1-H06030 H0=H0+H26040 H0(1)=H0(1)+36050 H0(7)=H0(7)+36060 GOSUB 65606070 H4=H06080 H1(1)=H1(1)+16090 H1(7)=H1(7)+16100 H3=H16110 GOSUB 67806120 H1=H06130 H2=H46140 GOSUB 67806150 H1=H06160 H2=H36170 GOSUB 67806180 E2=46190 E3=06200 GOSUB 67106210 H2=H0+H36220 H2(1)=H2(1)-26230 H2(7)=H2(7)-26240 H0=H36250 H0(1)=H0(1)+26260 H0(7)=H0(7)+26270 GOSUB 65606280 H1=H06290 GOSUB 67806300 GOSUB 58806310 RETURN 6320 E4=1-H1(7)*H2(1)+H1(8)*H2(2)6330 E5=H1(7)*H2(2)+H1(8)*H2(1)6340 E3=E4^2+E5^26350 IF E3=0 THEN 50806360 E2=E4/E36370 E3=E5/E36380 E4=H1(3)*H2(1)-H1(4)*H2(2)6390 E5=H1(3)*H2(2)+H1(4)*H2(1)6400 H0(1)=E4*H1(5)-E5*H1(6)6410 H0(2)=E4*H1(6)+E5*H1(5)6420 H0(3)=H1(3)*H2(3)-H1(4)*H2(4)6430 H0(4)=H1(3)*H2(4)+H1(4)*H2(3)6440 H0(5)=H1(5)*H2(5)-H1(6)*H2(6)6450 H0(6)=H1(5)*H2(6)+H1(6)*H2(5)6460 E4=H1(7)*H2(5)-H1(8)*H2(6)6470 E5=H1(7)*H2(6)+H1(8)*H2(5)6480 H0(7)=E4*H2(3)-E5*H2(4)6490 H0(8)=E4*H2(4)+E5*H2(3)6500 GOSUB 67106510 H0(1)=H0(1)+H1(1)6520 H0(2)=H0(2)+H1(2)6530 H0(7)=H0(7)+H2(7)6540 H0(8)=H0(8)+H2(8)6550 RETURN 6560 E4=H0(1)*H0(7)-H0(2)*H0(8)-H0(3)*H0(5)+H0(4)*H0(6)6570 E5=H0(1)*H0(8)+H0(2)*H0(7)-H0(3)*H0(6)-H0(4)*H0(5)6580 E3=E4^2+E5^26590 IF E3=0 THEN 50806600 E2=E4/E36610 E3=-E5/E36620 H0=-H06630 E4=H0(1)6640 H0(1)=-H0(7)6650 H0(7)=-E46660 E5=H0(2)6670 H0(2)=-H0(8)6680 H0(8)=-E56690 GOSUB 67106700 RETURN 6710 FOR E4=1 TO 7 STEP 26720 E5=E4+16730 E0=E2*H0(E4)-E3*H0(E5)6740 H0(E5)=E2*H0(E5)+E3*H0(E4)6750 H0(E4)=E06760 NEXT E46770 RETURN 6780 H0(1)=H1(1)*H2(1)-H1(2)*H2(2)+H1(3)*H2(5)-H1(4)*H2(6)6790 H0(2)=H1(1)*H2(2)+H1(2)*H2(1)+H1(3)*H2(6)+H1(4)*H2(5)6800 H0(3)=H1(1)*H2(3)-H1(2)*H2(4)+H1(3)*H2(7)-H1(4)*H2(8)6810 H0(4)=H1(1)*H2(4)+H1(2)*H2(3)+H1(3)*H2(8)+H1(4)*H2(7)6820 H0(5)=H1(5)*H2(1)-H1(6)*H2(2)+H1(7)*H2(5)-H1(8)*H2(6)6830 H0(6)=H1(5)*H2(2)+H1(6)*H2(1)+H1(7)*H2(6)+H1(8)*H2(5)6840 H0(7)=H1(5)*H2(3)-H1(6)*H2(4)+H1(7)*H2(7)-H1(8)*H2(8)6850 H0(8)=H1(5)*H2(4)+H1(6)*H2(3)+H1(7)*H2(8)+H1(8)*H2(7)6860 RETURN 6870 E2=E4/E36880 E3=-E5/E36890 H0(5)=H0(3)6900 H0(6)=H0(4)6910 H0(7)=H0(1)6920 H0(8)=H0(2)6930 GOSUB 67106940 GO TO 40006950 E$=REP("R",2,1)6960 GOSUB 40006970 E0=V*G56980 E$=REP("L",2,1)6990 GOSUB 40007000 E6=V*G87010 E$=REP("C",2,1)7020 GOSUB 40007030 E7=V*G7/10007040 E2=2*PI*G7050 E$=REP("Z",2,1)7060 RETURN 7070 H0(3)=17080 H0(5)=17090 GO TO 40007100 H0(1)=-17110 H0(7)=-17120 GO TO 40007130 GOSUB 69507140 E4=1-E6*E7*E2^27150 E5=E2*E7*(E0+2*G0)7160 E3=E4^2+E5^27170 H0=07180 IF E3=0 THEN 50807190 H0(1)=E47200 H0(2)=E2*E0*E77210 H0(4)=2*E2*E7*G07220 GO TO 68707230 GOSUB 69507240 E4=2-2*E6*E7*E2^27250 E5=E2*E7*(G0+2*E0)7260 E3=E4^2+E5^27270 H0=07280 IF E3=0 THEN 50807290 H0(2)=-E2*E7*G07300 H0(3)=E47310 H0(4)=2*E2*E0*E77320 GO TO 68707330 GOSUB 69507340 E4=2*E0*(1-E6*E7*E2^2)7350 E5=E2*E6*(2+E0/G0)7360 E3=E4^2+E5^27370 H0=07380 IF E3=0 THEN 70707390 H0(2)=E2*E6*E0/G07400 H0(3)=E47410 H0(4)=2*E2*E67420 GO TO 68707430 GOSUB 69507440 E4=E0*(1-E6*E7*E2^2)7450 E5=E2*E6*(1+2*E0/G0)7460 E3=E4^2+E5^27470 H0=07480 IF E3=0 THEN 71007490 H0(1)=-E47500 H0(2)=-E2*E67510 H0(4)=2*E2*E6*E0/G07520 GO TO 68707530 GOSUB 79707540 E$=REP("X",LEN(E$),1)7550 GOSUB 40007560 H0(1)=V7570 E$=REP("E",LEN(E$),1)7580 GOSUB 40007590 E7=SQR(ABS(V))*36*2.54/2.99792458*G*H0(1)/G97600 GOSUB 80107610 E5=E5*H0(1)7620 GO TO 77107630 GOSUB 79707640 E$=REP("0",LEN(E$),1)7650 GOSUB 40007660 E7=V7670 GOSUB 80107680 IF E6=0 THEN 77007690 E7=E7*G*G6/E67700 E5=E5*E7/3607710 IF E6=0 THEN 77307720 E5=E5*SQR(ABS(G*G6/E6))7730 E2=EXP(E5)7740 E3=EXP(-E5)7750 E4=COS(E7)7760 E5=SIN(E7)7770 H0(3)=4*E07780 H0(4)=07790 H0(1)=(E0^2-1)*(E2-E3)*E47800 H0(2)=(E0^2-1)*(E2+E3)*E57810 E6=((E0+1)^2*E2-(E0-1)^2*E3)*E47820 E7=((E0+1)^2*E2+(E0-1)^2*E3)*E57830 E5=E6^2+E7^27840 IF E5=0 THEN 51007850 E4=E6/E57860 E5=-E7/E57870 FOR E0=1 TO 3 STEP 27880 E3=H0(E0+1)7890 H0(E0+1)=H0(E0)*E5+E3*E47900 H0(E0)=H0(E0)*E4-E3*E57910 NEXT E07920 H0(5)=H0(3)7930 H0(6)=H0(4)7940 H0(7)=H0(1)7950 H0(8)=H0(2)7960 GO TO 40007970 E$=E$&"-Z"7980 GOSUB 40007990 E0=V*G5/G08000 RETURN 8010 E$=REP("F",LEN(E$),1)8020 GOSUB 40008030 E6=V8040 E$=REP("D",LEN(E$),1)8050 GOSUB 40008060 E5=V*LOG(10)/208070 E$=SEG(E$,1,LEN(E$)-2)8080 RETURN 8090 FOR E0=1 TO 3 STEP 28100 FOR E2=0 TO 18110 E3=8-E0+E28120 E4=H0(E0+E2)8130 H0(E0+E2)=H0(E3)8140 H0(E3)=E48150 NEXT E28160 NEXT E08170 GO TO 40008180 GOSUB 97608190 GO TO 83308200 GOSUB 97608210 GOSUB 84308220 GOSUB 83608230 GOSUB 84308240 GOSUB 97608250 GO TO 40008260 GOSUB 97608270 GOSUB 83608280 GO TO 82108290 GOSUB 97608300 GOSUB 84308310 GOSUB 83608320 GOSUB 84308330 GOSUB 83608340 GOSUB 97608350 GO TO 40008360 H0(7)=H0(1)+H0(3)+H0(5)+H0(7)8370 H0(8)=H0(2)+H0(4)+H0(6)+H0(8)8380 H0(3)=-H0(1)-H0(3)8390 H0(4)=-H0(2)-H0(4)8400 H0(5)=-H0(1)-H0(5)8410 H0(6)=-H0(2)-H0(6)8420 RETURN 8430 E0=H0(1)8440 H0(1)=H0(7)8450 H0(7)=E08460 E0=H0(2)8470 H0(2)=H0(8)8480 H0(8)=E08490 RETURN 8500 E$=E$&"-M"8510 GOSUB 40008520 E6=-V*28530 RETURN 8540 GOSUB 85008550 E$=REP("A",LEN(E$),1)8560 GOSUB 40008570 E7=V8580 H0=08590 H0(5)=E6*COS(V)8600 H0(6)=E6*SIN(V)8610 H0(7)=18620 RETURN 8630 GOSUB 85008640 E6=E6/G5*G08650 GOSUB 85508660 H0(1)=18670 GO TO 40008680 GOSUB 85008690 E6=E6*G5/G08700 GOSUB 85508710 H0=-H08720 H0(1)=-18730 GO TO 40008740 GOSUB 85408750 GO TO 87208760 GOSUB 85408770 H0=-H08780 GO TO 86608790 GOSUB 40008800 H0=08810 E0=V^2+18820 H0(1)=(2-E0)/E08830 H0(3)=2*V/E08840 H0(5)=H0(3)8850 H0(7)=-H0(1)8860 GO TO 40008870 GOSUB 40008880 V=V*G5/G08890 H0=08900 E0=V^2+18910 H0(1)=(E0-2)/E08920 H0(3)=2*V/E08930 H0(5)=-H0(3)8940 H0(7)=H0(1)8950 GO TO 40008960 GOSUB 40008970 IF V=0 THEN 90608980 GOSUB 97608990 V=(V*G5/G0)^29000 FOR E0=1 TO 89010 H0(E0)=H0(E0)*V9020 NEXT E09030 GOSUB 92409040 H0=-H09050 GO TO 40009060 H0=09070 H0(1)=-19080 H0(7)=-19090 GO TO 40009100 GOSUB 40009110 IF V=0 THEN 92009120 H0=-H09130 GOSUB 97609140 V=(V*G5/G0)^29150 FOR E0=1 TO 89160 H0(E0)=H0(E0)/V9170 NEXT E09180 GOSUB 92409190 GO TO 40009200 H0=09210 H0(3)=19220 H0(5)=19230 GO TO 40009240 FOR E0=3 TO 69250 H0(E0)=-H0(E0)9260 NEXT E09270 GOSUB 97609280 RETURN 9290 GOSUB 95909300 H0=09310 H0(3)=19320 H0(5)=E09330 H0(6)=E59340 GO TO 40009350 GOSUB 95909360 H0=09370 H0(3)=E09380 H0(4)=E59390 H0(5)=19400 GO TO 40009410 GOSUB 95909420 E2=-19430 GO TO 94609440 GOSUB 95909450 E2=19460 H0(1)=-E2+E09470 H0(2)=E59480 H0(3)=2*(1+E0*E2)9490 H0(4)=2*E5*E29500 E0=3+E0*E29510 E5=E5*E29520 GOSUB 106509530 H0(5)=H0(3)9540 H0(6)=H0(4)9550 H0(7)=H0(1)9560 H0(8)=H0(2)9570 GOSUB 99409580 GO TO 40009590 GOSUB 97309600 E2=H0(1)-E09610 E3=H0(2)-E59620 E4=1-H0(7)9630 E5=-H0(8)9640 E6=E4^2+E5^29650 IF E6>0 THEN 97009660 E0=1.0E+100*E29670 E5=1.0E+100*E39680 GOSUB 100009690 RETURN 9700 E0=(E2*E4+E3*E5)/E69710 E5=(E3*E4-E2*E5)/E69720 RETURN 9730 E0=H0(1)*H0(7)-H0(2)*H0(8)-H0(3)*H0(5)+H0(4)*H0(6)9740 E5=H0(1)*H0(8)+H0(2)*H0(7)-H0(3)*H0(6)-H0(4)*H0(5)9750 RETURN 9760 GOSUB 97309770 H0(1)=H0(1)+E09780 H0(2)=H0(2)+E59790 E2=H0(1)+H0(7)+19800 E3=H0(2)+H0(8)9810 H0(7)=H0(7)+E09820 H0(8)=H0(8)+E59830 E0=E2^2+E3^29840 IF E0>0 THEN 98809850 GOSUB 100009860 E2=-2.0E+100*E29870 GO TO 99009880 E2=-2*E2/E09890 E3=2*E3/E09900 GOSUB 99409910 H0(1)=H0(1)+19920 H0(7)=H0(7)+19930 RETURN 9940 FOR E0=1 TO 7 STEP 29950 E4=E2*H0(E0)-E3*H0(E0+1)9960 H0(E0+1)=E2*H0(E0+1)+E3*H0(E0)9970 H0(E0)=E49980 NEXT E09990 RETURN 10000 PRINT "Possible error at ";E$;" at FREQ = ";G*G610010 RETURN 10020 GOSUB 976010030 H0=-H010040 GOSUB 976010050 GO TO 400010060 H0=-H010070 GOSUB 976010080 H0=-H010090 GOSUB 976010100 H0=-H010110 GO TO 400010120 GOSUB 1024010130 GOSUB 976010140 H0=-H010150 GOSUB 976010160 GOSUB 1024010170 GO TO 400010180 GOSUB 1025010190 GOSUB 976010200 H0=-H010210 GOSUB 976010220 GOSUB 1025010230 GO TO 400010240 H0=-H010250 FOR E0=5 TO 810260 H0(E0)=-H0(E0)10270 NEXT E010280 RETURN 10290 GOSUB 1045010300 GOSUB 1057010310 GOSUB 973010320 FOR E2=3 TO 610330 H0(E2)=-H0(E2)10340 NEXT E210350 FOR E2=1 TO 210360 E3=H0(E2)10370 H0(E2)=H0(E2+6)10380 H0(E2+6)=E310390 NEXT E210400 GOSUB 1065010410 GOSUB 994010420 GOSUB 1057010430 GOSUB 1045010440 GO TO 400010450 GOSUB 973010460 H0(3)=-E010470 H0(4)=-E510480 E0=H0(5)10490 E5=H0(6)10500 H0(5)=110510 H0(6)=010520 H0(7)=-H0(7)10530 H0(8)=-H0(8)10540 GOSUB 1065010550 GOSUB 994010560 RETURN 10570 FOR E2=1 TO 5 STEP 410580 FOR E3=0 TO 110590 E0=H0(E2+E3)10600 H0(E2+E3)=H0(E2+E3+2)10610 H0(E2+E3+2)=E010620 NEXT E310630 NEXT E210640 RETURN 10650 E6=E0^2+E5^210660 IF E6>0 THEN 1071010670 E2=1.0E+10010680 E3=010690 GOSUB 1000010700 RETURN 10710 E2=E0/E610720 E3=-E5/E610730 RETURN 