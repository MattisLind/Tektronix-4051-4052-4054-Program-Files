100 IF INT(V1/50)<>6 THEN 97110 V3=0120 IF V1>301 THEN 160130 PRINT @32,26:0140 PRINT "LIST RESULTS"150 V9=2160 GOSUB 4220170 IF V1>306 THEN 5050180 GO TO V1-300 OF 190,6550,6970,5830,6240,7530190 PRINT "Frequency Units (GHZ, MHZ, KHZ, or HZ)?        ";200 INPUT V$210 V=POS("   HZ  KHZ MHZ GHZ",V$,1)/4220 IF V<1 OR INT(V)<V THEN 190230 G6=1.0E+9*1000^(1-V)240 PRINT "Parameters (S, Y, Z, H, G, 1/S, 1/Y, or 1/Z)"250 PRINT "  or Outputs    (GAI, GAM, STA, MAT, or DEL)?  ";260 INPUT V$270 G1=POS("   S   Y   Z   H   G   1/S 1/Y 1/Z",V$,1)/4280 IF G1<1 OR INT(G1)<G1 THEN 340290 PRINT "Polar, DB, or Rectangular form (P, D, or R)?   ";300 INPUT V$310 G2=POS(" P D R",V$,1)/2320 IF G2<1 THEN 290330 GO TO 5080340 V1=POS("   GAI GAM DEL MAT STA",V$,1)/4+301350 IF V1<302 OR INT(V1)<V1 THEN 240360 GO TO 1603960 PRINT "DONE"3970 PRINT @32,26:03980 END 3990 E1=E1+14000 E2=POS(G$," ",E1)4010 E3=POS(G$,"",E1)4020 E4=POS(G$,",",E1)4030 IF E2=E1 OR E3=E1 OR E4=E1 THEN 39904040 IF E2+E3=-E4 THEN 39604050 E5=E2+30000*(E2=0) MIN E3+30000*(E3=0) MIN E4+30000*(E4=0)4060 V$=SEG(G$,E1,E5-E1)4070 E1=E54080 E$=SEG(V$,1,10)4090 V$=SEG(V$,1,3)4100 GO TO LEN(V$) OF 4200,4150,41104110 V1=POS("   GAI GAM DEL MAT STA",V$,1)/4+3014120 IF V1>301 THEN 1604130 V1=POS("   IS1 IS2 IY1 IY2 IZ1 IZ2",V$,1)/4+3614140 IF V1>361 THEN 974150 V$=SEG(V$,1,2)4160 V1=POS("  S- Y- Z- H- G- IS IY IZ",V$,1)/3+3064170 IF V1>306 THEN 1604180 V1=POS("  S1 S2 Y1 Y2 Z1 Z2 H1 H2 G1 G2",V$,1)/3+3514190 IF V1>351 THEN 974200 PRINT E$;" symbol not recognized"4210 END 4220 IF V3=13 THEN 42604230 V3=134240 FIND V34250 READ @33:H94260 RETURN 4270 V3=V3+14280 GO TO 42404290 PRINT "      NO DATA"4300 IF V9=1 THEN 43604310 PRINT "Press RETURN to continue";4320 INPUT V$4330 GOSUB 42204340 IF V9=2 THEN 2404350 GO TO 40004360 COPY 4370 GO TO 40004380 E0=H0(1)*H0(7)-H0(2)*H0(8)-H0(3)*H0(5)+H0(4)*H0(6)4390 E7=H0(1)*H0(8)+H0(2)*H0(7)-H0(3)*H0(6)-H0(4)*H0(5)4400 RETURN 4410 GOSUB 43804420 E2=H0(1)^2+H0(2)^24430 E3=H0(3)^2+H0(4)^24440 E4=H0(5)^2+H0(6)^24450 E5=H0(7)^2+H0(8)^24460 H2(7)=1+E2-E5-E0^2-E7^24470 H2(8)=1-E2+E5-E0^2-E7^24480 IF E3*E4>0 THEN 45804490 H2(1)=1.0E+1004500 IF E3>0 THEN 45304510 H2(2)=10004520 RETURN 4530 H2(2)=04540 IF H2(7)<0 THEN 45604550 H2(2)=(1+E0^2+E7^2-E2-E5)/E3^24560 H2(2)=10*LGT(H2(2)*(H2(2)>0)+1.0E-100*(H2(2)<=0))4570 RETURN 4580 H2(1)=(1+E0^2+E7^2-E2-E5)/2/SQR(E3*E4)4590 IF H2(1)<1 THEN 45704600 H2(2)=SQR(E4/E3)*(H2(1)-((H2(7)=>0)*2-1)*SQR(ABS(H2(1)^2-1)))4610 GO TO 45604620 E5=9*E6-74630 G=H9(E5)*G64640 FOR E0=1 TO 84650 E5=E5+14660 H0(E0)=H9(E5)4670 NEXT E04680 RETURN 4690 GO TO G1 OF 4840,4700,4730,4770,4810,4840,4700,47304700 GOSUB 54604710 H0=H0/G04720 GO TO 48404730 H0=-H04740 GOSUB 54604750 H0=G0*H04760 GO TO 48404770 GOSUB 56704780 GOSUB 54604790 GOSUB 57304800 GO TO 48404810 GOSUB 57104820 GOSUB 54604830 GOSUB 57804840 IF G1<6 THEN 48604850 GOSUB 49604860 IF G2=3 THEN 49504870 FOR E0=1 TO 7 STEP 24880 E2=H0(E0)^2+H0(E0+1)^24890 IF E2=0 THEN 49204900 H0(E0+1)=ACS(H0(E0)*SQR(E2)/E2)*((H0(E0+1)=>0)*2-1)4910 H0(E0)=SQR(E2)4920 IF G2=1 THEN 49404930 H0(E0)=20*LGT(H0(E0)*(H0(E0)>0)+1.0E-100*(H0(E0)<=0))4940 NEXT E04950 RETURN 4960 FOR E0=1 TO 7 STEP 24970 E2=H0(E0)^2+H0(E0+1)^24980 IF E2=0 THEN 50304990 H0(E0)=H0(E0)/E25000 H0(E0+1)=-H0(E0+1)/E25010 NEXT E05020 RETURN 5030 H0(E0)=1.0E+1005040 GO TO 50105050 G1=V1-3065060 H$=SEG(E$,3+(G1>5),1)5070 G2=POS("PDR",H$,1)5080 PAGE 5090 E$=SEG("    S  Y  Z  H  G1/S1/Y1/Z",G1*3,3)5100 PRINT USING "28X,3A,11A,20D.D,8A":E$,"-PARAMETERS",G0," OHMS ZR"5110 PRINT USING "4X,9A,7X,2D,3(13X,2D)":"FREQUENCY",11,12,21,225120 H$=SEG("GHZMHZKHZHZ ",LGT(G6)+1,3)5130 V$=SEG("MAG   ANGLEDB    ANGLEREAL   IMAG",G2*11-10,11)5140 PRINT USING "7X,3A,6X,11A,3(4X,11A)":H$,V$,V$,V$,V$5150 IF ABS(H9(1))>0 THEN 51705160 GO TO 42905170 FOR E6=1 TO ABS(H9(1))5180 GOSUB 52305190 NEXT E65200 IF H9(1)=>0 THEN 43005210 GOSUB 42705220 GO TO 51705230 GOSUB 46205240 GOSUB 46905250 E5=E6+30*(V3-13)5260 E0=ABS(H0(1)) MAX ABS(H0(3)) MAX ABS(H0(5)) MAX ABS(H0(7))5270 GO TO G2 OF 5330,5330,52805280 V$="3D,A,5D.2D,4(4D.3D,3D.3D)"5290 E7=ABS(H0(2)) MAX ABS(H0(4)) MAX ABS(H0(6)) MAX ABS(H0(8))5300 IF E0 MAX E7<99.9995 THEN 53705310 V$="3D,A,5D.2D,4(3E,4X),/,12X,4(4X,3E)"5320 GO TO 54005330 V$="3D,A,5D.2D,4(5D.3D,4D.D)"5340 IF E0<9999.9995 THEN 53705350 V$="3D,A,5D.2D,4(3E,4X),/,12X,4(9X,4D.D)"5360 GO TO 54005370 GOSUB 54305380 PRINT USING V$:E5,":",G,H05390 RETURN 5400 GOSUB 54305410 PRI USI V$:E5,":",G,H0(1),H0(3),H0(5),H0(7),H0(2),H0(4),H0(6),H0(8)5420 RETURN 5430 IF ABS(G)<9999.995 THEN 54505440 V$=REP("5E,/,12X",6,5)5450 RETURN 5460 GOSUB 43805470 H0(1)=H0(1)+E05480 H0(2)=H0(2)+E75490 E2=H0(1)+H0(7)+15500 E3=H0(2)+H0(8)5510 H0(7)=H0(7)+E05520 H0(8)=H0(8)+E75530 E0=E2^2+E3^25540 IF E0=0 THEN 56505550 E2=-2*E2/E05560 E3=2*E3/E05570 FOR E0=1 TO 7 STEP 25580 E4=E2*H0(E0)-E3*H0(E0+1)5590 H0(E0+1)=E2*H0(E0+1)+E3*H0(E0)5600 H0(E0)=E45610 NEXT E05620 H0(1)=H0(1)+15630 H0(7)=H0(7)+15640 RETURN 5650 PRINT "Computation not possible at FREQ = ";G5660 RETURN 5670 FOR E0=1 TO 45680 H0(E0)=-H0(E0)5690 NEXT E05700 RETURN 5710 FOR E0=5 TO 85720 GO TO 56805730 H0(1)=H0(1)*G05740 H0(2)=H0(2)*G05750 H0(7)=H0(7)/G05760 H0(8)=H0(8)/G05770 RETURN 5780 H0(1)=H0(1)/G05790 H0(2)=H0(2)/G05800 H0(7)=H0(7)*G05810 H0(8)=H0(8)*G05820 RETURN 5830 PAGE 5840 V$="5X,9A,8X,3A,9X,3A,10X,5A"5850 PRINT USING V$:"FREQUENCY","S21","S21","DELAY"5860 H$=SEG("GHZMHZKHZHZ",LGT(G6)+1,3)5870 E$=SEG(" NS US MSSEC",LGT(G6)+1,3)5880 PRINT USING "8X,3A,12X,2A,8X,5A,10X,3A":H$,"DB","ANGLE",E$5890 IF ABS(H9(1))>0 THEN 59105900 GO TO 42905910 H0=05920 H0(5)=15930 H3=05940 E7=05950 FOR E6=1 TO ABS(H9(1))5960 GOSUB 60105970 NEXT E65980 IF H9(1)=>0 THEN 43005990 GOSUB 42706000 GO TO 59506010 H2=H06020 GOSUB 46206030 E2=H0(5)^2+H0(6)^26040 H3(1)=10*LGT(E2*(E2>0)+1.0E-200*(E2=0))6050 H0(5)=H0(5)*(E2>0)+(E2=0)6060 E2=H0(5)*H2(5)+H0(6)*H2(6)6070 E3=H2(5)*H0(6)-H2(6)*H0(5)6080 E4=E2^2+E3^26090 H3(4)=ACS(E2*SQR(E4)/E4)*(2*(E3=>0)-1)6100 H3(2)=H3(2)+H3(4)6110 H3(3)=06120 IF E7=G OR (E6=1 AND V3=13) THEN 61406130 H3(3)=H3(4)/(E7-G)/3606140 E7=G6150 E5=E6+30*(V3-13)6160 V$="3D,A,5D.2D,2X,2(8D.3D),8D.6D"6170 IF ABS(H3(3))<9999999.9995 THEN 61906180 V$="3D,A,5D.2D,2X,2(8D.3D),4X,6E"6190 IF ABS(H3(2))<9999999.9995 THEN 62106200 V$=REP("8D.3D,X,3E",15,8)6210 GOSUB 54306220 PRINT USING V$:E5,":",G,H3(1),H3(2),H3(3)6230 RETURN 6240 PAGE 6250 V$="5X,9A,8X,4A,11X,14A,5X,16A"6260 PRI USI V$:"FREQUENCY","VSWR","RETURN LOSS DB","MISMATCH LOSS DB"6270 H$=SEG("GHZMHZKHZHZ",LGT(G6)+1,3)6280 PRINT USING "8X,3A,7X,2A,5(8X,2A)":H$,"11","22","11","22","11","22"6290 IF ABS(H9(1))>0 THEN 63106300 GO TO 42906310 FOR E6=1 TO ABS(H9(1))6320 GOSUB 63706330 NEXT E66340 IF H9(1)=>0 THEN 43006350 GOSUB 42706360 GO TO 63106370 GOSUB 46206380 FOR E0=0 TO 16390 E2=SQR(H0(1+6*E0)^2+H0(2+6*E0)^2)6400 IF E2<>1 THEN 64306410 H2(1+E0)=1.0E+1006420 GO TO 64406430 H2(1+E0)=(1+E2)/(1-E2)6440 H2(3+E0)=-20*LGT(E2*(E2>0)+1.0E-100*(E2=0))6450 E2=1-E2^26460 H2(5+E0)=-10*LGT(E2*(E2>0)+1.0E-100*(E2<=0))6470 NEXT E06480 E5=E6+30*(V3-13)6490 V$="3D,A,5D.2D,6(6D.3D)"6500 IF ABS(H2(1)) MAX ABS(H2(2))<99999.9995 THEN 65206510 V$="3D,A,5D.2D,2(2E),4(6D.3D)"6520 GOSUB 54306530 PRINT USING V$:E5,":",G,H2(1),H2(2),H2(3),H2(4),H2(5),H2(6)6540 RETURN 6550 PAGE 6560 V$="5X,9A,5X,A,8X,4A,6X,3A,6X,5A,5X,6A,6X,A"6570 PRINT USING V$:"FREQUENCY","K","GMAX","MSG","MASON","UNILAT","U"6580 H$=SEG("GHZMHZKHZHZ",LGT(G6)+1,3)6590 PRINT USING "8X,3A,10X,4(8X,2A)":H$,"DB","DB","DB","DB"6600 IF ABS(H9(1))>0 THEN 66206610 GO TO 42906620 FOR E6=1 TO ABS(H9(1))6630 GOSUB 66806640 NEXT E66650 IF H9(1)=>0 THEN 43006660 GOSUB 42706670 GO TO 66206680 GOSUB 46206690 GOSUB 44106700 H2(3)=(E4*(E4>0)+1.0E-200*(E4=0))/(E3*(E3>0)+1.0E-200*(E3=0))6710 H2(3)=5*LGT(H2(3))6720 H2(4)=1+E0^2+E7^2-E2-E5-2*(H0(3)*H0(5)+H0(4)*H0(6))6730 IF H2(4)<>0 THEN 67606740 H2(4)=10006750 GO TO 67806760 H2(4)=((H0(3)-H0(5))^2+(H0(4)-H0(6))^2)/H2(4)6770 H2(4)=10*LGT(H2(4)*(H2(4)>0)+1.0E-100*(H2(4)<=0))6780 H2(5)=(1-E2)*(1-E5)6790 H2(5)=ABS(H2(5)*(H2(5)<>0)+1.0E-100*(H2(5)=0))6800 H2(6)=SQR(E2*E3*E4*E5)/H2(5)6810 H2(5)=10*LGT((E4*(E4>0)+1.0E-100*(E4=0))/H2(5))6820 E0=ABS(H2(1)) MAX ABS(H2(6))6830 E5=E6+30*(V3-13)6840 IF H2(1)<=1 THEN 69106850 V$="3D,A,5D.2D,6(6D.3D)"6860 IF E0<99999.9995 THEN 68806870 V$="3D,A,5D.2D,2E,4(6D.3D),2E"6880 GOSUB 54306890 PRINT USING V$:E5,":",G,H2(1),H2(2),H2(3),H2(4),H2(5),H2(6)6900 RETURN 6910 V$="3D,A,5D.2D,6D.3D,10X,4(6D.3D)"6920 IF E0<99999.9995 THEN 69406930 V$="3D,A,5D.2D,2E,10X,3(6D.3D),2E"6940 GOSUB 54306950 PRINT USING V$:E5,":",G,H2(1),H2(3),H2(4),H2(5),H2(6)6960 RETURN 6970 PAGE 6980 V$="5X,9A,5X,A,8X,4A,9X,8A,12X,8A"6990 PRINT USING V$:"FREQUENCY","K","GMAX","GAMMA MS","GAMMA ML"7000 H$=SEG("GHZMHZKHZHZ",LGT(G6)+1,3)7010 V$="8X,3A,18X,2A, X,2(6X,3A,6X,5A)"7020 PRINT USING V$:H$,"DB","MAG","ANGLE","MAG","ANGLE"7030 IF ABS(H9(1))>0 THEN 70507040 GO TO 42907050 FOR E6=1 TO ABS(H9(1))7060 GOSUB 73807070 NEXT E67080 IF H9(1)=>0 THEN 43007090 GOSUB 42707100 GO TO 70507110 FOR G2=0 TO 17120 H3(1+2*G2)=H0(1+6*G2)-E0*H0(7-6*G2)-E7*H0(8-6*G2)7130 H3(2+2*G2)=-H0(2+6*G2)-E0*H0(8-6*G2)+E7*H0(7-6*G2)7140 H3(5+G2)=H3(1+2*G2)^2+H3(2+2*G2)^27150 NEXT G27160 RETURN 7170 FOR G2=0 TO 17180 E2=SQR(ABS(H2(7+G2)^2-4*H3(5+G2)))*((H2(7+G2)=>0)*2-1)7190 IF ABS(H2(1))<=1 THEN 72807200 E2=H2(7+G2)-E27210 IF H3(5+G2)>0 THEN 72507220 H2(3+2*G2)=1.0E+1007230 H2(4+2*G2)=07240 GO TO 73007250 H2(3+2*G2)=H3(1+2*G2)*E2/H3(5+G2)/27260 H2(4+2*G2)=H3(2+2*G2)*E2/H3(5+G2)/27270 GO TO 73007280 H2(3+2*G2)=(H3(1+2*G2)*H2(7+G2)-H3(2+2*G2)*E2)/2/H3(5+G2)7290 H2(4+2*G2)=(H3(2+2*G2)*H2(7+G2)+H3(1+2*G2)*E2)/2/H3(5+G2)7300 NEXT G27310 FOR E0=3 TO 5 STEP 27320 E2=H2(E0)^2+H2(E0+1)^27330 IF E2=0 THEN 73607340 H2(E0+1)=ACS(H2(E0)*SQR(E2)/E2)*((H2(E0+1)=>0)*2-1)7350 H2(E0)=SQR(E2)7360 NEXT E07370 RETURN 7380 GOSUB 46207390 GOSUB 44107400 GOSUB 71107410 GOSUB 71707420 E0=ABS(H2(1)) MAX ABS(H2(3)) MAX ABS(H2(5))7430 E5=E6+30*(V3-13)7440 IF H2(1)<=1 THEN 74907450 V$="3D,A,5D.2D,6(6D.3D)"7460 IF E0<99999.9995 THEN 74807470 V$="3D,A,5D.2D,3(2E,6D.3D)"7480 GO TO 68807490 V$="3D,A,5D.2D,6D.3D,10X,4(6D.3D)"7500 IF E0<99999.9995 THEN 75207510 V$="3D,A,5D.2D,2E,10X,2(2E,6D.3D)"7520 GO TO 69407530 PAGE 7540 PRINT "     FREQUENCY   CENTER 11   RADIUS STABLE";7550 PRINT "     CENTER 22   RADIUS STABLE"7560 H$=SEG("GHZMHZKHZHZ",LGT(G6)+1,3)7570 V$="8X,3A,X,2(4X,3A,3X,5A,9X,6A)"7580 PRINT USING V$:H$,"MAG","ANGLE","INSIDE","MAG","ANGLE","INSIDE"7590 IF ABS(H9(1))>0 THEN 76107600 GO TO 42907610 FOR E6=1 TO ABS(H9(1))7620 GOSUB 76707630 NEXT E67640 IF H9(1)=>0 THEN 43007650 GOSUB 42707660 GO TO 75907670 GOSUB 46207680 GOSUB 44107690 GOSUB 71107700 E$="NO "7710 H$="NO "7720 IF H3(5)>E3*E4 THEN 77407730 E$="YES"7740 IF H3(6)>E3*E4 THEN 77607750 H$="YES"7760 H3(7)=E2-E0^2-E7^27770 H3(8)=E5-E0^2-E7^27780 FOR G2=0 TO 17790 IF H3(7+G2)<>0 THEN 78407800 H2(1+G2)=1.0E+1007810 H2(3+2*G2)=1.0E+1007820 H2(4+2*G2)=07830 GO TO 78707840 H2(1+G2)=SQR(E3*E4)/ABS(H3(7+G2))7850 H2(3+2*G2)=H3(1+2*G2)/H3(7+G2)7860 H2(4+2*G2)=H3(2+2*G2)/H3(7+G2)7870 NEXT G27880 GOSUB 73107890 E5=E6+30*(V3-13)7900 E2=ABS(H2(1)) MAX ABS(H2(2)) MAX ABS(H2(3)) MAX ABS(H2(5))7910 V$="3D,A,5D.2D,2(5D.3D,4D.D,4D.3D,3X,3A,X)"7920 IF E2<999.9995 THEN 79707930 V$="3D,A,5D.2D,2(4E,2X,4E,4X)/11X,2(10X,4D.D,11X,3A)"7940 GOSUB 54307950 PRINT USING V$:E5,":",G,H2(3),H2(1),H2(5),H2(2),H2(4),E$,H2(6),H$7960 RETURN 7970 GOSUB 54307980 PRINT USING V$:E5,":",G,H2(3),H2(4),H2(1),E$,H2(5),H2(6),H2(2),H$7990 RETURN 