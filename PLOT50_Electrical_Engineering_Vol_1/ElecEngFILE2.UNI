100 IF INT(V1/50)<>0 THEN 97110 PRINT @32,26:0120 GO TO V1 OF 130,220,2030,2980,1560,1190,1820,1690,3810130 PRINT "ENTER CODE"140 E3=1150 GOSUB 350160 G$=""170 GO TO 190180 GOSUB 350190 G$=G$&V$200 E3=E3+1210 GO TO 180220 PRINT "LIST CODE"230 E3=0240 E2=0250 E3=E3+1260 E1=E2+1270 E2=POS(G$,"",E1)280 IF E2<E1 THEN 410290 GOSUB 310300 GO TO 250310 V$=SEG(G$,E1,E2-E1)320 PRINT USING "2D,3A,S":E3,":  "330 PRINT V$340 RETURN 350 PRINT USING "2D,3A,S":E3,":  "360 INPUT V$370 V$=V$&""380 RETURN 390 PRINT "Diagnostic completed.  Errors are noted above."400 END 410 PRINT "Code length = ";LEN(G$);420 PRINT ".  Simple diagnostic (Y or N)?  ";430 INPUT V$440 IF V$="Y" THEN 470450 IF V$="N" THEN 400460 GO TO 410470 E1=0480 E6=0490 G1=1500 G2=1510 E1=E1+1520 E2=POS(G$," ",E1)530 E3=POS(G$,"",E1)540 E4=POS(G$,",",E1)550 IF E3<>E1 THEN 570560 G1=G1+1570 IF E2=E1 OR E3=E1 OR E4=E1 THEN 510580 IF E2+E3=-E4 THEN 390590 E5=E2+30000*(E2=0) MIN E3+30000*(E3=0) MIN E4+30000*(E4=0)600 V$=SEG(G$,E1,E5-E1)610 E1=E5620 IF V$=>":" OR V$<"+" OR (V$<"0" AND V$=>"/") THEN 650630 E6=E6-1 MAX 0640 GO TO 520650 H$=SEG(V$,1,3)660 IF H$<>"VAL" AND H$<>"VAR" THEN 680670 GO TO 630680 IF E6=0 THEN 710690 PRINT "Line ";G2;":  Need more variables for ";E$;"."700 E6=0710 G2=G1720 E$=SEG(V$,1,10)730 V$=H$740 GO TO LEN(V$) OF 1130,870,750750 E6=0760 V1=POS("   NEX COP MPS MPP GHZ MHZ KHZ MIL REV CR+ CR- BRS",V$,1)/4770 IF V1>0 THEN 520780 V1=POS("   BRP GAI GAM DEL MAT STA IS1 IS2 IY1 IY2 IZ1 IZ2",V$,1)/4790 IF V1>0 THEN 520800 V1=POS("   ICA IPA ISE ISP IPS DSP DPS STO REC DAT",V$,1)/4810 E6=V1>5820 IF V1>0 THEN 520830 E6=3840 V1=POS("   SZS SZP PZS PZP TL0",V$,1)/4850 E6=E6+(V1=5)860 IF V1>0 THEN 520870 V$=SEG(V$,1,2)880 E6=0890 V1=POS("  EQ CA PA SE SP PS BC BE CB CE EB EC S- Y- Z- H- G-",V$,1)900 IF V1>0 THEN 520910 V1=POS("  HZ PF NF UF NH UH MH IN CM OH KO MO S?",V$,1)/3920 IF V1>0 THEN 520930 V1=POS("  S1 S2 Y1 Y2 Z1 Z2 H1 H2 G1 G2 IS IY IZ",V$,1)/3940 IF V1>0 THEN 520950 E6=1960 V1=POS("  RS RP CS CP LS LP XS XP ZR TF GY",V$,1)970 IF V1>0 THEN 520980 E6=2990 V1=POS("  YC ZC AI AV TL",V$,1)/31000 E6=E6+3*(V1=5)1010 IF V1>0 THEN 5201020 V1=POS("  FR LO FE FS",V$,1)/31030 IF V1<1 THEN 11301040 E9=POS(G$,"NEX",E1)1050 IF E9>0 THEN 10701060 PRINT "Line ";G2;":  Need a ""NEX"" after ";E$;" loop."1070 IF V1>1 THEN 11101080 E9=POS(G$,":",E1)1090 IF E9>0 THEN 11101100 PRINT "Line ";G2;":  Need a "":"" after ";E$;" specification."1110 E6=(V1>1)+2*(V1>2)1120 GO TO 5201130 V$=SEG(V$,1,1)1140 E6=01150 V1=POS(" F H M",V$,1)/21160 IF V1>0 THEN 5201170 PRINT "Line ";G2;":  Do not recognize ";E$;"."1180 GO TO 5201190 PRINT "EDIT CODE"1200 PRINT "Enter line No.: ";1210 INPUT E01220 E4=INT(ABS(E0))1230 E1=11240 E2=01250 E3=01260 IF E4<1 THEN 13401270 E3=11280 E1=E2+11290 E2=POS(G$,"",E1)1300 IF E2=0 THEN 13401310 E3=E3+11320 IF E3<=E4 THEN 12801330 E3=E3-11340 IF E0=>0 THEN 14001350 IF E3<-E0 OR E2=0 THEN 14601360 PRINT "Deleted line"1370 GOSUB 3101380 V$=""1390 GO TO 14501400 IF E2=0 OR E0>E4 THEN 14801410 PRINT "Replaced line"1420 GOSUB 3101430 PRINT "Enter new line"1440 GOSUB 3501450 G$=REP(V$,E1,E2-E1+1)1460 PRINT 1470 GO TO 12001480 IF E2=0 THEN 15001490 GO TO 15101500 IF E4>0 THEN 15301510 E3=E3+11520 E1=E2+11530 PRINT "Insert new line"1540 E2=E1-11550 GO TO 14401560 PRINT "CODE ON TAPE"1570 PRINT "Code To or From tape (T or F)?  ";1580 INPUT V$1590 IF V$<>"T" AND V$<>"F" THEN 15701600 PRINT "Code File No. (1 through 25)?   ";1610 INPUT V1620 IF V<1 OR V>25 THEN 16001630 FIND INT(V)+421640 IF V$="F" THEN 16701650 PRINT @33:G$1660 END 1670 INPUT @33:G$1680 END 1690 PRINT "DATA ON TAPE"1700 PRINT "Data To or From tape (T or F)?  ";1710 INPUT V$1720 IF V$<>"T" AND V$<>"F" THEN 17001730 PRINT "Data File No. (1 through ";43-V4;")?	";1740 INPUT V1750 IF V<1 OR V>43-V4 THEN 17301760 FIND INT(V)+V4-11770 IF V$="F" THEN 18001780 WRITE H1790 END 1800 READ @33:H1810 END 1820 PRINT "RESULTS ON TAPE"1830 PRINT "Data To or From results (T or F)?  ";1840 INPUT V$1850 IF V$<>"T" AND V$<>"F" THEN 18301860 PRINT "Results File No. (1 through ";V4-13;")?	";1870 INPUT V1880 IF V<1 OR V>V4-13 THEN 18601890 FIND INT(V)+121900 IF V$="T" THEN 19401910 READ @33:H1920 H(1)=ABS(H(1))1930 END 1940 IF H(1)=30 AND V<V4-13 THEN 19701950 WRITE H1960 END 1970 PRINT "More data after file ";V;" (Y or N)?   ";1980 INPUT V$1990 IF V$="N" THEN 19502000 IF V$<>"Y" THEN 19702010 H(1)=-302020 GO TO 19502030 PRINT "ENTER DATA"2040 GOSUB 24702050 GOSUB 41702060 H=02070 E5=02080 E5=E5+12090 GOSUB 21302100 H(1)=E52110 IF E5<30 THEN 20802120 END 2130 PRINT USING "2D,3A,S":E5,":  "2140 INPUT G,H02150 IF G2=3 THEN 22302160 FOR E0=1 TO 7 STEP 22170 E2=H0(E0)2180 IF G2=1 THEN 22002190 E2=10^(E2/20)2200 H0(E0)=E2*COS(H0(E0+1))2210 H0(E0+1)=E2*SIN(H0(E0+1))2220 NEXT E02230 IF G1<6 THEN 22502240 GOSUB 28902250 GO TO G1 OF 2400,2260,2290,2330,2370,2400,2260,22902260 H0=G0*H02270 GOSUB 34302280 GO TO 24002290 H0=H0/G02300 GOSUB 34302310 H0=-H02320 GO TO 24002330 GOSUB 37602340 GOSUB 34302350 GOSUB 36502360 GO TO 24002370 GOSUB 37102380 GOSUB 34302390 GOSUB 36702400 E6=9*E5-72410 H(E6)=G/G62420 FOR E0=1 TO 82430 E6=E6+12440 H(E6)=H0(E0)2450 NEXT E02460 RETURN 2470 PRINT "Frequency Units (GHZ, MHZ, KHZ, or HZ)?        ";2480 INPUT V$2490 V=POS("   HZ  KHZ MHZ GHZ",V$,1)/42500 IF V<1 OR INT(V)<V THEN 24702510 G6=1.0E+9*1000^(1-V)2520 PRINT "Parameters (S, Y, Z, H, G, 1/S, 1/Y, or 1/Z)?  ";2530 INPUT V$2540 G1=POS("   S   Y   Z   H   G   1/S 1/Y 1/Z",V$,1)/42550 IF G1<1 OR INT(G1)<G1 THEN 25202560 PRINT "Polar, DB, or Rectangular form (P, D, or R)?   ";2570 INPUT V$2580 G2=POS(" P D R",V$,1)/22590 IF G2<1 THEN 25602600 RETURN 2610 GO TO G1 OF 2760,2620,2650,2690,2730,2760,2620,26502620 GOSUB 34302630 H0=H0/G02640 GO TO 27602650 H0=-H02660 GOSUB 34302670 H0=G0*H02680 GO TO 27602690 GOSUB 36502700 GOSUB 34302710 GOSUB 37102720 GO TO 27602730 GOSUB 36702740 GOSUB 34302750 GOSUB 37602760 IF G1<6 THEN 27802770 GOSUB 28902780 IF G2=3 THEN 28802790 FOR E0=1 TO 7 STEP 22800 E1=E0+12810 E2=H0(E0)^2+H0(E0+1)^22820 IF E2=0 THEN 28502830 H0(E0+1)=ACS(H0(E0)*SQR(E2)/E2)*((H0(E0+1)=>0)*2-1)2840 H0(E0)=SQR(E2)2850 IF G2=1 THEN 28702860 H0(E0)=20*LGT(H0(E0)*(H0(E0)>0)+1.0E-100*(H0(E0)<=0))2870 NEXT E02880 RETURN 2890 FOR E0=1 TO 7 STEP 22900 E2=H0(E0)^2+H0(E0+1)^22910 IF E2=0 THEN 29602920 H0(E0)=H0(E0)/E22930 H0(E0+1)=-H0(E0+1)/E22940 NEXT E02950 RETURN 2960 H0(E0)=1.0E+1002970 GO TO 29402980 PRINT "LIST DATA"2990 GOSUB 24703000 PAGE 3010 GOSUB 30903020 IF H(1)>0 THEN 30503030 PRINT "     NO DATA"3040 END 3050 FOR E5=1 TO H(1)3060 GOSUB 31603070 NEXT E53080 END 3090 E$=SEG("    S  Y  Z  H  G1/S1/Y1/Z",G1*3,3)3100 PRINT USING "28X,3A,11A,20D.D,8A":E$,"-PARAMETERS",G0," OHMS ZR"3110 PRINT USING "4X,9A,7X,2D,3(13X,2D)":"FREQUENCY",11,12,21,223120 H$=SEG("GHZMHZKHZHZ",LGT(G6)+1,3)3130 V$=SEG("MAG   ANGLEDB    ANGLEREAL   IMAG",G2*11-10,11)3140 PRINT USING "7X,3A,6X,11A,3(4X,11A)":H$,V$,V$,V$,V$3150 RETURN 3160 E6=9*E5-73170 G=H(E6)*G63180 FOR E0=1 TO 83190 E6=E6+13200 H0(E0)=H(E6)3210 NEXT E03220 GOSUB 26103230 E0=ABS(H0(1)) MAX ABS(H0(3)) MAX ABS(H0(5)) MAX ABS(H0(7))3240 GO TO G2 OF 3300,3300,32503250 V$="2D,A,6D.2D,4(4D.3D,3D.3D)"3260 E1=ABS(H0(2)) MAX ABS(H0(4)) MAX ABS(H0(6)) MAX ABS(H0(8))3270 IF E0 MAX E1<99.995 THEN 33403280 V$="2D,A,6D.2D,4(3E,4X),/,12X,4(4X,3E)"3290 GO TO 33703300 V$="2D,A,6D.2D,4(5D.3D,4D.D)"3310 IF E0<9999.9995 THEN 33403320 V$="2D,A,6D.2D,4(3E,4X),/,12X,4(9X,4D.D)"3330 GO TO 33703340 GOSUB 34003350 PRINT USING V$:E5,":",G,H03360 RETURN 3370 GOSUB 34003380 PRI USI V$:E5,":",G,H0(1),H0(3),H0(5),H0(7),H0(2),H0(4),H0(6),H0(8)3390 RETURN 3400 IF ABS(G)<99999.995 THEN 34203410 V$=REP("6E,/,12X",6,5)3420 RETURN 3430 E0=H0(1)*H0(7)-H0(2)*H0(8)-H0(3)*H0(5)+H0(4)*H0(6)3440 E1=H0(1)*H0(8)+H0(2)*H0(7)-H0(3)*H0(6)-H0(4)*H0(5)3450 H0(1)=H0(1)+E03460 H0(2)=H0(2)+E13470 E2=H0(1)+H0(7)+13480 E3=H0(2)+H0(8)3490 H0(7)=H0(7)+E03500 H0(8)=H0(8)+E13510 E0=E2^2+E3^23520 IF E0=0 THEN 36303530 E2=-2*E2/E03540 E3=2*E3/E03550 FOR E0=1 TO 7 STEP 23560 E4=E2*H0(E0)-E3*H0(E0+1)3570 H0(E0+1)=E2*H0(E0+1)+E3*H0(E0)3580 H0(E0)=E43590 NEXT E03600 H0(1)=H0(1)+13610 H0(7)=H0(7)+13620 RETURN 3630 PRINT "Computation not possible at FREQ = ";G3640 RETURN 3650 FOR E0=1 TO 43660 GO TO 36803670 FOR E0=5 TO 83680 H0(E0)=-H0(E0)3690 NEXT E03700 RETURN 3710 H0(1)=H0(1)*G03720 H0(2)=H0(2)*G03730 H0(7)=H0(7)/G03740 H0(8)=H0(8)/G03750 RETURN 3760 H0(1)=H0(1)/G03770 H0(2)=H0(2)/G03780 H0(7)=H0(7)*G03790 H0(8)=H0(8)*G03800 RETURN 3810 PRINT "EDIT DATA"3820 GOSUB 24703830 PRINT "
Enter line No.: ";3840 INPUT E03850 E5=INT(ABS(E0))3860 IF E0<0 AND E5<=H(1) AND E5=-E0 THEN 39003870 IF E5=E0 AND E5<=H(1) AND E5>0 THEN 40003880 IF E0=>0 AND H(1)<30 THEN 40603890 GO TO 38303900 PRINT "Deleted Data:"3910 GOSUB 30903920 GOSUB 31603930 IF E5=H(1) THEN 39803940 FOR E1=9*E5+2 TO 9*H(1)+13950 E0=E1-93960 H(E0)=H(E1)3970 NEXT E13980 H(1)=H(1)-13990 GO TO 38304000 PRINT "Replaced Data:"4010 GOSUB 30904020 GOSUB 31604030 GOSUB 41704040 GOSUB 21304050 GO TO 38304060 GOSUB 41704070 E5=E5+14080 E5=E5 MIN H(1)+14090 IF E5=H(1)+1 THEN 41404100 FOR E0=9*H(1)+1 TO 9*E5-7 STEP -14110 E1=E0+94120 H(E1)=H(E0)4130 NEXT E04140 H(1)=H(1)+14150 GOSUB 21304160 GO TO 38304170 PRINT "Enter FREQ and 11, 12, 21, and 22 data"4180 RETURN 