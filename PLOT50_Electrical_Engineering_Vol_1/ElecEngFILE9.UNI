100 IF INT(V1/50)<>7 THEN 97110 V3=0120 IF V1>351 THEN 160130 PRINT @32,26:0140 V9=2150 PRINT "PLOT TWO-PORTS"160 GOSUB 4220170 IF H9(1)=0 THEN 4290180 H4=1190 ROTATE 0200 IF V1>351 THEN 990210 PRINT "Parameters (S, Y, Z, H, G, 1/S, 1/Y, or 1/Z)?  ";220 INPUT V$230 G1=POS("   S   Y   Z   H   G   1/S 1/Y 1/Z",V$,1)/4240 IF G1<1 OR INT(G1)<G1 THEN 210250 PRINT "	       (11, 12, 21, or 22)?  ";260 INPUT V$270 E=2*POS("  11 12 21 22",V$,1)/3-1280 IF E<1 OR INT(E)<E THEN 250290 IF G1=1 OR G1=6 THEN 360300 PRINT "	     (M, A, D, R, I, or P)?  ";310 INPUT V$320 G2=POS(" M A D I R P",V$,1)/2330 IF G2<1 THEN 300340 IF G2>5 THEN 660350 GO TO 410360 PRINT "	  (M, A, D, R, I, P, or S)?  ";370 INPUT V$380 G2=POS(" M A D I R P S",V$,1)/2390 IF G2<1 THEN 360400 IF G2>5 THEN 660410 PRINT "
Frequency Axis (LIN or LOG)?		";420 INPUT V$430 H4(7)=POS("   LIN LOG",V$,1)/4440 IF H4(7)<1 OR INT(H4(7))<H4(7) THEN 410450 IF G2=2 OR G2=3 THEN 500460 PRINT "Vertical Axis (LIN or LOG)?		";470 INPUT V$480 H4(8)=POS("   LIN LOG",V$,1)/4490 IF H4(8)<1 OR INT(H4(8))<H4(8) THEN 460500 PRINT "
Autoscaling (Y or N)?		";510 INPUT V$520 IF V$="Y" THEN 590530 IF V$<>"N" THEN 500540 GOSUB 900550 PRINT "Vertical Range Minimum and Maximum?		";560 INPUT H4(3),H4(4)570 IF H4(4)<H4(3) THEN 550580 GO TO 630590 GOSUB 1140600 IF INT(G2/2)<G2/2 THEN 630610 H4(3)=H4(5)620 H4(4)=H4(6)630 PAGE 640 GOSUB 1640650 GO TO 3510660 PRINT "
Autoscaling (Y or N)?		";670 INPUT V$680 IF V$="Y" THEN 780690 IF V$<>"N" THEN 660700 GOSUB 900710 IF G2=7 THEN 870720 PRINT "Maximum Radius Component?		";730 INPUT H4(3)740 H4(3)=ABS(H4(3))750 IF H4(3)=0 THEN 720760 GOSUB 3200770 GO TO 3720780 H4(1)=-8.9E+307790 H4(2)=8.9E+307800 V1=1810 IF G2=7 THEN 870820 GOSUB 1140830 H4(3)=ABS(H4(3)) MAX ABS(H4(4)) MAX ABS(H4(5)) MAX ABS(H4(6))840 H4(3)=H4(3)+(H4(3)=0)850 GOSUB 3200860 GO TO 3720870 H4(3)=1880 GOSUB 2650890 GO TO 3720900 PRINT "Frequency Units (GHZ, MHZ, KHZ, or HZ)?        ";910 INPUT V$920 V=POS("   HZ  KHZ MHZ GHZ",V$,1)/4930 IF V<1 OR INT(V)<V THEN 900940 V1=1.0E+9*1000^(1-V)950 PRINT "Frequency Range Minimum and Maximum?	";960 INPUT H4(1),H4(2)970 IF H4(2)<H4(1) THEN 950980 RETURN 990 G1=INT((V1-350)/2)1000 H$=SEG(E$,2+(G1>5),2)1010 E=2*INT(POS("    11 12 21 22",H$,1)/3)-1 MAX 11020 H$=SEG(E$,4+(G1>5),1)1030 G2=INT(POS(" M A D I R P S",H$,1)/2)1040 H4=11050 IF G2=7 AND (G1=1 OR G1=6) THEN 7801060 G2=G2+6*(G2=0) MIN 61070 IF G2=6 THEN 7801080 H$=SEG(E$,6+(G1>5),2)1090 H4(7)=INT(POS(" LILO",H$,1)/2) MAX 11100 IF G2=2 OR G2=3 THEN 5901110 H$=SEG(E$,8+(G1>5),2)1120 H4(8)=POS(" LILO",H$,1)/2 MAX 11130 GO TO 5901140 FOR E6=1 TO 5 STEP 21150 H4(E6)=8.9E+3071160 H4(E6+1)=-8.9E+3071170 NEXT E61180 V1=11190 FOR E6=1 TO ABS(H9(1))1200 GOSUB 48101210 H4(1)=H4(1) MIN G1220 H4(2)=H4(2) MAX G1230 H4(3)=H4(3) MIN H0(E)1240 H4(4)=H4(4) MAX H0(E)1250 H4(5)=H4(5) MIN H0(E+1)1260 H4(6)=H4(6) MAX H0(E+1)1270 NEXT E61280 IF H9(1)=>0 THEN 13101290 GOSUB 42701300 GO TO 11901310 V1=1.0E+91320 IF H4(1)=0 AND H4(2)=0 THEN 13801330 V1=LGT(ABS(H4(1))+(H4(1)=0)*1.0E-9)1340 V1=INT(-(LGT(ABS(H4(2))+(H4(2)=0)*1.0E-9) MAX V1)/3+1.0E-10)+11350 V1=10^(3*(V1 MIN 3 MAX 0))1360 H4(1)=H4(1)*V11370 H4(2)=H4(2)*V11380 RETURN 1390 IF E7<E8 THEN 14201400 E7=E7-ABS(E7)/10-(E7=0)1410 E8=E8+ABS(E8)/10+(E8=0)1420 E3=INT(LGT(E8-E7)+1.0E-10)1430 E2=(E8-E7)/10^E31440 IF E2>2 THEN 14701450 E6=10^(E3-1)1460 GO TO 15101470 IF E2>5 THEN 15001480 E6=10^E3/51490 GO TO 15101500 E6=10^E3/21510 E4=INT(E7/E6+1.0E-10)*E61520 E5=-INT(-E8/E6+1.0E-10)*E61530 RETURN 1540 E7=E7 MAX 1.0E-1001550 E8=E8 MAX 1.0E-1001560 IF E7<E8 OR INT(LGT(E7)+1.0E-10)<LGT(E7) THEN 15901570 E7=E7/101580 E8=10*E81590 E4=10^INT(LGT(E7)+1.0E-10)1600 E5=LGT(E8)1610 E5=10^(INT(E5+1.0E-10)+(INT(E5+1.0E-10)<E5))1620 E6=LGT(E5/E4)1630 RETURN 1640 FOR E9=0 TO 11650 E7=H4(1+2*E9)1660 E8=H4(2+2*E9)1670 GOSUB H4(7+E9) OF 1390,15401680 H1(7+E9)=E61690 H1(1+2*E9)=E41700 H1(2+2*E9)=E51710 NEXT E91720 GOSUB H4(7) OF 1990,20301730 GOSUB H4(8) OF 2320,23601740 E$=SEG("    S  Y  Z  H  G1/S1/Y1/Z",G1*3,3)1750 H$=SEG("11122122",E,2)1760 V$=SEG("MAGNITUDEANGLE    DB       IMAGINARYREAL",G2*9-8,9)1770 HOME @V5:1780 PRINT @V5:"






 ";E$;H$;"-";V$1790 HOME @V5:1800 V$=SEG("      PER DIVDECADES",H4(8)*7,7)1810 IF ABS(H1(3)) MAX ABS(H1(4))>999999.9995 THEN 18601820 IF H1(8)<1.0E-3 OR (H1(3)<1.0E-3 AND H4(8)=2) THEN 18601830 PRINT @V5: USING "12D.3D,15/,12D.3D,/,9X,7A":H1(4),H1(8),V$1840 PRINT @V5: USING "15/,12D.3D":H1(3)1850 GO TO 18801860 PRINT @V5: USING "2X,6E,15/,7X,E,/,9X,7A":H1(4),H1(8),V$1870 PRINT @V5: USING "15/,2X,6E":H1(3)1880 V$=SEG("      PER DIVDECADES",H4(7)*7,7)1890 IF ABS(H1(1)) MAX ABS(H1(2))>999999.9995 THEN 19301900 IF H1(7)<1.0E-3 OR (H1(1)<1.0E-3 AND H4(7)=2) THEN 19301910 PRINT @V5: USING "17D.3D,16D.3D,X,7A,18D.3D":H1(1),H1(7),V$,H1(2)1920 GO TO 19401930 PRINT @V5: USING "10X,6E,9X,E,X,7A,8X,6E":H1(1),H1(7),V$,H1(2)1940 E$=SEG("(GHZ)(MHZ)(KHZ)(HZ)",LGT(V1)*5/3+1,5)1950 PRINT @V5: USING "35X,10A,5A,S":"FREQUENCY",E$1960 HOME @V5:1970 WINDOW H1(1),H1(2),H1(3),H1(4)1980 RETURN 1990 WINDOW 0,1,0,12000 AXIS @V5:H1(7)/(H1(2)-H1(1)),0,-1,02010 AXIS @V5:H1(7)/(H1(2)-H1(1)),0,2,12020 RETURN 2030 IF H1(7)>9 THEN 22202040 WINDOW 0,H1(7),0,1002050 E0=12060 GOSUB 21102070 WINDOW 0,H1(7),-100,02080 E0=-12090 GOSUB 21102100 RETURN 2110 FOR E2=0 TO H1(7)-12120 MOVE @V5:E2,02130 FOR E3=2 TO 102140 RDRAW @V5:LGT(E3/(E3-1)),02150 RDRAW @V5:0,E02160 RMOVE @V5:0,-E02170 NEXT E32180 RDRAW @V5:0,2*E02190 RMOVE @V5:0,-2*E02200 NEXT E22210 RETURN 2220 E7=LGT(H1(1))2230 E8=LGT(H1(2))2240 GOSUB 13902250 H1(1)=10^E42260 H1(2)=10^E52270 H1(7)=E5-E42280 WINDOW 0,1,0,12290 AXIS @V5:E6/(E4-E5),0,-1,02300 AXIS @V5:E6/(E4-E5),0,2,12310 RETURN 2320 WINDOW 0,1,0,12330 AXIS @V5:0,H1(8)/(H1(4)-H1(3)),0,-12340 AXIS @V5:0,H1(8)/(H1(4)-H1(3)),1,22350 RETURN 2360 IF H1(8)>9 THEN 25502370 WINDOW 0,100,0,H1(8)2380 E0=12390 GOSUB 24402400 WINDOW -100,0,0,H1(8)2410 E0=-12420 GOSUB 24402430 RETURN 2440 FOR E2=0 TO H1(8)-12450 MOVE @V5:0,E22460 FOR E3=2 TO 102470 RDRAW @V5:0,LGT(E3/(E3-1))2480 RDRAW @V5:E0,02490 RMOVE @V5:-E0,02500 NEXT E32510 RDRAW @V5:2*E0,02520 RMOVE @V5:-2*E0,02530 NEXT E22540 RETURN 2550 E7=LGT(H1(3))2560 E8=LGT(H1(4))2570 GOSUB 13902580 H1(3)=10^E42590 H1(4)=10^E52600 H1(8)=E5-E42610 WINDOW 0,1,0,12620 AXIS @V5:0,E6/(E4-E5),0,-12630 AXIS @V5:0,E6/(E4-E5),1,22640 RETURN 2650 E4=-12660 E5=12670 E6=0.12680 PAGE 2690 WINDOW E4,E5,E4,E52700 AXIS @V5:0,0,E4,E42710 AXIS @V5:0,0,E5,E52720 AXIS @V5:0,0,2,02730 E2=3602740 G3=02750 G4=02760 GOSUB 30802770 G3=1/32780 GOSUB 30802790 G3=0.52800 GOSUB 30802810 G3=2/32820 GOSUB 30802830 G3=12840 G4=22850 E2=-2*ATN(0.5)2860 GOSUB 30802870 G4=-22880 E2=-E22890 GOSUB 30802900 G4=12910 E2=-902920 GOSUB 30802930 G4=-12940 E2=902950 GOSUB 30802960 G4=0.52970 E2=-2*ATN(2)2980 GOSUB 30802990 G4=-0.53000 E2=-E23010 GOSUB 30803020 E$=SEG("  S1/S",(G1-1)*0.6+1,3)3030 H$=SEG("11122122",E,2)3040 HOME @V5:3050 PRINT @V5:"








";E$;H$;"-SMITH PLOT";"






0"3060 PRINT @V5: USING "16/,26X,16A,15A,A":".5","1","2"3070 RETURN 3080 MOVE @V5:1,03090 H2(1)=1-G33100 H2(2)=-G43110 H2(3)=COS(E2/36)3120 H2(4)=SIN(E2/36)3130 FOR E3=1 TO 363140 H2(5)=H2(1)*H2(3)-H2(2)*H2(4)3150 H2(2)=H2(2)*H2(3)+H2(1)*H2(4)3160 H2(1)=H2(5)3170 DRAW @V5:H2(1)+G3,H2(2)+G43180 NEXT E33190 RETURN 3200 E8=H4(3)3210 E7=-H4(3)3220 GOSUB 13903230 PAGE 3240 E4=-E53250 WINDOW E4,E5,E4,E53260 AXIS @V5:0,0,E4,E43270 AXIS @V5:0,0,E5,E53280 G4=E5/1003290 FOR E0=30 TO 360 STEP 303300 ROTATE E03310 MOVE @V5:0,03320 FOR E2=E6 TO E5*1.3 STEP E63330 RDRAW @V5:E6,03340 RDRAW @V5:0,G43350 RDRAW @V5:0,-G4*23360 RMOVE @V5:0,G43370 NEXT E23380 NEXT E03390 E$=SEG("    S  Y  Z  H  G1/S1/Y1/Z",G1*3,3)3400 H$=SEG("11122122",E,2)3410 HOME @V5:3420 PRINT @V5:"








";E$;H$;"-POLAR PLOT"3430 HOME @V5:3440 IF E5>999999.9995 OR E6<1.0E-3 THEN 34803450 PRINT @V5: USING "12D.3D,32/,12D.3D":E5,E43460 PRINT @V5: USING "17D.3D,17D.3D,8A,17D.3D":E4,E6," PER DIV",E53470 RETURN 3480 PRINT @V5: USING "2X,6E,32/,2X,6E":E5,E43490 PRINT @V5: USING "10X,6E,9X,E,8A,8X,6E":E4,E6," PER DIV",E53500 RETURN 3510 G3=(H1(2)-H1(1))*0.0063520 G4=(H1(4)-H1(3))*0.00953530 E9=E+(INT(G2/2)=G2/2)3540 GOSUB 42203550 FOR E6=1 TO ABS(H9(1))3560 GOSUB 48103570 IF G<H4(1) OR G>H4(2) OR H0(E9)<H4(3) OR H0(E9)>H4(4) THEN 36803580 E2=G3590 IF H4(7)=1 THEN 36203600 E2=LGT(G*(G>0)+1.0E-100*(G<=0))3610 E2=(E2-LGT(H1(1)))/(LGT(H1(2))-LGT(H1(1)))*(H1(2)-H1(1))+H1(1)3620 E3=H0(E9)3630 IF H4(8)=1 THEN 36603640 E3=LGT(E3*(E3>0)+1.0E-100*(E3<=0))3650 E3=(E3-LGT(H1(3)))/(LGT(H1(4))-LGT(H1(3)))*(H1(4)-H1(3))+H1(3)3660 MOVE @V5:E2-G3,E3-G43670 PRINT @V5:"x";3680 NEXT E63690 IF H9(1)=>0 THEN 43003700 GOSUB 42703710 GO TO 35503720 G3=E5*0.0123730 G4=E5*0.0193740 GOSUB 42203750 FOR E6=1 TO ABS(H9(1))3760 GOSUB 48103770 IF ABS(H0(E))>H4(3) OR ABS(H0(E+1))>H4(3) THEN 38103780 IF G<H4(1) OR G>H4(2) THEN 38103790 MOVE @V5:H0(E)-G3,H0(E+1)-G43800 PRINT @V5:"x";3810 NEXT E63820 IF H9(1)=>0 THEN 43003830 GOSUB 42703840 GO TO 37503960 PRINT "DONE"3970 PRINT @32,26:03980 END 3990 E1=E1+14000 E2=POS(G$," ",E1)4010 E3=POS(G$,"",E1)4020 E4=POS(G$,",",E1)4030 IF E2=E1 OR E3=E1 OR E4=E1 THEN 39904040 IF E2+E3=-E4 THEN 39604050 E5=E2+30000*(E2=0) MIN E3+30000*(E3=0) MIN E4+30000*(E4=0)4060 V$=SEG(G$,E1,E5-E1)4070 E1=E54080 E$=SEG(V$,1,10)4090 V$=SEG(V$,1,3)4100 GO TO LEN(V$) OF 4200,4150,41104110 V1=POS("   GAI GAM DEL MAT STA",V$,1)/4+3014120 IF V1>301 THEN 974130 V1=POS("   IS1 IS2 IY1 IY2 IZ1 IZ2",V$,1)/4+3614140 IF V1>361 THEN 1604150 V$=SEG(V$,1,2)4160 V1=POS("  S- Y- Z- H- G- IS IY IZ",V$,1)/3+3064170 IF V1>306 THEN 974180 V1=POS("  S1 S2 Y1 Y2 Z1 Z2 H1 H2 G1 G2",V$,1)/3+3514190 IF V1>351 THEN 1604200 PRINT E$;" symbol not recognized"4210 END 4220 IF V3=13 THEN 42604230 V3=134240 FIND V34250 READ @33:H94260 RETURN 4270 V3=V3+14280 GO TO 42404290 PRINT "NO DATA"4300 IF V9=1 THEN 43604310 PRINT "

















Press RETURNto continue";4320 INPUT V$4330 V1=3514340 IF V9=2 THEN 1604350 GO TO 40004360 COPY 4370 PRINT "
"4380 GO TO 40004390 E0=H0(1)*H0(7)-H0(2)*H0(8)-H0(3)*H0(5)+H0(4)*H0(6)4400 E7=H0(1)*H0(8)+H0(2)*H0(7)-H0(3)*H0(6)-H0(4)*H0(5)4410 RETURN 4420 E5=9*E6-74430 G=H9(E5)*V14440 FOR E0=1 TO 84450 E5=E5+14460 H0(E0)=H9(E5)4470 NEXT E04480 RETURN 4490 GO TO G1 OF 4640,4500,4530,4570,4610,4640,4500,45304500 GOSUB 48404510 H0=H0/G04520 GO TO 46404530 H0=-H04540 GOSUB 48404550 H0=G0*H04560 GO TO 46404570 GOSUB 50304580 GOSUB 48404590 GOSUB 50904600 GO TO 46404610 GOSUB 50704620 GOSUB 48404630 GOSUB 51404640 IF G1<6 THEN 46604650 GOSUB 47404660 IF G2>3 THEN 47304670 E2=H0(E)^2+H0(E+1)^24680 IF E2=0 THEN 47104690 H0(E+1)=ACS(H0(E)*SQR(E2)/E2)*((H0(E+1)=>0)*2-1)4700 H0(E)=SQR(E2)4710 IF G2<3 THEN 47304720 H0(E)=20*LGT(H0(E)*(H0(E)>0)+1.0E-100*(H0(E)<=0))4730 RETURN 4740 E2=H0(E)^2+H0(E+1)^24750 IF E2=0 THEN 47904760 H0(E)=H0(E)/E24770 H0(E+1)=-H0(E+1)/E24780 RETURN 4790 H0(E)=1.0E+1004800 RETURN 4810 GOSUB 44204820 GOSUB 44904830 RETURN 4840 GOSUB 43904850 H0(1)=H0(1)+E04860 H0(2)=H0(2)+E74870 E2=H0(1)+H0(7)+14880 E3=H0(2)+H0(8)4890 H0(7)=H0(7)+E04900 H0(8)=H0(8)+E74910 E0=E2^2+E3^24920 IF E0=0 THEN 50204930 E2=-2*E2/E04940 E3=2*E3/E04950 FOR E0=1 TO 7 STEP 24960 E4=E2*H0(E0)-E3*H0(E0+1)4970 H0(E0+1)=E2*H0(E0+1)+E3*H0(E0)4980 H0(E0)=E44990 NEXT E05000 H0(1)=H0(1)+15010 H0(7)=H0(7)+15020 RETURN 5030 FOR E0=1 TO 45040 H0(E0)=-H0(E0)5050 NEXT E05060 RETURN 5070 FOR E0=5 TO 85080 GO TO 50405090 H0(1)=H0(1)*G05100 H0(2)=H0(2)*G05110 H0(7)=H0(7)/G05120 H0(8)=H0(8)/G05130 RETURN 5140 H0(1)=H0(1)/G05150 H0(2)=H0(2)/G05160 H0(7)=H0(7)*G05170 H0(8)=H0(8)*G05180 RETURN 