5000 IF INT(V1/50)<>3 THEN 49705010 GO TO INT((V1-151)/10) OF 50305020 GO TO V1-150 OF 7090,7190,7290,7390,7590,5080,5170,5240,5350,54005030 GO TO V1-160 OF 5480,5530,5560,5590,5620,5660,5690,5730,5800,74905040 PRINT "Calculation not possible for ";E$;" at FREQ = ";G*G65050 RETURN 5060 PRINT "Undefined S-parameters for ";E$;" at FREQ = ";G*G65070 GO TO 40005080 GOSUB 40005090 E4=V*G5/G0/25100 IF E4=-1 THEN 50605110 H0=05120 H0(1)=E4/(1+E4)5130 H0(3)=1/(1+E4)5140 H0(5)=H0(3)5150 H0(7)=H0(1)5160 GO TO 40005170 GOSUB 40005180 E4=2*V*G5/G05190 IF E4=-1 THEN 50605200 H0=05210 H0(1)=-1/(1+E4)5220 H0(3)=E4/(1+E4)5230 GO TO 51405240 GOSUB 40005250 E5=V*G7*G*G0*PI/2505260 H0=05270 H0(1)=15280 H0(4)=E55290 H0(6)=E55300 H0(7)=H0(1)5310 E2=1/(1+E5^2)5320 E3=-E2*E55330 GOSUB 66705340 GO TO 40005350 GOSUB 40005360 E5=V*G7*G*G0*PI/10005370 IF E5=0 THEN 54205380 E5=-1/E55390 GO TO 55005400 GOSUB 40005410 E5=V*G8*G*PI/G05420 H0=05430 H0(2)=E55440 H0(3)=15450 H0(5)=15460 H0(8)=E55470 GO TO 53105480 GOSUB 40005490 E5=4*V*G8*G*PI/G05500 H0=05510 H0(1)=-15520 GO TO 52805530 GOSUB 40005540 E5=V*G5/G0/25550 GO TO 54205560 GOSUB 40005570 E5=2*V*G5/G05580 GO TO 55005590 GOSUB 59305600 V0=05610 GO TO 40005620 GOSUB 59305630 V0=15640 H1=H05650 GO TO 40005660 GOSUB 59305670 V0=25680 GO TO 56405690 GOSUB 59305700 V0=35710 H1=-H05720 GO TO 40005730 GOSUB 59305740 V0=45750 H1=H05760 FOR E0=1 TO 45770 H1(E0)=-H1(E0)5780 NEXT E05790 GO TO 40005800 GOSUB 59305810 V0=55820 H1=-H05830 GO TO 57605840 GO TO V0 OF 5880,5880,5890,5850,59105850 FOR E0=1 TO 45860 H0(E0)=-H0(E0)5870 NEXT E05880 RETURN 5890 H0=-H05900 RETURN 5910 H0=-H05920 GO TO 58505930 IF V0=0 THEN 58805940 GOSUB 58405950 H2=H05960 IF V0=1 THEN 62805970 GOSUB 67405980 H0=H1-H05990 H0=H0+H26000 H0(1)=H0(1)+36010 H0(7)=H0(7)+36020 GOSUB 65206030 H4=H06040 H1(1)=H1(1)+16050 H1(7)=H1(7)+16060 H3=H16070 GOSUB 67406080 H1=H06090 H2=H46100 GOSUB 67406110 H1=H06120 H2=H36130 GOSUB 67406140 E2=46150 E3=06160 GOSUB 66706170 H2=H0+H36180 H2(1)=H2(1)-26190 H2(7)=H2(7)-26200 H0=H36210 H0(1)=H0(1)+26220 H0(7)=H0(7)+26230 GOSUB 65206240 H1=H06250 GOSUB 67406260 GOSUB 58406270 RETURN 6280 E4=1-H1(7)*H2(1)+H1(8)*H2(2)6290 E5=H1(7)*H2(2)+H1(8)*H2(1)6300 E3=E4^2+E5^26310 IF E3=0 THEN 50406320 E2=E4/E36330 E3=E5/E36340 E4=H1(3)*H2(1)-H1(4)*H2(2)6350 E5=H1(3)*H2(2)+H1(4)*H2(1)6360 H0(1)=E4*H1(5)-E5*H1(6)6370 H0(2)=E4*H1(6)+E5*H1(5)6380 H0(3)=H1(3)*H2(3)-H1(4)*H2(4)6390 H0(4)=H1(3)*H2(4)+H1(4)*H2(3)6400 H0(5)=H1(5)*H2(5)-H1(6)*H2(6)6410 H0(6)=H1(5)*H2(6)+H1(6)*H2(5)6420 E4=H1(7)*H2(5)-H1(8)*H2(6)6430 E5=H1(7)*H2(6)+H1(8)*H2(5)6440 H0(7)=E4*H2(3)-E5*H2(4)6450 H0(8)=E4*H2(4)+E5*H2(3)6460 GOSUB 66706470 H0(1)=H0(1)+H1(1)6480 H0(2)=H0(2)+H1(2)6490 H0(7)=H0(7)+H2(7)6500 H0(8)=H0(8)+H2(8)6510 RETURN 6520 E4=H0(1)*H0(7)-H0(2)*H0(8)-H0(3)*H0(5)+H0(4)*H0(6)6530 E5=H0(1)*H0(8)+H0(2)*H0(7)-H0(3)*H0(6)-H0(4)*H0(5)6540 E3=E4^2+E5^26550 IF E3=0 THEN 50406560 E2=E4/E36570 E3=-E5/E36580 H0=-H06590 E4=H0(1)6600 H0(1)=-H0(7)6610 H0(7)=-E46620 E5=H0(2)6630 H0(2)=-H0(8)6640 H0(8)=-E56650 GOSUB 66706660 RETURN 6670 FOR E4=1 TO 7 STEP 26680 E5=E4+16690 E0=E2*H0(E4)-E3*H0(E5)6700 H0(E5)=E2*H0(E5)+E3*H0(E4)6710 H0(E4)=E06720 NEXT E46730 RETURN 6740 H0(1)=H1(1)*H2(1)-H1(2)*H2(2)+H1(3)*H2(5)-H1(4)*H2(6)6750 H0(2)=H1(1)*H2(2)+H1(2)*H2(1)+H1(3)*H2(6)+H1(4)*H2(5)6760 H0(3)=H1(1)*H2(3)-H1(2)*H2(4)+H1(3)*H2(7)-H1(4)*H2(8)6770 H0(4)=H1(1)*H2(4)+H1(2)*H2(3)+H1(3)*H2(8)+H1(4)*H2(7)6780 H0(5)=H1(5)*H2(1)-H1(6)*H2(2)+H1(7)*H2(5)-H1(8)*H2(6)6790 H0(6)=H1(5)*H2(2)+H1(6)*H2(1)+H1(7)*H2(6)+H1(8)*H2(5)6800 H0(7)=H1(5)*H2(3)-H1(6)*H2(4)+H1(7)*H2(7)-H1(8)*H2(8)6810 H0(8)=H1(5)*H2(4)+H1(6)*H2(3)+H1(7)*H2(8)+H1(8)*H2(7)6820 RETURN 6830 E2=E4/E36840 E3=-E5/E36850 H0(5)=H0(3)6860 H0(6)=H0(4)6870 H0(7)=H0(1)6880 H0(8)=H0(2)6890 GOSUB 66706900 GO TO 40006910 E$=REP("R",2,1)6920 GOSUB 40006930 E0=V*G56940 E$=REP("L",2,1)6950 GOSUB 40006960 E6=V*G86970 E$=REP("C",2,1)6980 GOSUB 40006990 E7=V*G7/10007000 E2=2*PI*G7010 E$=REP("Z",2,1)7020 RETURN 7030 H0(3)=17040 H0(5)=17050 GO TO 40007060 H0(1)=-17070 H0(7)=-17080 GO TO 40007090 GOSUB 69107100 E4=1-E6*E7*E2^27110 E5=E2*E7*(E0+2*G0)7120 E3=E4^2+E5^27130 H0=07140 IF E3=0 THEN 50407150 H0(1)=E47160 H0(2)=E2*E0*E77170 H0(4)=2*E2*E7*G07180 GO TO 68307190 GOSUB 69107200 E4=2-2*E6*E7*E2^27210 E5=E2*E7*(G0+2*E0)7220 E3=E4^2+E5^27230 H0=07240 IF E3=0 THEN 50407250 H0(2)=-E2*E7*G07260 H0(3)=E47270 H0(4)=2*E2*E0*E77280 GO TO 68307290 GOSUB 69107300 E4=2*E0*(1-E6*E7*E2^2)7310 E5=E2*E6*(2+E0/G0)7320 E3=E4^2+E5^27330 H0=07340 IF E3=0 THEN 70307350 H0(2)=E2*E6*E0/G07360 H0(3)=E47370 H0(4)=2*E2*E67380 GO TO 68307390 GOSUB 69107400 E4=E0*(1-E6*E7*E2^2)7410 E5=E2*E6*(1+2*E0/G0)7420 E3=E4^2+E5^27430 H0=07440 IF E3=0 THEN 70607450 H0(1)=-E47460 H0(2)=-E2*E67470 H0(4)=2*E2*E6*E0/G07480 GO TO 68307490 GOSUB 79307500 E$=REP("X",LEN(E$),1)7510 GOSUB 40007520 H0(1)=V7530 E$=REP("E",LEN(E$),1)7540 GOSUB 40007550 E7=SQR(ABS(V))*36*2.54/2.99792458*G*H0(1)/G97560 GOSUB 79707570 E5=E5*H0(1)7580 GO TO 76707590 GOSUB 79307600 E$=REP("0",LEN(E$),1)7610 GOSUB 40007620 E7=V7630 GOSUB 79707640 IF E6=0 THEN 76607650 E7=E7*G*G6/E67660 E5=E5*E7/3607670 IF E6=0 THEN 76907680 E5=E5*SQR(ABS(G*G6/E6))7690 E2=EXP(E5)7700 E3=EXP(-E5)7710 E4=COS(E7)7720 E5=SIN(E7)7730 H0(3)=4*E07740 H0(4)=07750 H0(1)=(E0^2-1)*(E2-E3)*E47760 H0(2)=(E0^2-1)*(E2+E3)*E57770 E6=((E0+1)^2*E2-(E0-1)^2*E3)*E47780 E7=((E0+1)^2*E2+(E0-1)^2*E3)*E57790 E5=E6^2+E7^27800 IF E5=0 THEN 50607810 E4=E6/E57820 E5=-E7/E57830 FOR E0=1 TO 3 STEP 27840 E3=H0(E0+1)7850 H0(E0+1)=H0(E0)*E5+E3*E47860 H0(E0)=H0(E0)*E4-E3*E57870 NEXT E07880 H0(5)=H0(3)7890 H0(6)=H0(4)7900 H0(7)=H0(1)7910 H0(8)=H0(2)7920 GO TO 40007930 E$=E$&"-Z"7940 GOSUB 40007950 E0=V*G5/G07960 RETURN 7970 E$=REP("F",LEN(E$),1)7980 GOSUB 40007990 E6=V8000 E$=REP("D",LEN(E$),1)8010 GOSUB 40008020 E5=V*LOG(10)/208030 E$=SEG(E$,1,LEN(E$)-2)8040 RETURN 