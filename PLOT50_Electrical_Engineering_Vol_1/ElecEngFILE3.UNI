100 IF INT(V1/50)<>1 THEN 97110 PRINT @32,26:0120 GO TO 3930130 H0=0140 GO TO V7 OF 180,230150 H0(1)=1/3160 H0(3)=2/3170 GO TO 370180 H0(1)=0.2190 H0(2)=0.4200 H0(4)=-0.4210 H0(3)=0.8220 GO TO 370230 H0(1)=0.2240 H0(2)=-0.4250 H0(4)=0.4260 GO TO 210270 H0=0280 GO TO V7 OF 310,340290 H0(1)=-1/3300 GO TO 160310 H0(1)=-0.2320 H0(2)=0.4330 GO TO 250340 H0(1)=-0.2350 H0(2)=-0.4360 GO TO 200370 V7=V7+1380 H0(5)=H0(3)390 H0(6)=H0(4)400 H0(7)=H0(1)410 H0(8)=H0(2)420 GO TO 4000430 PRINT "Enter S11, S12, S21, and S22 at FREQ = ";G*G6440 INPUT H0450 FOR E0=1 TO 7 STEP 2460 E2=H0(E0)470 H0(E0)=E2*COS(H0(E0+1))480 H0(E0+1)=E2*SIN(H0(E0+1))490 NEXT E0500 GO TO 4000510 V9=1520 PRINT @32,26:3530 GO TO 4000540 IF H9(1)<30 OR V3=V4 THEN 610550 IF V3=V4-1 THEN 590560 H9(1)=-30570 FIND V3580 WRITE H9590 V3=V3+1600 H9=0610 RETURN 620 E$=E$&"#1"630 GOSUB 4000640 G=V/G6650 E$=REP("2",LEN(E$),1)660 GOSUB 4000670 G2=V/G6680 E$=REP("3",LEN(E$),1)690 GOSUB 4000700 G4=1710 E=1720 GOSUB 540730 G3=0740 E8=E1750 RETURN 760 GOSUB 620770 G1=V/G6780 IF G1=0 THEN 800790 E=INT((G2-G)/G1+1-1.0E-9)+1800 IF E8>E9 THEN 4000810 RETURN 820 GOSUB 620830 G1=INT(ABS(V))840 G3=1850 IF G1*G*G2<=0 OR G1=1 THEN 800860 E=G1870 G1=(G2/G)^(1/(G1-1))880 GO TO 800890 GOSUB 4000900 G1=0910 GOSUB 700920 E=INT(ABS(V)) MAX 1930 GO TO 800940 GOSUB 4000950 GOSUB 1000960 FOR E0=1 TO 8970 E2=E2+1980 H5(E2)=H0(E0)990 GO TO 11001000 IF V<1 OR V>10 THEN 10301010 E2=8*INT(V)-81020 RETURN 1030 PRINT E$;" ";V;" index is <1 or >10"1040 END 1050 GOSUB 40001060 GOSUB 10001070 FOR E0=1 TO 81080 E2=E2+11090 H0(E0)=H5(E2)1100 NEXT E01110 GO TO 40001120 GOSUB 40001130 E0=INT(ABS(V))1140 IF E0=>1 AND E0<=43-V4 THEN 11701150 PRINT E$;" ";E0;" index is <1 or >";43-V41160 END 1170 IF V2=E0 THEN 12101180 V2=E01190 FIND V2+V4-11200 READ @33:H1210 IF H(1)=0 THEN 13501220 E0=21230 IF H(1)=1 OR G<=H(2) THEN 13001240 E0=111250 IF G=H(E0) THEN 13001260 IF G<H(E0) THEN 13801270 E0=E0+91280 IF E0<9*H(1) THEN 12501290 E0=E0-91300 FOR E2=1 TO 81310 E0=E0+11320 H0(E2)=H(E0)1330 NEXT E21340 GO TO 40001350 H0=01360 PRINT "No DATA at ";V21370 GO TO 40001380 E4=(G-H(E0-9))/(H(E0)-H(E0-9))1390 E0=E0-11400 FOR E2=1 TO 7 STEP 21410 E0=E0+21420 H0(E2)=H(E0)*E4+H(E0-9)*(1-E4)1430 H0(E2+1)=H(E0+1)*E4+H(E0-8)*(1-E4)1440 E3=SQR(H0(E2)^2+H0(E2+1)^2)1450 IF E3=0 THEN 14901460 E3=(SQR(H(E0)^2+H(E0+1)^2)*E4+SQR(H(E0-9)^2+H(E0-8)^2)*(1-E4))/E31470 H0(E2)=H0(E2)*E31480 H0(E2+1)=H0(E2+1)*E31490 NEXT E21500 GO TO 40001510 E9=POS(G$,":",E1)1520 E8=E11530 GOSUB 5401540 IF E9>0 THEN 18001550 PRINT "Need a "":"" after ";E$;" specification"1560 END 1570 V8=-11580 IF V3=V4 THEN 19701590 H9(1)=H9(1)+11600 E3=9*H9(1)-71610 H9(E3)=G1620 FOR E2=1 TO 81630 E3=E3+11640 H9(E3)=H0(E2)1650 NEXT E21660 IF H9(1)<30 THEN 17601670 IF V3<V4-1 AND (E8<E9 OR G4<E OR V7=1 OR V7=2) THEN 17101680 FIND V31690 WRITE H91700 GO TO 19701710 H9(1)=-301720 FIND V31730 WRITE H91740 V3=V3+11750 H9=01760 G4=G4+1-(V7>0)+(V7=3)1770 IF V7=1 OR V7=2 THEN 19201780 IF G4<=E THEN 19001790 E$="FREQUENCY"1800 IF E8>E9 THEN 16801810 E1=E81820 G4=11830 E=11840 G1=01850 G3=-11860 GOSUB 40001870 E8=E11880 IF G3>-1 THEN 19201890 G=V/G61900 IF G3=1 THEN 19501910 G=G1+G1920 E1=E9+1 MAX E81930 V7=V7-3*(V7=3)1940 GO TO 40001950 G=G*G11960 GO TO 19201970 V8=11980 V1=4521990 IF V7>0 THEN 972000 V7=02010 GO TO 40003900 PRINT "DONE"3910 PRINT @32,26:03920 END 3930 DATA 0,0,0,50,1,1,1,1,2.54,0,0,13,0,1,03940 READ E1,E9,G,G0,G5,G6,G7,G8,G9,V0,V2,V3,V7,V8,V93950 RESTORE 3960 PRINT "RUN"3970 H9=03980 H0=03990 E1=E1+14000 E2=POS(G$," ",E1)4010 E3=POS(G$,"",E1)4020 E4=POS(G$,",",E1)4030 IF E2=E1 OR E3=E1 OR E4=E1 THEN 39904040 IF E2+E3=-E4 THEN 39004050 E5=E2+30000*(E2=0) MIN E3+30000*(E3=0) MIN E4+30000*(E4=0)4060 V$=SEG(G$,E1,E5-E1)4070 E1=E54080 IF V$=>":" OR V$<"+" OR (V$<"0" AND V$=>"/") THEN 41104090 V=VAL(V$)4100 RETURN 4110 H$=SEG(V$,1,3)4120 IF H$<>"VAL" THEN 42404130 IF V8>0 THEN 41704140 V=H8(-V8)4150 V8=V8-14160 RETURN 4170 GOSUB 42504180 IF V8=21 THEN 42204190 H8(V8)=V4200 V8=V8+14210 RETURN 4220 PRINT "No. of variables exceeds 20 at ";E$4230 END 4240 IF H$<>"VAR" THEN 42804250 PRINT E$;"?	";4260 INPUT V4270 RETURN 4280 E$=SEG(V$,1,10)4290 V$=H$4300 GO TO LEN(V$) OF 4580,4440,43104310 V1=POS("   STO REC DAT NEX COP MPS MPP",V$,1)/44320 GO TO V1 OF 940,1050,1120,1570,510,130,2704330 V1=POS("   GHZ MHZ KHZ MIL",V$,1)/4+1004340 IF V1>100 THEN 50004350 V1=POS("   SZS SZP PZS PZP TL0",V$,1)/4+150+V6*1004360 IF V1>150+V6*100 THEN 50004370 V1=POS("   REV CR+ CR- BRS BRP DSP DPS IPA ISE ISP IPS ICA",V$,1)4380 V1=V1/4+200+V6*704390 IF V1>200+V6*70 THEN 50004400 V1=POS("   GAI GAM DEL MAT STA",V$,1)/4+3014410 IF V1>301 THEN 974420 V1=POS("   IS1 IS2 IY1 IY2 IZ1 IZ2",V$,1)/4+3614430 IF V1>361 THEN 974440 V$=SEG(V$,1,2)4450 V1=POS("  FR FS FE LO S?",V$,1)/34460 GO TO V1 OF 1510,760,820,890,4304470 V1=POS("  HZ PF NF UF NH UH MH IN CM ZR OH KO MO",V$,1)/3+1044480 IF V1>104 THEN 50004490 V1=POS("  RS RP CS CP LS LP XS XP EQ CA PA SE SP PS TL",V$,1)4500 V1=V1/3+155+V6*1004510 IF V1>155+V6*100 THEN 50004520 V1=POS("  BC BE CB CE EB EC YC ZC AI AV TF GY",V$,1)/3+212+V6*704530 IF V1>212+V6*70 THEN 50004540 V1=POS("  S- Y- Z- H- G- IS IY IZ",V$,1)/3+3064550 IF V1>306 THEN 974560 V1=POS("  S1 S2 Y1 Y2 Z1 Z2 H1 H2 G1 G2",V$,1)/3+3514570 IF V1>351 THEN 974580 V$=SEG(V$,1,1)4590 V1=POS(" F H M",V$,1)/2+1174600 IF V1>117 THEN 50004610 PRINT E$;" symbol not recognized"4620 END 4970 FIND INT(V1/50)+24980 DELETE 5001,399984990 APPEND 50005000 REM39999 GO TO 4970