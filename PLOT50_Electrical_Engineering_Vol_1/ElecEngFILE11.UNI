100 IF INT(V1/50)<>9 THEN 97110 H0=0120 PRINT "MAPPING"130 ROTATE 0140 PRINT @32,26:0150 IF V1>451 THEN 630160 V3=0170 PRINT "Frequency Units (GHZ, MHZ, KHZ, or HZ)?  ";180 INPUT V$190 G6=POS("   HZ  KHZ MHZ GHZ",V$,1)/4200 IF G6<1 OR INT(G6)<G6 THEN 170210 G6=1.0E+9*1000^(1-G6)220 PRINT "Impedance Units (OH, KO, or MO)?         ";230 INPUT V$240 G5=POS("  OH KO MO",V$,1)/3250 IF G5<1 OR INT(G5)<G5 THEN 220260 G5=1000^(G5-1)270 PRINT "Inductance Units (NH, UH, MH, or H)?     ";280 INPUT V$290 G8=POS("  H  MH UH NH",V$,1)/3300 IF G8<1 THEN 270310 G8=1000^(4-G8)320 PRINT "Capacitance Units (PF, NF, UF, or F)?    ";330 INPUT V$340 G7=POS("  F     UF NF PF",V$,1)/3350 IF G7<1 THEN 320360 G7=1000^(5-G7)370 PRINT "
Are mapping results on tape (Y or N)?    ";380 INPUT V$390 IF V$="Y" THEN 630400 IF V$<>"N" THEN 370410 PRINT "Load, Source, or General (L, S, or G)?   ";420 INPUT V$430 H3(7)=-POS(" L S G",V$,1)/2440 IF H3(7)=>0 THEN 410450 IF H3(7)<-2 THEN 540460 GOSUB 1150470 GOSUB 1010480 PRINT "
Enter S11, S12, S21, and S22"490 INPUT H0500 GOSUB 2810510 GOSUB 3110520 GOSUB 5820530 GO TO 730540 GOSUB 1050550 GOSUB 1150560 GOSUB 1010570 PRINT "
Enter S";E$;" for Z = ";G0;", ";G0;"j, and ";-G0;"j ohms"580 INPUT H0(1),H0(2),H0(3),H0(4),H0(5),H0(6)590 GOSUB 2810600 GOSUB 3110610 GOSUB 5900620 GO TO 730630 GOSUB 2720640 IF H9(1)=0 THEN 2790650 IF ABS(H9(1))=>3 AND H9(2)=H9(11) THEN 680660 GOSUB 1110670 GO TO 710680 H3(7)=3690 GOSUB 1050700 GOSUB 1150710 GOSUB 1010720 GOSUB 2870730 GOSUB 2200740 PRINT "
Polar or Smith (P or S)?	     ";750 INPUT V$760 V=POS(" P S",V$,1)/2770 IF V<1 THEN 740780 PRINT "Positive Resistance Region (Y or N)?     ";790 INPUT V$800 H3(8)=POS(" N Y",V$,1)/2810 IF H3(8)<1 THEN 780820 IF V=2 THEN 970830 PRINT "
Autoscaling (Y or N)?	     ";840 INPUT V$850 IF V$="Y" THEN 920860 IF V$<>"N" THEN 830870 PRINT "Maximum Radius Component?	     ";880 INPUT H1(8)890 H1(8)=ABS(H1(8))900 IF H1(8)=0 THEN 870910 GO TO 950920 GOSUB 1200930 H1(8)=(ABS(G3) MAX ABS(G4))+H4(3)940 H1(8)=H1(8)+(H1(8)=0)950 GOSUB 1940960 GO TO 3220970 H1(8)=1980 GOSUB 1390990 GOSUB 12001000 GO TO 32201010 PRINT "Frequency?		     ";1020 INPUT G1030 G=G/G61040 RETURN 1050 PRINT "Plane (11, 12, 21, 22)?	     ";1060 INPUT V$1070 IF V$<>"11" AND V$<>"12" AND V$<>"21" AND V$<>"22" THEN 10501080 E$=V$1090 E=2*POS("  11 12 21 22",V$,1)/3-11100 RETURN 1110 PRINT "Load or Source Mapping (L or S)?	     ";1120 INPUT V$1130 H3(7)=POS(" L S",V$,1)/21140 IF H3(7)<1 THEN 11101150 PRINT "S or 1/S Plane (S or 1/S)?	     ";1160 INPUT V$1170 H4(4)=POS("   S   1/S",V$,1)/41180 IF H4(4)<1 OR INT(H4(4))<H4(4) THEN 11501190 RETURN 1200 G3=01210 G4=01220 H4(3)=11230 GOSUB 52401240 H4(5)=G31250 H4(6)=G41260 H4(7)=H4(3)1270 RETURN 1280 E3=INT(LGT(2*(E8+(E8=0)))+1.0E-10)1290 E2=2*E8/10^E31300 IF E2>2 THEN 13301310 E6=10^(E3-1)1320 GO TO 13701330 IF E2>5 THEN 13601340 E6=10^E3/51350 GO TO 13701360 E6=10^E3/21370 E4=INT(-E8/E6+1.0E-10)*E61380 RETURN 1390 H2(7)=11400 H2(8)=01410 E4=-11420 E5=11430 E6=0.11440 PAGE 1450 WINDOW E4,E5,E4,E51460 AXIS @V5:0,0,E4,E41470 AXIS @V5:0,0,E5,E51480 AXIS @V5:0,0,2,01490 E2=3601500 G3=01510 G4=01520 GOSUB 18201530 G3=1/31540 GOSUB 18201550 G3=0.51560 GOSUB 18201570 G3=2/31580 GOSUB 18201590 G3=11600 G4=21610 E2=-2*ATN(0.5)1620 GOSUB 18201630 G4=-21640 E2=-E21650 GOSUB 18201660 G4=11670 E2=-901680 GOSUB 18201690 G4=-11700 E2=901710 GOSUB 18201720 G4=0.51730 E2=-2*ATN(2)1740 GOSUB 18201750 G4=-0.51760 E2=-E21770 GOSUB 18201780 HOME @V5:1790 PRINT @V5: USING "16/,15X,A,17/,26X,16A,15A,A":"0",".5","1","2"1800 GOSUB 23901810 RETURN 1820 MOVE @V5:H2(7),H2(8)1830 H2(1)=H2(7)-G31840 H2(2)=H2(8)-G41850 H2(3)=COS(E2/36)1860 H2(4)=SIN(E2/36)1870 FOR E3=1 TO 361880 H2(5)=H2(1)*H2(3)-H2(2)*H2(4)1890 H2(2)=H2(2)*H2(3)+H2(1)*H2(4)1900 H2(1)=H2(5)1910 DRAW @V5:H2(1)+G3,H2(2)+G41920 NEXT E31930 RETURN 1940 E8=H1(8)1950 GOSUB 12801960 PAGE 1970 E5=-E41980 WINDOW E4,E5,E4,E51990 AXIS @V5:0,0,E4,E42000 AXIS @V5:0,0,E5,E52010 G4=E5/1002020 FOR E0=30 TO 360 STEP 302030 ROTATE E02040 MOVE @V5:0,02050 FOR E2=E6 TO E5*1.3 STEP E62060 RDRAW @V5:E6,02070 RDRAW @V5:0,G42080 RDRAW @V5:0,-G4*22090 RMOVE @V5:0,G42100 NEXT E22110 NEXT E02120 HOME @V5:2130 IF E5>999999.9995 OR E6<1.0E-3 THEN 21702140 PRINT @V5: USING "33/,17D.3D,17D.3D,8A,17D.3D":E4,E6," PER DIV",E52150 GOSUB 23902160 RETURN 2170 PRINT @V5: USING "33/,10X,6E,9X,E,8A,8X,6E":E4,E6," PER DIV",E52180 GOSUB 23902190 RETURN 2200 FOR E0=1 TO 62210 H2(E0)=INT(H3(E0)*1000000+0.5)/10000002220 NEXT E02230 V$="
"2240 GOSUB 25902250 PRINT V$;" = a + bS / (1 - cS)"2260 E$=SEG("+-",(H3(2)<0)+1,1)2270 H$=SEG("+-",(H3(4)<0)+1,1)2280 PRINT "
a = ";H2(1);" ";E$;"j";ABS(H2(2));"b = ";H2(3);" ";H$;2290 E$=SEG("+-",(H3(6)<0)+1,1)2300 PRINT "j";ABS(H2(4));"c = ";H2(5);" ";E$;"j";ABS(H2(6))2310 E2=H3(5)^2+H3(6)^22320 IF E2=0 THEN 23802330 E3=H3(3)2340 H3(3)=(E3*H3(5)+H3(4)*H3(6))/E22350 H3(4)=(H3(4)*H3(5)-E3*H3(6))/E22360 H3(1)=H3(1)-H3(3)2370 H3(2)=H3(2)-H3(4)2380 RETURN 2390 V$=SEG("  LOAD ON SOURCE ON       ",10*ABS(H3(7))-9,10)2400 IF ABS(H3(7))<>2 THEN 24202410 V$=" "&V$2420 GOSUB 25902430 V$=V$&" PLANE"2440 IF H4(4)=2 THEN 24602450 V$=" "&V$2460 PRINT @V5: USING "32X,30A":V$2470 V$=SEG("M-OHMSK-OHMSOHMS",13-2*LGT(G5),6)2480 E$=SEG(" NH UH MH H",LGT(G8)+1,3)2490 V$=V$&E$2500 E$=SEG(" PF NF UF    F",LGT(G7)+1,3)2510 V$=V$&E$2520 V$=V$&""2530 HOME 2540 PRINT USING "34/,15A":V$2550 G1=E5*0.0122560 G2=E5*0.0192570 H1(7)=E52580 RETURN 2590 IF H4(4)=1 THEN 26102600 V$=V$&"1/"2610 V$=V$&"S"2620 IF ABS(H3(7))=3 THEN 26502630 E$=SEG("1122",2*ABS(H3(7))-1,2)2640 GO TO 26602650 E$=SEG("11122122",E,2)2660 V$=V$&E$2670 RETURN 2680 IF ABS(H2(7)) MAX ABS(H2(8))>H1(7) THEN 27102690 MOVE @V5:H2(7)-G1,H2(8)-G22700 PRINT @V5:"o";2710 RETURN 2720 IF V3=13 THEN 27602730 V3=132740 FIND V32750 READ @33:H92760 RETURN 2770 V3=V3+12780 GO TO 27402790 PRINT "NO DATA"2800 END 2810 FOR E0=1 TO 7 STEP 22820 E2=H0(E0)2830 H0(E0)=E2*COS(H0(E0+1))2840 H0(E0+1)=E2*SIN(H0(E0+1))2850 NEXT E02860 RETURN 2870 E0=22880 IF G<=H9(E0) THEN 29302890 E0=E0+9+18*(ABS(H3(7))=3)2900 IF E0<=9*ABS(H9(1))-7 THEN 28802910 IF H9(1)=-30 THEN 30902920 E0=E0-9-18*(ABS(H3(7))=3)2930 IF G=H9(E0) THEN 29502940 PRINT "Frequency used =		     ";H9(E0)*G62950 IF ABS(H3(7))=3 THEN 30202960 FOR E2=1 TO 82970 H0(E2)=H9(E0+E2)2980 NEXT E22990 GOSUB 31103000 GOSUB 58203010 RETURN 3020 FOR E2=1 TO 5 STEP 23030 H0(E2)=H9(E0+E+9*(E2-1)/2)3040 H0(E2+1)=H9(E0+E+1+9*(E2-1)/2)3050 NEXT E23060 GOSUB 31103070 GOSUB 59003080 RETURN 3090 GOSUB 27703100 GO TO 28703110 H1=H03120 IF H4(4)=1 THEN 31903130 FOR E0=1 TO 7 STEP 23140 E2=H1(E0)^2+H1(E0+1)^23150 IF E2=0 THEN 32003160 H1(E0)=H1(E0)/E23170 H1(E0+1)=-H1(E0+1)/E23180 NEXT E03190 RETURN 3200 H1(E0)=1.0E+1003210 GO TO 31803220 G3=H4(5)3230 G4=H4(6)3240 E2=13250 E3=03260 GOSUB 54903270 E2=3603280 GOSUB 18203290 G3=13300 G4=1000003310 H4(3)=1000003320 GOSUB 52403330 GOSUB 54303340 GOSUB 18203350 PRINT "RS LS CS XSRP LP CP XP"3360 PRINT "RLS RCS RLP RCPZS ZP GAM or NEW"3370 E9=43380 PRINT "Select: ";3390 INPUT V$3400 E9=E9+1-30*(E9>32)3410 GOSUB 35103420 E$=SEG(V$,1,3)3430 GO TO LEN(E$) OF 3490,3470,34403440 E1=POS("   RLS RLP RCS RCP GAM NEW",E$,1)/43450 GO TO E1 OF 4770,4900,4920,5070,3870,37703460 E$=SEG(V$,1,2)3470 E1=POS("  RS RP LS LP CS CP XS XP ZS ZP",E$,1)/33480 GO TO E1 OF 3990,4120,4220,4310,4360,4450,4550,4640,5090,52203490 GOSUB 35903500 GO TO 33803510 E$=SEG(V$,1,1)3520 IF E$<>" " THEN 35503530 V$=SEG(V$,2,LEN(V$)-1)3540 GO TO 35103550 RETURN 3560 GOSUB 52403570 GOSUB 54303580 GOSUB 18203590 V$=SEG("































",1,E9)3600 PRINT V$3610 RETURN 3620 E9=E9+1-30*(E9>32)3630 INPUT V$3640 GOSUB 35103650 E8=13660 IF V$=>":" OR V$<"+" OR (V$<"0" AND V$=>"/") THEN 37003670 IF V$<"-" AND V$=>"," THEN 37003680 V=VAL(V$)3690 E8=03700 RETURN 3710 E2=13720 GO TO 37403730 E2=-13740 E3=03750 GOSUB 54903760 RETURN 3770 IF H3(7)>0 THEN 6303780 IF H3(7)=-3 THEN 38203790 GOSUB 11103800 H3(7)=-H3(7)3810 GO TO 5103820 E0=E3830 GOSUB 10503840 GOSUB 11503850 IF E0<>E THEN 5703860 GO TO 6003870 PRINT "GAM-M? ";3880 GOSUB 36203890 GO TO E8 OF 34203900 GOSUB 35903910 E2=V3920 PRINT "GAM-A? ";3930 GOSUB 36203940 GO TO E8 OF 34203950 E3=E2*SIN(V)3960 E2=E2*COS(V)3970 GOSUB 56303980 GO TO 38703990 E1=14000 GOSUB 37104010 PRINT "RS? ";4020 GOSUB 36204030 GO TO E8 OF 34204040 G4=04050 E0=V*G5/G0+14060 E0=E0*(ABS(E0)=>1.0E-5)+1.0E-5*(ABS(E0)<1.0E-5)4070 GOSUB E1 OF 4160,41904080 GOSUB 52404090 E2=3604100 GOSUB 35804110 GO TO E1 OF 4010,41404120 E1=24130 GOSUB 37304140 PRINT "RP? ";4150 GO TO 40204160 G3=1-1/E04170 H4(3)=1/E04180 RETURN 4190 G3=-1/E04200 H4(3)=ABS(1-1/E0)4210 RETURN 4220 E1=14230 GOSUB 37104240 PRINT "LS? ";4250 GOSUB 36204260 GO TO E8 OF 34204270 E0=2*PI*V*G/G6*G8/G04280 GOSUB E1 OF 4680,47304290 GOSUB 35604300 GO TO E1 OF 4240,43304310 E1=24320 GOSUB 37304330 PRINT "LP? ";4340 GO TO 42504350 RETURN 4360 E1=14370 GOSUB 37104380 PRINT "CS? ";4390 GOSUB 36204400 GO TO E8 OF 34204410 E0=-V*G/G6*G7*PI/500*G04420 GOSUB E1 OF 4490,45204430 GOSUB 35604440 GO TO E1 OF 4380,44704450 E1=24460 GOSUB 37304470 PRINT "CP? ";4480 GO TO 43904490 G3=14500 GOSUB 47404510 RETURN 4520 G3=-14530 GOSUB 46904540 RETURN 4550 E1=14560 GOSUB 37104570 PRINT "XS? ";4580 GOSUB 36204590 GO TO E8 OF 34204600 E0=V*G5/G04610 GOSUB E1 OF 4680,47304620 GOSUB 35604630 GO TO E1 OF 4570,46604640 E1=24650 GOSUB 37304660 PRINT "XP? ";4670 GO TO 45804680 G3=14690 E0=E0*(ABS(E0)=>1.0E-5)+1.0E-5*(ABS(E0)<1.0E-5)4700 G4=1/E04710 H4(3)=ABS(1/E0)4720 RETURN 4730 G3=-14740 G4=E04750 H4(3)=ABS(E0)4760 RETURN 4770 E1=14780 PRINT "R? ";4790 GOSUB 36204800 GO TO E8 OF 34204810 GOSUB 35904820 E2=V*G5/G04830 PRINT "L? ";4840 GOSUB 36204850 GO TO E8 OF 34204860 V=2*G/G6*PI*V/G8/G04870 GOSUB E1 OF 5670,57504880 GOSUB 56304890 GO TO 47804900 E1=24910 GO TO 47804920 E1=14930 PRINT "R? ";4940 GOSUB 36204950 GO TO E8 OF 34204960 GOSUB 35904970 E2=V*G5/G04980 PRINT "C? ";4990 GOSUB 36205000 GO TO E8 OF 34205010 V=G/G6*PI*V*G7*G0/5005020 V=V+1.0E-100*(V=0)5030 V=-1/V5040 GOSUB E1 OF 5670,57505050 GOSUB 56305060 GO TO 49305070 E1=25080 GO TO 49305090 E1=15100 PRINT "R? ";5110 GOSUB 36205120 GO TO E8 OF 34205130 GOSUB 35905140 E2=V/G05150 PRINT "X? ";5160 GOSUB 36205170 GO TO E8 OF 34205180 V=V/G05190 GOSUB E1 OF 5670,57505200 GOSUB 56305210 GO TO 51005220 E1=25230 GO TO 51005240 E0=H3(5)^2+H3(6)^25250 IF E0=0 THEN 53805260 E4=SQR(E0)*H4(3)5270 E2=1-G3*H3(5)+G4*H3(6)5280 E3=-G3*H3(6)-G4*H3(5)5290 E0=E2^2+E3^2-E4^25300 E0=E0*(ABS(E0)=>1.0E-5)+1.0E-5*(ABS(E0)<1.0E-5)5310 E5=E2/E05320 E6=-E3/E05330 E7=E4/ABS(E0)5340 G3=H3(1)+H3(3)*E5-H3(4)*E65350 G4=H3(2)+H3(3)*E6+H3(4)*E55360 H4(3)=E7*SQR(H3(3)^2+H3(4)^2)5370 RETURN 5380 H4(3)=H4(3)*SQR(H3(3)^2+H3(4)^2)5390 E0=G35400 G3=H3(1)+H3(3)*E0-H3(4)*G45410 G4=H3(2)+H3(3)*G4+H3(4)*E05420 RETURN 5430 E0=H2(7)*(H4(6)-G4)+H4(5)*(G4-H2(8))+G3*(H2(8)-H4(6))=>05440 E2=05450 IF H4(3)=0 THEN 54805460 E2=2*ATN(SQR((H4(5)-H2(7))^2+(H4(6)-H2(8))^2)/H4(3))*(2*E0-1)5470 E2=E2+360*(H3(8)<2)*(2*(E2<0)-1)5480 RETURN 5490 E0=H3(5)^2+H3(6)^25500 IF E0=0 THEN 56005510 E4=1-E2*H3(5)+E3*H3(6)5520 E5=-E2*H3(6)-E3*H3(5)5530 E0=E4^2+E5^25540 IF E0>0 THEN 55705550 E0=1.0E-1005560 E4=15570 H2(7)=H3(1)+(H3(3)*E4+H3(4)*E5)/E05580 H2(8)=H3(2)+(H3(4)*E4-H3(3)*E5)/E05590 RETURN 5600 H2(7)=H3(1)+H3(4)*E2-H3(5)*E35610 H2(8)=H3(2)+H3(4)*E3+H3(5)*E25620 RETURN 5630 GOSUB 54905640 GOSUB 26805650 GOSUB 35905660 RETURN 5670 E0=(E2+1)^2+V^25680 IF E0=0 THEN 57205690 E3=2*V/E05700 E2=(E2^2-1+V^2)/E05710 RETURN 5720 E2=-1.0E+1005730 E3=05740 RETURN 5750 E0=E2^2+V^25760 IF E0=0 THEN 58005770 E3=-E2^2*V/E05780 E2=E2*V^2/E05790 V=E35800 GOSUB 56705810 RETURN 5820 H3(3)=H1(3)*H1(5)-H1(4)*H1(6)5830 H3(4)=H1(3)*H1(6)+H1(4)*H1(5)5840 E0=6*(ABS(H3(7))=2)5850 H3(1)=H1(1+E0)5860 H3(2)=H1(2+E0)5870 H3(5)=H1(7-E0)5880 H3(6)=H1(8-E0)5890 RETURN 5900 H3(1)=H1(1)5910 H3(2)=H1(2)5920 E2=H1(4)+H1(6)-2*H1(2)5930 E3=-H1(3)-H1(5)+2*H1(1)5940 E4=H1(3)-H1(5)5950 E5=H1(4)-H1(6)5960 E6=E4^2+E5^25970 IF E6>0 THEN 60105980 E4=1.0E+1005990 E5=1.0E+1006000 E6=26010 H3(5)=(E2*E4+E3*E5)/E66020 H3(6)=(E3*E4-E2*E5)/E66030 E2=H1(1)-H1(3)6040 E3=H1(2)-H1(4)6050 H3(3)=E2*H3(5)-E3*(H3(6)+1)6060 H3(4)=E2*(H3(6)+1)+E3*H3(5)6070 RETURN 