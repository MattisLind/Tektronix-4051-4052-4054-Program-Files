100 IF INT(V1/50)<>8 THEN 97110 PRINT "PLOT OUTPUTS"120 PRINT @32,26:0130 V3=0140 GOSUB 3770150 IF H9(1)=0 THEN 3840160 H4=1170 ROTATE 0180 PRINT "Plot:"190 PRINT "  Gains	(MAX, MSG, MAS, or UNI)"200 PRINT "  Factors		(K or U)"210 PRINT "  S21 Angle or Delay      (ANG or DLY)"220 PRINT "  VSWRs	        (VS1 or VS2)"230 PRINT "  Mismatch Losses         (ML1 or ML2)"240 PRINT "  Source or Load Gammas   (GMS or GML)"250 PRINT "  Stability Circles       (SC1 or SC2)?  ";260 INPUT V$270 V$=V$&"  "280 V$=SEG(V$,1,3)290 E=POS("   K   MAX MSG MAS UNI U   ANG DLY VS1 VS2 ML1 ML2",V$,1)/4300 IF E=0 OR INT(E)<E THEN 320310 GO TO 410320 E=POS("   GMS GML SC1 SC2",V$,1)/4330 IF E=0 OR INT(E)<E THEN 180340 PRINT "
Polar or Smith (P or S)?	     ";350 INPUT V$360 IF V$<>"P" AND V$<>"S" THEN 340370 V=V$="S"380 G1=4+(E>2)390 E=3+2*(INT(E/2)=E/2)400 GO TO 630410 G1=1+(E=7 OR E=8)+2*(E>8)420 E=E-8*(E>8)430 PRINT "
Frequency Axis (LIN or LOG)?	     ";440 INPUT V$450 H4(7)=POS("   LIN LOG",V$,1)/4460 IF H4(7)<1 OR INT(H4(7))<H4(7) THEN 430470 PRINT "
Autoscaling (Y or N)?	     ";480 INPUT V$490 IF V$="Y" THEN 560500 IF V$<>"N" THEN 470510 GOSUB 860520 PRINT "Vertical Range Minimum and Maximum?      ";530 INPUT H4(3),H4(4)540 IF H4(4)<H4(3) THEN 520550 GO TO 600560 GOSUB 950570 IF H4(4)=>H4(3) THEN 600580 PRINT "NO RESULTS ARE POSSIBLE FOR THE GIVEN DATA"590 END 600 PAGE 610 GOSUB 1560620 GO TO 3310630 PRINT "
Autoscaling (Y or N)?	     ";640 INPUT V$650 IF V$="Y" THEN 740660 IF V$<>"N" THEN 630670 GOSUB 860680 IF V=1 THEN 830690 PRINT "Maximum Radius Component?	     ";700 INPUT H4(3)710 H4(3)=ABS(H4(3))720 IF H4(3)=0 THEN 690730 GO TO 810740 H4(1)=-8.9E+307750 H4(2)=8.9E+307760 G6=1770 IF V=1 THEN 830780 GOSUB 950790 H4(3)=ABS(H4(3)) MAX ABS(H4(4)) MAX ABS(H4(5)) MAX ABS(H4(6))800 H4(3)=H4(3)+(H4(3)=0)810 GOSUB 2960820 GO TO G1-3 OF 3500,3630830 H4(3)=1840 GOSUB 2420850 GO TO G1-3 OF 3500,3630860 PRINT "Frequency Units (GHZ, MHZ, KHZ, or HZ)?  ";870 INPUT V$880 G6=POS("   HZ  KHZ MHZ GHZ",V$,1)/4890 IF G6<1 OR INT(G6)<G6 THEN 860900 G6=1.0E+9*1000^(1-G6)910 PRINT "Frequency Range Minimum and Maximum?     ";920 INPUT H4(1),H4(2)930 IF H4(2)<H4(1) THEN 910940 RETURN 950 FOR E6=1 TO 5 STEP 2960 H4(E6)=4.4E+307970 H4(E6+1)=-4.4E+307980 NEXT E6990 G6=11000 FOR E6=1 TO ABS(H9(1))1010 GOSUB G1 OF 4530,4190,4430,4860,49101020 IF G1=1 AND E=2 AND H2(1)<=1 THEN 11601030 H4(1)=H4(1) MIN G1040 H4(2)=H4(2) MAX G1050 IF G1=5 THEN 11201060 H4(3)=H4(3) MIN H2(E)1070 H4(4)=H4(4) MAX H2(E)1080 IF G1<4 THEN 11601090 H4(5)=H4(5) MIN H2(E+1)1100 H4(6)=H4(6) MAX H2(E+1)1110 GO TO 11601120 H4(3)=H4(3) MIN H2(E)-H2(1+G2)1130 H4(4)=H4(4) MAX H2(E)+H2(1+G2)1140 H4(5)=H4(5) MIN H2(E+1)-H2(1+G2)1150 H4(6)=H4(6) MAX H2(E+1)+H2(1+G2)1160 NEXT E61170 IF H9(1)=>0 THEN 12001180 GOSUB 38201190 GO TO 10001200 G6=1.0E+91210 IF H4(1)=0 AND H4(2)=0 THEN 13001220 G6=LGT(ABS(H4(1))+(H4(1)=0)*1.0E-9)1230 G6=INT(-(LGT(ABS(H4(2))+(H4(2)=0)*1.0E-9) MAX G6)/3+1.0E-10)+11240 G6=10^(3*(G6 MIN 3 MAX 0))1250 H4(1)=H4(1)*G61260 H4(2)=H4(2)*G61270 IF E<8 THEN 13001280 H4(3)=H4(3)/G61290 H4(4)=H4(4)/G61300 RETURN 1310 IF E7<E8 THEN 13401320 E7=E7-ABS(E7)/10-(E7=0)1330 E8=E8+ABS(E8)/10+(E8=0)1340 E3=INT(LGT(E8-E7)+1.0E-10)1350 E2=(E8-E7)/10^E31360 IF E2>2 THEN 13901370 E6=10^(E3-1)1380 GO TO 14301390 IF E2>5 THEN 14201400 E6=10^E3/51410 GO TO 14301420 E6=10^E3/21430 E4=INT(E7/E6+1.0E-10)*E61440 E5=-INT(-E8/E6+1.0E-10)*E61450 RETURN 1460 E7=E7 MAX 1.0E-1001470 E8=E8 MAX 1.0E-1001480 IF E7<E8 OR INT(LGT(E7)+1.0E-10)<LGT(E7) THEN 15101490 E7=E7/101500 E8=10*E81510 E4=10^INT(LGT(E7)+1.0E-10)1520 E5=LGT(E8)1530 E5=10^(INT(E5+1.0E-10)+(INT(E5+1.0E-10)<E5))1540 E6=LGT(E5/E4)1550 RETURN 1560 FOR E9=0 TO 11570 E7=H4(1+2*E9)1580 E8=H4(2+2*E9)1590 GOSUB H4(7+E9) OF 1310,14601600 H1(7+E9)=E61610 H1(1+2*E9)=E41620 H1(2+2*E9)=E51630 NEXT E91640 GOSUB H4(7) OF 2050,20901650 GOSUB 23801660 E$=""1670 IF E<8 THEN 16901680 E$=SEG("(NS) (US) (MS) (SEC)",5*LGT(G6)/3+1,5)1690 GO TO G1+(E=5)+(E=6) OF 1700,1750,18001700 IF E>2 THEN 17301710 V$=SEG("MAX AVAILABLE  GAIN (DB)    K",55-27*E,27)1720 GO TO 18401730 V$=SEG("MAX STABLE GAIN (DB) MASON'S GAIN (DB)",21*E-62,21)1740 GO TO 18401750 IF E>6 THEN 17801760 V$=SEG("UNILATERAL GAIN (DB)     U",22*E-109,21)1770 GO TO 18401780 V$=SEG("S21 ANGLE (DEG)S21 DELAY",16*E-111,16)1790 GO TO 18401800 IF E>2 THEN 18301810 V$=SEG(" VSWR 11 VSWR 22",8*E-7,8)1820 GO TO 18401830 V$=SEG(" MISMATCH LOSS 11 (DB) MISMATCH LOSS 22 (DB)",23*E-68,23)1840 HOME @V5:1850 PRINT @V5:"






 ";V$;" ";E$1860 HOME @V5:1870 IF ABS(H1(3)) MAX ABS(H1(4))>999999.9995 THEN 19201880 IF H1(8)<1.0E-3 THEN 19201890 PRINT @V5: USING "12D.3D,15/,12D.3D,/,9X,7A":H1(4),H1(8),"PER DIV"1900 PRINT @V5: USING "15/,12D.3D":H1(3)1910 GO TO 19401920 PRINT @V5: USING "2X,6E,15/,7X,E,/,9X,7A":H1(4),H1(8),"PER DIV"1930 PRINT @V5: USING "15/,2X,6E":H1(3)1940 V$=SEG("      PER DIVDECADES",H4(7)*7,7)1950 IF ABS(H1(1)) MAX ABS(H1(2))>999999.9995 THEN 19901960 IF H1(7)<1.0E-3 OR (H1(1)<1.0E-3 AND H4(7)=2) THEN 19901970 PRINT @V5: USING "17D.3D,16D.3D,X,7A,18D.3D":H1(1),H1(7),V$,H1(2)1980 GO TO 20001990 PRINT @V5: USING "10X,6E,9X,E,X,7A,8X,6E":H1(1),H1(7),V$,H1(2)2000 E$=SEG("(GHZ)(MHZ)(KHZ)(HZ)",LGT(G6)*5/3+1,5)2010 PRINT @V5: USING "35X,10A,5A,S":"FREQUENCY",E$2020 HOME @V5:2030 WINDOW H1(1),H1(2),H1(3),H1(4)2040 RETURN 2050 WINDOW 0,1,0,12060 AXIS @V5:H1(7)/(H1(2)-H1(1)),0,-1,02070 AXIS @V5:H1(7)/(H1(2)-H1(1)),0,2,12080 RETURN 2090 IF H1(7)>6 THEN 22802100 WINDOW 0,H1(7),0,1002110 E0=12120 GOSUB 21702130 WINDOW 0,H1(7),-100,02140 E0=-12150 GOSUB 21702160 RETURN 2170 FOR E2=0 TO H1(7)-12180 MOVE @V5:E2,02190 FOR E3=2 TO 102200 RDRAW @V5:LGT(E3/(E3-1)),02210 RDRAW @V5:0,E02220 RMOVE @V5:0,-E02230 NEXT E32240 RDRAW @V5:0,2*E02250 RMOVE @V5:0,-2*E02260 NEXT E22270 RETURN 2280 E7=LGT(H1(1))2290 E8=LGT(H1(2))2300 GOSUB 13102310 H1(1)=10^E42320 H1(2)=10^E52330 H1(7)=E5-E42340 WINDOW 0,1,0,12350 AXIS @V5:E6/(E4-E5),0,-1,02360 AXIS @V5:E6/(E4-E5),0,2,12370 RETURN 2380 WINDOW 0,1,0,12390 AXIS @V5:0,H1(8)/(H1(4)-H1(3)),0,-12400 AXIS @V5:0,H1(8)/(H1(4)-H1(3)),1,22410 RETURN 2420 H2(7)=12430 H2(8)=02440 E4=-12450 E5=12460 E6=0.12470 PAGE 2480 WINDOW E4,E5,E4,E52490 AXIS @V5:0,0,E4,E42500 AXIS @V5:0,0,E5,E52510 AXIS @V5:0,0,2,02520 E2=3602530 G3=02540 G4=02550 GOSUB 28402560 G3=1/32570 GOSUB 28402580 G3=0.52590 GOSUB 28402600 G3=2/32610 GOSUB 28402620 G3=12630 G4=22640 E2=-2*ATN(0.5)2650 GOSUB 28402660 G4=-22670 E2=-E22680 GOSUB 28402690 G4=12700 E2=-902710 GOSUB 28402720 G4=-12730 E2=902740 GOSUB 28402750 G4=0.52760 E2=-2*ATN(2)2770 GOSUB 28402780 G4=-0.52790 E2=-E22800 GOSUB 28402810 GOSUB 32302820 PRINT @V5: USING "16/,15X,A,17/,26X,16A,15A,A":"0",".5","1","2"2830 RETURN 2840 MOVE @V5:H2(7),H2(8)2850 H2(1)=H2(7)-G32860 H2(2)=H2(8)-G42870 H2(3)=COS(E2/36)2880 H2(4)=SIN(E2/36)2890 FOR E3=1 TO 362900 H2(5)=H2(1)*H2(3)-H2(2)*H2(4)2910 H2(2)=H2(2)*H2(3)+H2(1)*H2(4)2920 H2(1)=H2(5)2930 DRAW @V5:H2(1)+G3,H2(2)+G42940 NEXT E32950 RETURN 2960 E8=H4(3)2970 E7=-H4(3)2980 GOSUB 13102990 PAGE 3000 E4=-E53010 WINDOW E4,E5,E4,E53020 AXIS @V5:0,0,E4,E43030 AXIS @V5:0,0,E5,E53040 G4=E5/1003050 FOR E0=30 TO 360 STEP 303060 ROTATE E03070 MOVE @V5:0,03080 FOR E2=E6 TO E5*1.3 STEP E63090 RDRAW @V5:E6,03100 RDRAW @V5:0,G43110 RDRAW @V5:0,-G4*23120 RMOVE @V5:0,G43130 NEXT E23140 NEXT E03150 GOSUB 32303160 IF E5>999999.9995 OR E6<1.0E-3 THEN 32003170 PRINT @V5: USING "12D.3D,32/,12D.3D":E5,E43180 PRINT @V5: USING "17D.3D,17D.3D,8A,17D.3D":E4,E6," PER DIV",E53190 RETURN 3200 PRINT @V5: USING "2X,6E,32/,2X,6E":E5,E43210 PRINT @V5: USING "10X,6E,9X,E,8A,8X,6E":E4,E6," PER DIV",E53220 RETURN 3230 IF G1=5 THEN 32603240 V$=SEG("  GAMMA MS  GAMMA ML",5*E-14,10)3250 GO TO 32703260 V$=SEG(" STABILITY CIRCLES 11 STABILITY CIRCLES 22",11*E-32,22)3270 HOME @V5:3280 PRINT @V5:"






",V$3290 HOME @V5:3300 RETURN 3310 G3=(H1(2)-H1(1))*0.0063320 G4=(H1(4)-H1(3))*0.00953330 GOSUB 37703340 FOR E6=1 TO ABS(H9(1))3350 GOSUB G1 OF 4530,4190,44303360 IF G<H4(1) OR G>H4(2) OR H2(E)<H4(3) OR H2(E)>H4(4) THEN 34603370 IF G1=1 AND E=2 AND H2(1)<=1 THEN 34603380 E2=G3390 IF H4(7)=1 THEN 34203400 E2=LGT(G*(G>0)+1.0E-100*(G<=0))3410 E2=(E2-LGT(H1(1)))/(LGT(H1(2))-LGT(H1(1)))*(H1(2)-H1(1))+H1(1)3420 E3=H2(E)3430 IF H4(8)=1 THEN 34403440 MOVE @V5:E2-G3,E3-G43450 PRINT @V5:"x";3460 NEXT E63470 IF H9(1)=>0 THEN 38603480 GOSUB 38203490 GO TO 33403500 G3=E5*0.0123510 G4=E5*0.0193520 GOSUB 37703530 FOR E6=1 TO ABS(H9(1))3540 GOSUB 48603550 IF ABS(H2(E))>H4(3) OR ABS(H2(E+1))>H4(3) THEN 35903560 IF G<H4(1) OR G>H4(2) THEN 35903570 MOVE @V5:H2(E)-G3,H2(E+1)-G43580 PRINT @V5:"x";3590 NEXT E63600 IF H9(1)=>0 THEN 38603610 GOSUB 38203620 GO TO 35303630 GOSUB 37703640 FOR E6=1 TO ABS(H9(1))3650 GOSUB 49103660 IF G<H4(1) OR G>H4(2) THEN 37303670 G3=H2(E)3680 G4=H2(E+1)3690 H2(7)=G3+H2(1+G2)3700 H2(8)=G43710 E2=3603720 GOSUB 28403730 NEXT E63740 IF H9(1)=>0 THEN 38603750 GOSUB 38203760 GO TO 36403770 IF V3=13 THEN 38103780 V3=133790 FIND V33800 READ @33:H93810 RETURN 3820 V3=V3+13830 GO TO 37903840 PRINT "NO DATA"3850 END 3860 PRINT "











Press RETURNto continue";3870 INPUT V$3880 PRINT "

"3890 GO TO 1403900 E0=H0(1)*H0(7)-H0(2)*H0(8)-H0(3)*H0(5)+H0(4)*H0(6)3910 E7=H0(1)*H0(8)+H0(2)*H0(7)-H0(3)*H0(6)-H0(4)*H0(5)3920 E2=H0(1)^2+H0(2)^23930 E3=H0(3)^2+H0(4)^23940 E4=H0(5)^2+H0(6)^23950 E5=H0(7)^2+H0(8)^23960 H2(7)=1+E2-E5-E0^2-E7^23970 H2(8)=1-E2+E5-E0^2-E7^23980 IF E3*E4>0 THEN 40803990 H2(1)=1.0E+1004000 IF E3>0 THEN 40304010 H2(2)=10004020 RETURN 4030 H2(2)=04040 IF H2(7)<0 THEN 40604050 H2(2)=(1+E0^2+E7^2-E2-E5)/E3^24060 H2(2)=10*LGT(H2(2)*(H2(2)>0)+1.0E-100*(H2(2)<=0))4070 RETURN 4080 H2(1)=(1+E0^2+E7^2-E2-E5)/2/SQR(E3*E4)4090 IF H2(1)<1 THEN 40704100 H2(2)=SQR(E4/E3)*(H2(1)-((H2(7)=>0)*2-1)*SQR(ABS(H2(1)^2-1)))4110 GO TO 40604120 E5=9*E6-74130 G=H9(E5)*G64140 FOR E0=1 TO 84150 E5=E5+14160 H0(E0)=H9(E5)4170 NEXT E04180 RETURN 4190 IF V3>13 OR E6>1 THEN 42504200 IF H9(1)=1 AND E=8 THEN 5804210 H0=04220 H0(5)=14230 H3=04240 E7=04250 H2=H04260 GOSUB 41204270 E2=H0(5)^2+H0(6)^24280 H0(5)=H0(5)*(E2>0)+(E2=0)4290 E2=H0(5)*H2(5)+H0(6)*H2(6)4300 E3=H2(5)*H0(6)-H2(6)*H0(5)4310 E4=E2^2+E3^24320 H3(4)=ACS(E2*SQR(E4)/E4)*(2*(E3=>0)-1)4330 H3(2)=H3(2)+H3(4)4340 H3(3)=04350 IF E7=G OR (E6=1 AND V3=13) THEN 43704360 H3(3)=H3(4)/(E7-G)/3604370 E7=G4380 H2(E)=H3(E-5)4390 IF E=7 OR E6>1 OR V3>13 THEN 44204400 E6=24410 GO TO 42504420 RETURN 4430 GOSUB 41204440 E0=E/2=INT(E/2)4450 E2=SQR(H0(1+6*E0)^2+H0(2+6*E0)^2)4460 IF E2<>1 THEN 44904470 H2(1+E0)=1.0E+1004480 GO TO 45004490 H2(1+E0)=(1+E2)/(1-E2)4500 E2=1-E2^24510 H2(3+E0)=-10*LGT(E2*(E2>0)+1.0E-100*(E2<=0))4520 RETURN 4530 GOSUB 41204540 GOSUB 39004550 H2(3)=(E4*(E4>0)+1.0E-200*(E4=0))/(E3*(E3>0)+1.0E-200*(E3=0))4560 H2(3)=5*LGT(H2(3))4570 H2(4)=1+E0^2+E7^2-E2-E5-2*(H0(3)*H0(5)+H0(4)*H0(6))4580 IF H2(4)<>0 THEN 46104590 H2(4)=10004600 GO TO 46304610 H2(4)=((H0(3)-H0(5))^2+(H0(4)-H0(6))^2)/H2(4)4620 H2(4)=10*LGT(H2(4)*(H2(4)>0)+1.0E-100*(H2(4)<=0))4630 H2(5)=(1-E2)*(1-E5)4640 H2(5)=ABS(H2(5)*(H2(5)<>0)+1.0E-100*(H2(5)=0))4650 H2(6)=SQR(E2*E3*E4*E5)/H2(5)4660 H2(5)=10*LGT((E4*(E4>0)+1.0E-100*(E4=0))/H2(5))4670 RETURN 4680 G2=E>44690 H3(E-2)=H0(1+6*G2)-E0*H0(7-6*G2)-E7*H0(8-6*G2)4700 H3(E-1)=-H0(2+6*G2)-E0*H0(8-6*G2)+E7*H0(7-6*G2)4710 H3(5+G2)=H3(E-2)^2+H3(E-1)^24720 RETURN 4730 E2=SQR(ABS(H2(7+G2)^2-4*H3(5+G2)))*((H2(7+G2)=>0)*2-1)4740 IF ABS(H2(1))<=1 THEN 48304750 E2=H2(7+G2)-E24760 IF H3(5+G2)>0 THEN 48004770 H2(E)=1.0E+1004780 H2(E+1)=04790 RETURN 4800 H2(E)=H3(E-2)*E2/H3(5+G2)/24810 H2(E+1)=H3(E-1)*E2/H3(5+G2)/24820 RETURN 4830 H2(E)=(H3(E-2)*H2(7+G2)-H3(E-1)*E2)/2/H3(5+G2)4840 H2(E+1)=(H3(E-1)*H2(7+G2)+H3(E-2)*E2)/2/H3(5+G2)4850 RETURN 4860 GOSUB 41204870 GOSUB 39004880 GOSUB 46804890 GOSUB 47304900 RETURN 4910 GOSUB 41204920 GOSUB 39004930 GOSUB 46804940 H3(7)=E2-E0^2-E7^24950 H3(8)=E5-E0^2-E7^24960 IF H3(7+G2)<>0 THEN 50104970 H2(1+G2)=1.0E+1004980 H2(E)=1.0E+1004990 H2(E+1)=05000 GO TO 50405010 H2(1+G2)=SQR(E3*E4)/ABS(H3(7+G2))5020 H2(E)=H3(E-2)/H3(7+G2)5030 H2(E+1)=H3(E-1)/H3(7+G2)5040 RETURN 