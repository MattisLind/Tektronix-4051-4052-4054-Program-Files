100 ON SIZE THEN 430110 IF J9=45 THEN 360120 J8=0130 K5=32140 IF J9=3 THEN 250150 PRINT "Enter 0 for Screen Display, 1 for Plotter Plot: ";160 INPUT F$170 IF F$<>"0" THEN 200180 K5=32190 GO TO 250200 IF F$<>"1" THEN 230210 K5=K6220 GO TO 250230 PRINT "Invalid Entry --- Try Again: ";240 GO TO 160250 IF J9<3 THEN 280260 J9=1270 J8=1280 GO TO 630290 IF J8=0 THEN 310300 GO TO 6280310 VIEWPORT 0,130,0,100320 WINDOW 0,130,0,100330 MOVE @K5:0,0340 J9=16350 J=16360 F1=3370 GO TO 70380 REM LIST ITEM SUBROUTINE390 REM ------------------------------400 I=0410 IF C<=A(Z1) AND C>0 THEN 440420 I=2430 RETURN 440 IF R<0 THEN 420450 T=A(Z1-C)460 N=A(Z2-C)470 IF N>0 THEN 490480 N=Z2-C490 F=A(T)500 IF F=2 AND R>A(T+3) THEN 420510 IF F=1 AND T+2+R=>N THEN 420520 L=A(T+1)530 H=A(T+2)540 IF F=2 THEN 580550 V2=T+2+R560 V=A(V2)570 RETURN 580 I4=A(T+3)590 I3=(H-L)/(I4-1)600 V=(R-1)*I3+L610 V2=0620 RETURN 630 GO TO J9 OF 640,6050640 PAGE @K5:650 IF Q(1)>100 THEN 680660 GOSUB Q(1) OF 1720,960,730670 GO TO 290680 GOSUB Q(1)-100 OF 1720,960,730690 GO TO 290700 REM ------------------------------710 REM TEXT PRESENTATION SUBROUTINE720 REM ------------------------------730 WINDOW 0,130,0,100740 VIEWPORT 0,130,0,100750 Y=Q(6)-2.82760 IF Y>0 THEN 780770 Y=97.18780 MOVE @K5:Q(3),Y790 I2=1800 D$=SEG(T$,I2,Q(8))810 IF LEN(D$)=0 THEN 880820 PRINT @K5:D$;830 Y=Y-Q(9)*2.82840 IF Y<=0 THEN 890850 MOVE @K5:Q(3),Y860 I2=I2+Q(8)870 GO TO 800880 RETURN 890 MOVE @K5:0,0900 PRINT @K5:910 Y=97.18920 GO TO 850930 REM ------------------------------940 REM TABLE PRESENTATION SUBROUTINE950 REM ------------------------------960 WINDOW 0,130,0,100970 VIEWPORT 0,130,0,100980 FOR I1=1 TO Q(8)990 IF Q(23+I1)<0 OR Q(23+I1)>A(Z1) THEN 68801000 NEXT I11010 Y=Q(6)-2.821020 IF Y>0 THEN 10401030 Y=97.181040 F$=CHR(0)1050 I1=POS(T$,F$,1)1060 D$=SEG(T$,1,I1-1)1070 W$=SEG(T$,I1+1,LEN(T$)-I1)1080 IF LEN(D$)=0 THEN 11401090 I1=(LEN(W$)-LEN(D$))/21100 IF I1<=0 THEN 11401110 FOR I2=1 TO I11120 D$=" "&D$1130 NEXT I21140 MOVE @K5:Q(3),Y1150 IF LEN(D$)=0 THEN 11901160 PRINT @K5:D$;1170 Y=Y-5.641180 MOVE @K5:Q(3),Y1190 IF LEN(W$)=0 THEN 12301200 PRINT @K5:W$;1210 Y=Y-5.641220 MOVE @K5:Q(3),Y1230 R=11240 I2=01250 FOR I1=1 TO Q(8)1260 C=Q(23+I1)1270 GOSUB 4001280 IF I=2 THEN 14301290 V2=Q(I1*2+30)1300 IF Q(I1*2+31)=0 THEN 13201310 V2=V2-Q(I1*2+31)-11320 X$=STR(V2)1330 X$=X$&"D"1340 IF Q(I1*2+31)=0 THEN 14001350 E$=STR(Q(I1*2+31))1360 E$=SEG(E$,2,LEN(E$)-1)1370 X$=X$&"."1380 X$=X$&E$1390 X$=X$&"D"1400 X$=X$&"3XS"1410 PRINT @K5: USING X$:V1420 GO TO 14701430 I2=I2+11440 X$=STR(Q(I1*2+30)+3)1450 X$=X$&"XS"1460 PRINT @K5: USING X$:1470 NEXT I11480 IF I2=Q(8) THEN 16701490 Y=Y-2.821500 IF Y<=0 THEN 15401510 MOVE @K5:Q(3),Y1520 R=R+11530 GO TO 12401540 MOVE @K5:0,01550 PRINT 1560 Y=97.181570 MOVE @K5:Q(3),Y1580 IF LEN(D$)=0 THEN 16201590 PRINT @K5:D$;1600 Y=Y-5.641610 MOVE @K5:Q(3),Y1620 IF LEN(W$)=0 THEN 12401630 PRINT @K5:W$;1640 Y=Y-5.641650 MOVE @K5:Q(3),Y1660 GO TO 12401670 RETURN 1680 REM ------------------------------1690 REM PLOT PRESENTATION SUBROUTINE1700 REM ------------------------------1710 REM CHECK FOR VALID COLUMN #S1720 IF Q(25)>0 AND Q(25)<=A(Z1) THEN 17401730 IF Q(25)<>-1 AND Q(25)<>-2 THEN 68801740 IF Q(24)>0 AND Q(24)<=A(Z1) THEN 17901750 IF Q(24)<>-1 AND Q(24)<>-2 THEN 68801760 IF Q(24)>0 OR Q(25)>0 THEN 17901770 IF Q(20)<0 OR Q(20)>A(Z1) THEN 68801780 REM FIND MAXIMUM # OF TIC MARKS1790 IF Q(13)<>0 OR Q(14)<>0 THEN 18101800 Q(27)=INT((Q(5)-Q(3)-20)/15)1810 IF Q(15)<>0 OR Q(16)<>0 THEN 18401820 Q(34)=INT((Q(6)-Q(4)-12)/8)1830 REM FIND MIN/MAX OF FUNCTIONS1840 IF Q(24)>0 THEN 20101850 IF Q(13)<>0 OR Q(14)<>0 THEN 20101860 I1=5*(Q(25)>0)1870 C=Q(20+I1)1880 FOR R=1 TO 100001890 GOSUB 4001900 IF I=2 THEN 20101910 X=V1920 GOSUB -Q(24) OF 21,411930 IF R>1 THEN 19601940 Q(32)=Y1950 Q(33)=Y1960 IF Y<=Q(33) THEN 19801970 Q(33)=Y1980 IF Y=>Q(32) THEN 20001990 Q(32)=Y2000 NEXT R2010 IF Q(25)>0 THEN 21902020 IF Q(15)<>0 OR Q(16)<>0 THEN 21902030 I1=4*(Q(24)>0)2040 C=Q(20+I1)2050 FOR R=1 TO 100002060 GOSUB 4002070 IF I=2 THEN 21902080 X=V2090 GOSUB -Q(25) OF 21,412100 IF R>1 THEN 21302110 Q(39)=Y2120 Q(40)=Y2130 IF Y<=Q(40) THEN 21502140 Q(40)=Y2150 IF Y=>Q(39) THEN 21702160 Q(39)=Y2170 NEXT R2180 REM SET UP TRANSFORMATIONS2190 DEF FNX(S)=S2200 IF Q(28)=1 THEN 22202210 DEF FNX(S)=LGT(S*SGN(S)+(S=0))*SGN(S)2220 DEF FNY(S)=S2230 IF Q(35)=1 THEN 22602240 DEF FNY(S)=LGT(S*SGN(S)+(S=0))*SGN(S)2250 REM INITIALIZE DESIRED BOUNDS, NEATEN, AND DISPLAY2260 IF Q(24)<0 THEN 23202270 C=Q(24)2280 R=12290 GOSUB 4002300 Q(32)=L2310 Q(33)=H2320 IF Q(25)<0 THEN 23702330 C=Q(25)2340 GOSUB 4002350 Q(39)=L2360 Q(40)=H2370 IF Q(13)=0 AND Q(14)=0 THEN 24002380 Q(32)=Q(13)2390 Q(33)=Q(14)2400 IF Q(15)=0 AND Q(16)=0 THEN 24302410 Q(39)=Q(15)2420 Q(40)=Q(16)2430 GOSUB 32902440 REM SET UP DISPLAY WINDOW AND VIEWPORT2450 VIEWPORT Q(3)+20,Q(5),Q(4)+12,Q(6)2460 WINDOW FNX(Q(32)),FNX(Q(33)),FNY(Q(39)),FNY(Q(40))2470 X1=-130/(Q(5)-Q(3)-20)2480 IF K5=K6 THEN 25002490 X1=0.6*X1*(FNX(Q(33))-FNX(Q(32)))/1302500 Y1=-100/(Q(6)-Q(4)-12)2510 IF K5=K6 THEN 25302520 Y1=1.27*Y1*(FNY(Q(40))-FNY(Q(39)))/1002530 IF J9<3 THEN 25802540 PRINT @K5:"";2550 POINTER X9,Y9,F$2560 IF F$="E" THEN 64102570 GO TO 26002580 IF Q(1)>100 THEN 26002590 GOSUB 43502600 F$=CHR(Q(9))2610 REM GET VALUES AND PLOT2620 FOR R=1 TO 100002630 IF Q(24)<0 THEN 26902640 C=Q(24)2650 GOSUB 4002660 IF I=0 THEN 26802670 RETURN 2680 I1=V2690 IF Q(25)<0 THEN 27502700 C=Q(25)2710 GOSUB 4002720 IF I=0 THEN 27402730 RETURN 2740 I2=V2750 IF Q(24)<0 AND Q(25)<0 THEN 28502760 IF Q(24)>0 THEN 28002770 X=I22780 GOSUB -Q(24) OF 21,412790 I1=Y2800 IF Q(25)>0 THEN 29402810 X=I12820 GOSUB -Q(25) OF 21,412830 I2=Y2840 GO TO 29402850 C=Q(20)2860 GOSUB 4002870 IF I=0 THEN 28902880 RETURN 2890 X=V2900 GOSUB -Q(24) OF 21,412910 I1=Y2920 GOSUB -Q(25) OF 21,412930 I2=Y2940 X=FNX(I1)2950 IF X<>Q(32) THEN 29702960 X=Q(32)2970 IF X<>Q(33) THEN 29902980 X=Q(33)2990 Y=FNY(I2)3000 IF Y<>Q(39) THEN 30203010 Y=Q(39)3020 IF Y<>Q(40) THEN 30403030 Y=Q(40)3040 IF J9<3 THEN 31403050 IF SQR((X-X9)^2+(Y-Y9)^2)=>D THEN 32503060 D=SQR((X-X9)^2+(Y-Y9)^2)3070 C=Q(24)3080 GOSUB 4003090 X8=V23100 C=Q(25)3110 GOSUB 4003120 Y8=V23130 GO TO 32503140 IF Q(8)=1 THEN 31603150 IF R>1 THEN 31803160 MOVE @K5:X,Y3170 GO TO 31903180 DRAW @K5:X,Y3190 IF Q(9)=32 THEN 32503200 IF X>FNX(Q(33)) OR X<FNX(Q(32)) THEN 32503210 IF Y>FNY(Q(40)) OR Y<FNY(Q(39)) THEN 32503220 RMOVE @K5:X1,Y13230 PRINT @K5:F$;3240 MOVE @K5:X,Y3250 NEXT R3260 RETURN 3270 REM NEAT AXES SUBROUTINE3280 REM ------------------------------3290 FOR I1=0 TO 7 STEP 73300 L=I1/3.53310 IF Q(13+L)<>0 OR Q(14+L)<>0 THEN 33303320 GOSUB 33503330 NEXT I13340 RETURN 3350 FUZZ 10,1.0E-3083360 IF Q(28+I1)=1 THEN 35703370 L=Q(32+I1)3380 GOSUB 57003390 IF Q(32+I1)<>Q(33+I1) THEN 34403400 L=INT(L)3410 Q(32+I1)=(L-0.1)*10^H3420 Q(33+I1)=(L+0.1)*10^H3430 GO TO 33703440 Q(32+I1)=H3450 L=Q(33+I1)3460 GOSUB 57003470 Q(33+I1)=H+13480 IF L>1 THEN 35003490 Q(33+I1)=H3500 FOR I=1 TO 1003510 IF (Q(33+I1)-Q(32+I1))/I<=Q(27+I1) THEN 35303520 NEXT I3530 Q(27+I1)=(Q(33+I1)-Q(32+I1))/I3540 Q(32+I1)=10^Q(32+I1)3550 Q(33+I1)=10^Q(33+I1)3560 RETURN 3570 J2=Q(32+I1)3580 K2=Q(33+I1)3590 IF J2<>K2 THEN 36803600 L=J23610 GOSUB 57003620 L=INT(L)3630 Q(32+I1)=(L-1)*10^H3640 Q(33+I1)=(L+1)*10^H3650 IF Q(27+I1)=1 THEN 36703660 Q(27+I1)=23670 RETURN 3680 C=K2-J23690 Z=Q(27+I1)3700 I3=03710 IF J2=>0 OR K2<0 THEN 38803720 L=J23730 GOSUB 57003740 J3=H3750 J2=L3760 L=C3770 GOSUB 57003780 C1=H3790 IF J3>C1 THEN 38203800 J2=INT(J2)3810 GO TO 38303820 J2=INT(J2*10^(J3-C1))/10^(J3-C1)3830 J2=J2*10^J33840 I3=-J23850 J2=03860 K2=K2+I33870 C=K2-J23880 L=J23890 GOSUB 57003900 J3=H3910 J2=L3920 L=K23930 GOSUB 57003940 K3=H3950 K2=L3960 L=C3970 GOSUB 57003980 C1=H3990 IF J3+1=>C1 THEN 40204000 J2=04010 GO TO 40304020 J2=INT(J2*10^(J3-C1+1))/10^(J3-C1+1)4030 IF K3=>C1 THEN 40604040 K2=104050 GO TO 40904060 IF INT(K2)<>K2 OR K2=0 THEN 40804070 K2=K2-1.0E-104080 K2=INT(K2*10^(K3-C1+1)+1)/10^(K3-C1+1)4090 K2=K2*10^K34100 C=K2-J2*10^J34110 IF Z<=2 THEN 41704120 FOR I2=Z TO 2 STEP -14130 IF INT(C/I2)=C/I2 THEN 41604140 NEXT I24150 GO TO 41704160 Z=I24170 FOR J1=10^(C1-1) TO 1.0E+9*10^(C1-1) STEP 10^(C1-1)4180 IF C/J1<=Z THEN 42004190 NEXT J14200 C=J1*Z4210 J2=J2*10^J34220 K1=J2+C4230 Z=-14240 FOR I2=J2 TO K1 STEP J14250 Z=Z+14260 IF I2=>K2 THEN 42804270 NEXT I24280 Q(33+I1)=I2-I34290 Q(32+I1)=J2-I34300 Q(27+I1)=Z4310 FUZZ 10,1.0E-644320 RETURN 4330 REM AXIS LABELING ROUTINE4340 REM ------------------------------4350 Q(36)=04360 Q(29)=04370 IF Q(32)<=0 THEN 43904380 Q(36)=Q(32)4390 IF Q(33)=>0 THEN 44104400 Q(36)=Q(33)4410 IF Q(39)<=0 THEN 44304420 Q(29)=Q(39)4430 IF Q(40)=>0 THEN 44504440 Q(29)=Q(40)4450 X=FNX(Q(32))4460 Y=FNY(Q(29))4470 MOVE @K5:X,Y4480 X=FNX(Q(33))4490 DRAW @K5:X,Y4500 X=FNX(Q(36))4510 Y=FNY(Q(39))4520 MOVE @K5:X,Y4530 Y=FNY(Q(40))4540 DRAW @K5:X,Y4550 VIEWPORT 0,130,0,1004560 WINDOW 0,130,0,1004570 F$=CHR(0)4580 I1=POS(T$,F$,1)4590 X$=SEG(T$,1,I1-1)4600 Y$=SEG(T$,I1+1,LEN(T$)-I1)4610 L=Q(32)4620 GOSUB 57004630 K4=10^(H-4)4640 L=Q(33)4650 GOSUB 57004660 H=10^(H-4)4670 IF K4<=H THEN 46904680 K4=H4690 I1=Q(4)+104700 I2=Q(4)+124710 IF Q(30)=0 THEN 47304720 I2=Q(6)4730 I3=(Q(5)-Q(3)-20)/Q(27)4740 Z=(FNX(Q(33))-FNX(Q(32)))/Q(27)4750 J1=FNX(Q(32))-Z4760 FOR X=Q(3)+20 TO Q(5) STEP I34770 J1=J1+Z4780 V=J14790 IF Q(28)=1 THEN 48104800 V=10^V4810 GOSUB 57704820 IF Q(30)<0 THEN 48504830 MOVE @K5:X,I14840 DRAW @K5:X,I24850 MOVE @K5:X,I14860 RMOVE @K5:-12,-44870 PRINT @K5:W$;4880 NEXT X4890 X2=INT((Q(5)-Q(3))/1.79)4900 IF LEN(X$)=X2 THEN 49704910 IF LEN(X$)<X2 THEN 49404920 X$=SEG(X$,1,X2)4930 GO TO 49704940 FOR X=1 TO (X2-LEN(X$))/24950 X$=" "&X$4960 NEXT X4970 MOVE @K5:Q(3),Q(4)4980 PRINT @K5:X$;4990 IF Q(28)<2 THEN 51205000 IF Q(30)<0 THEN 51205010 IF LGT(Q(33))-LGT(Q(32))<>Q(27) THEN 51205020 I1=I1+15030 IF Q(30)=2 THEN 50505040 I2=Q(4)+125050 FOR X=Q(3)+20 TO Q(3)+20+(Q(27)-1)*I3 STEP I35060 FOR J3=2 TO 95070 X2=X+LGT(J3)*I35080 MOVE @K5:X2,I15090 DRAW @K5:X2,I25100 NEXT J35110 NEXT X5120 L=Q(39)5130 GOSUB 57005140 K4=10^(H-4)5150 L=Q(40)5160 GOSUB 57005170 H=10^(H-4)5180 IF K4<=H THEN 52005190 K4=H5200 I1=Q(3)+185210 I2=Q(3)+205220 IF Q(37)=0 THEN 52405230 I2=Q(5)5240 I3=(Q(6)-Q(4)-12)/Q(34)5250 Z=(FNY(Q(40))-FNY(Q(39)))/Q(34)5260 J1=FNY(Q(39))-Z5270 FOR Y=Q(4)+12 TO Q(6) STEP I35280 J1=J1+Z5290 V=J15300 IF Q(35)=1 THEN 53205310 V=10^V5320 GOSUB 57705330 IF Q(37)<0 THEN 53605340 MOVE @K5:I1,Y5350 DRAW @K5:I2,Y5360 MOVE @K5:I1,Y5370 RMOVE @K5:-12.95,-2.45380 PRINT @K5:W$;5390 NEXT Y5400 Y2=INT((Q(6)-Q(4))/2.82)5410 IF LEN(Y$)=>Y2 THEN 54505420 FOR Y=1 TO (Y2-LEN(Y$))/25430 Y$=" "&Y$5440 NEXT Y5450 MOVE @K5:Q(3),Q(6)5460 F$=CHR(8)5470 W$=CHR(10)5480 FOR J3=1 TO LEN(Y$) MIN Y25490 D$=SEG(Y$,J3,1)5500 PRINT @K5:D$;F$;W$;5510 NEXT J35520 IF Q(35)<2 THEN 56505530 IF Q(37)<0 THEN 56505540 IF LGT(Q(40))-LGT(Q(39))<>Q(34) THEN 56505550 I1=I1+15560 IF Q(37)=2 THEN 55805570 I2=Q(3)+205580 FOR Y=Q(4)+12 TO Q(4)+12+(Q(34)-1)*I3 STEP I35590 FOR J3=2 TO 95600 Y2=Y+LGT(J3)*I35610 MOVE @K5:I1,Y25620 DRAW @K5:I2,Y25630 NEXT J35640 NEXT Y5650 VIEWPORT Q(3)+20,Q(5),Q(4)+12,Q(6)5660 WINDOW FNX(Q(32)),FNX(Q(33)),FNY(Q(39)),FNY(Q(40))5670 RETURN 5680 REM FIND MANTISSA & EXPONENT5690 REM ------------------------------5700 FUZZ 10,1.0E-3075710 H=INT(5.0E-4*SGN(L)+LGT(ABS(L)+(L=0)))5720 L=L/10^H5730 FUZZ 10,1.0E-645740 RETURN 5750 REM GET STRING OF VALUE ROUTINE5760 REM ------------------------------5770 IF V>999999 THEN 58605780 FUZZ 10,K45790 IF V<>0 THEN 58205800 V=05810 GO TO 58305820 IF ABS(V)<1.0E-4 THEN 58605830 W$=STR(V)5840 W$=SEG(W$,2,LEN(W$)-1)5850 GO TO 59805860 L=V5870 GOSUB 57005880 L=INT(L*10+0.5)/105890 IF ABS(L)<10 THEN 59205900 L=SGN(L)5910 H=H+15920 W$=STR(L)5930 W$=SEG(W$,2,LEN(W$)-1)5940 W$=W$&"E"5950 D$=STR(H)5960 D$=SEG(D$,2,LEN(D$)-1)5970 W$=W$&D$5980 IF LEN(W$)=>7 THEN 60105990 W$=" "&W$6000 GO TO 59806010 FUZZ 10,1.0E-646020 RETURN 6030 REM DPAG HANDLER6040 REM ------------------------------6050 PRINT "INSERT PRESENTATION TAPE. ";6060 INPUT F$6070 PAGE @K5:6080 FOR P2=1 TO P46090 FIND @K7:P1*P4+P26100 READ @K7:Q,T$6110 IF Q(1)>100 THEN 61406120 GOSUB Q(1) OF 1720,960,7306130 GO TO 61606140 GOSUB Q(1)-100 OF 1720,960,7306150 Q(1)=Q(1)-1006160 IF Q(11)>0 THEN 61806170 NEXT P26180 WINDOW 0,130,0,1006190 VIEWPORT 0,130,0,1006200 Q(11)=06210 MOVE @K5:0,06220 PRINT 6230 PRINT "INSERT GRAPH PLOT PROGRAM TAPE. ";6240 INPUT F$6250 GO TO 2906260 REM EDIT SECTION6270 REM -------------------------------6280 D=1.0E+3006290 K5=326300 J9=36310 GOSUB 17206320 IF Q(25)>A(Z1) THEN 64106330 IF Q(24)>A(Z1) THEN 64106340 PRINT @K5:"";6350 POINTER X9,Y9,F$6360 IF F$="G" THEN 64306370 IF F$="N" THEN 65906380 IF F$="E" THEN 64106390 J9=16400 GO TO 6306410 J8=06420 GO TO 2906430 IF X8=0 THEN 64806440 IF Q(28)=1 THEN 64706450 A(X8)=10^X96460 GO TO 64806470 A(X8)=X96480 IF Y8=0 THEN 65306490 IF Q(35)=1 THEN 65206500 A(Y8)=10^Y96510 GO TO 65306520 A(Y8)=Y96530 J9=16540 C=Q(24)6550 GOSUB 67206560 C=Q(25)6570 GOSUB 67206580 GO TO 6306590 PAGE 6600 IF X8=0 THEN 66406610 PRINT "Old X Value: ";A(X8)6620 PRINT "Input New X Value : ";6630 INPUT A(X8)6640 IF Y8=0 THEN 66806650 PRINT "Old Y Value: ";A(Y8)6660 PRINT "Input New Y Value: ";6670 INPUT A(Y8)6680 J9=16690 GO TO 65406700 REM FIND MINS AND MAXES SUBROUTINE6710 REM ------------------------------6720 N=A(Z2-C)6730 IF N>0 THEN 67506740 N=Z2-A(Z1)6750 T=A(Z1-C)6760 IF A(T)<>2 THEN 67806770 RETURN 6780 A(T+1)=A(T+3)6790 A(T+2)=A(T+3)6800 IF T+4=N THEN 68706810 FOR I3=T+4 TO N-16820 IF A(I3)=>A(T+1) THEN 68406830 A(T+1)=A(I3)6840 IF A(I3)<=A(T+2) THEN 68606850 A(T+2)=A(I3)6860 NEXT I36870 RETURN 6880 PRINT @K5:"DATA COLUMN NEEDED FOR PRESENTATION DOES NOT EXIST."6890 RETURN 